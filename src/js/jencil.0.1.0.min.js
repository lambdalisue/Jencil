(function(){(function(ay){ay.fn.tabby=function(aA){var aB=ay.extend({},ay.fn.tabby.defaults,aA);var aC=ay.fn.tabby.pressed;return this.each(function(){$this=ay(this);var aD=ay.meta?ay.extend({},aB,$this.data()):aB;$this.bind("keydown",function(aF){var aE=ay.fn.tabby.catch_kc(aF);if(16==aE){aC.shft=true}if(17==aE){aC.ctrl=true;setTimeout("$.fn.tabby.pressed.ctrl = false;",1000)}if(18==aE){aC.alt=true;setTimeout("$.fn.tabby.pressed.alt = false;",1000)}if(9==aE&&!aC.ctrl&&!aC.alt){aF.preventDefault;aC.last=aE;setTimeout("$.fn.tabby.pressed.last = null;",0);az(ay(aF.target).get(0),aC.shft,aD);return false}}).bind("keyup",function(aE){if(16==ay.fn.tabby.catch_kc(aE)){aC.shft=false}}).bind("blur",function(aE){if(9==aC.last){ay(aE.target).one("focus",function(aF){aC.last=null}).get(0).focus()}})})};ay.fn.tabby.catch_kc=function(aA){return aA.keyCode?aA.keyCode:aA.charCode?aA.charCode:aA.which};ay.fn.tabby.pressed={shft:false,ctrl:false,alt:false,last:null};function aw(aA){if(window.console&&window.console.log){window.console.log("textarea count: "+aA.size())}}function az(aD,aC,aB){var aA=aD.scrollTop;if(aD.setSelectionRange){av(aD,aC,aB)}else{if(document.selection){ax(aD,aC,aB)}}aD.scrollTop=aA}ay.fn.tabby.defaults={tabString:String.fromCharCode(9)};function av(aD,aA,aN){var aM=aD.selectionStart;var aK=aD.selectionEnd;if(aM==aK){if(aA){if("\t"==aD.value.substring(aM-aN.tabString.length,aM)){aD.value=aD.value.substring(0,aM-aN.tabString.length)+aD.value.substring(aM);aD.focus();aD.setSelectionRange(aM-aN.tabString.length,aM-aN.tabString.length)}else{if("\t"==aD.value.substring(aM,aM+aN.tabString.length)){aD.value=aD.value.substring(0,aM)+aD.value.substring(aM+aN.tabString.length);aD.focus();aD.setSelectionRange(aM,aM)}}}else{aD.value=aD.value.substring(0,aM)+aN.tabString+aD.value.substring(aM);aD.focus();aD.setSelectionRange(aM+aN.tabString.length,aM+aN.tabString.length)}}else{var aO=aD.value.split("\n");var aL=new Array();var aF=0;var aC=0;var aB=false;for(var aH in aO){aC=aF+aO[aH].length;aL.push({start:aF,end:aC,selected:(aF<=aM&&aC>aM)||(aC>=aK&&aF<aK)||(aF>aM&&aC<aK)});aF=aC+1}var aE=0;for(var aH in aL){if(aL[aH].selected){var aJ=aL[aH].start+aE;if(aA&&aN.tabString==aD.value.substring(aJ,aJ+aN.tabString.length)){aD.value=aD.value.substring(0,aJ)+aD.value.substring(aJ+aN.tabString.length);aE-=aN.tabString.length}else{if(!aA){aD.value=aD.value.substring(0,aJ)+aN.tabString+aD.value.substring(aJ);aE+=aN.tabString.length}}}}aD.focus();var aI=aM+((aE>0)?aN.tabString.length:(aE<0)?-aN.tabString.length:0);var aG=aK+aE;aD.setSelectionRange(aI,aG)}}function ax(aJ,aP,aA){var aI=document.selection.createRange();if(aJ==aI.parentElement()){if(""==aI.text){if(aP){var aF=aI.getBookmark();aI.moveStart("character",-aA.tabString.length);if(aA.tabString==aI.text){aI.text=""}else{aI.moveToBookmark(aF);aI.moveEnd("character",aA.tabString.length);if(aA.tabString==aI.text){aI.text=""}}aI.collapse(true);aI.select()}else{aI.text=aA.tabString;aI.collapse(false);aI.select()}}else{var aE=aI.text;var aH=aE.length;var aN=aE.split("\r\n");var aS=document.body.createTextRange();aS.moveToElementText(aJ);aS.setEndPoint("EndToStart",aI);var aG=aS.text;var aQ=aG.split("\r\n");var aK=aG.length;var aR=document.body.createTextRange();aR.moveToElementText(aJ);aR.setEndPoint("StartToEnd",aI);var aO=aR.text;var aB=document.body.createTextRange();aB.moveToElementText(aJ);aB.setEndPoint("StartToEnd",aS);var aL=aB.text;var aC=ay(aJ).html();ay("#r3").text(aK+" + "+aH+" + "+aO.length+" = "+aC.length);if((aK+aL.length)<aC.length){aQ.push("");aK+=2;if(aP&&aA.tabString==aN[0].substring(0,aA.tabString.length)){aN[0]=aN[0].substring(aA.tabString.length)}else{if(!aP){aN[0]=aA.tabString+aN[0]}}}else{if(aP&&aA.tabString==aQ[aQ.length-1].substring(0,aA.tabString.length)){aQ[aQ.length-1]=aQ[aQ.length-1].substring(aA.tabString.length)}else{if(!aP){aQ[aQ.length-1]=aA.tabString+aQ[aQ.length-1]}}}for(var aM=1;aM<aN.length;aM++){if(aP&&aA.tabString==aN[aM].substring(0,aA.tabString.length)){aN[aM]=aN[aM].substring(aA.tabString.length)}else{if(!aP){aN[aM]=aA.tabString+aN[aM]}}}if(1==aQ.length&&0==aK){if(aP&&aA.tabString==aN[0].substring(0,aA.tabString.length)){aN[0]=aN[0].substring(aA.tabString.length)}else{if(!aP){aN[0]=aA.tabString+aN[0]}}}if((aK+aH+aO.length)<aC.length){aN.push("");aH+=2}aS.text=aQ.join("\r\n");aI.text=aN.join("\r\n");var aD=document.body.createTextRange();aD.moveToElementText(aJ);if(0<aK){aD.setEndPoint("StartToEnd",aS)}else{aD.setEndPoint("StartToStart",aS)}aD.setEndPoint("EndToEnd",aI);aD.select()}}}})(jQuery);(function(a3){var ay=a3.Markdown=function ay(ba){switch(typeof ba){case"undefined":this.dialect=ay.dialects.Gruber;break;case"object":this.dialect=ba;break;default:if(ba in ay.dialects){this.dialect=ay.dialects[ba]}else{throw new Error("Unknown Markdown dialect '"+String(ba)+"'")}break}this.em_state=[];this.strong_state=[];this.debug_indent=""};a3.parse=function(bc,ba){var bb=new ay(ba);return bb.toTree(bc)};a3.toHTML=function aN(bd,bc,bb){var ba=a3.toHTMLTree(bd,bc,bb);return a3.renderJsonML(ba)};a3.toHTMLTree=function aP(bb,bf,bd){if(typeof bb==="string"){bb=this.parse(bb,bf)}var bc=aV(bb),ba={};if(bc&&bc.references){ba=bc.references}var be=aC(bb,ba,bd);aJ(be);return be};function az(){return"Markdown.mk_block( "+uneval(this.toString())+", "+uneval(this.trailing)+", "+uneval(this.lineNumber)+" )"}function a0(){var ba=require("util");return"Markdown.mk_block( "+ba.inspect(this.toString())+", "+ba.inspect(this.trailing)+", "+ba.inspect(this.lineNumber)+" )"}var aA=ay.mk_block=function(bd,bb,ba){if(arguments.length==1){bb="\n\n"}var bc=new String(bd);bc.trailing=bb;bc.inspect=a0;bc.toSource=az;if(ba!=undefined){bc.lineNumber=ba}return bc};function aZ(bb){var bc=0,ba=-1;while((ba=bb.indexOf("\n",ba+1))!==-1){bc++}return bc}ay.prototype.split_blocks=function aS(bc,bf){var bd=/([\s\S]+?)($|\n(?:\s*\n|$)+)/g,be=[],ba;var bb=1;if((ba=/^(\s*\n)/.exec(bc))!=null){bb+=aZ(ba[0]);bd.lastIndex=ba[0].length}while((ba=bd.exec(bc))!==null){be.push(aA(ba[1],ba[2],bb));bb+=aZ(ba[0])}return be};ay.prototype.processBlock=function a5(bf,be){var bb=this.dialect.block,ba=bb.__order__;if("__call__" in bb){return bb.__call__.call(this,bf,be)}for(var bd=0;bd<ba.length;bd++){var bc=bb[ba[bd]].call(this,bf,be);if(bc){if(!aT(bc)||(bc.length>0&&!(aT(bc[0])))){this.debug(ba[bd],"didn't return a proper array")}return bc}}return[]};ay.prototype.processInline=function aB(ba){return this.dialect.inline.__call__.call(this,String(ba))};ay.prototype.toTree=function a1(bc,bb){var bd=bc instanceof Array?bc:this.split_blocks(bc);var be=this.tree;try{this.tree=bb||this.tree||["markdown"];bd:while(bd.length){var ba=this.processBlock(bd.shift(),bd);if(!ba.length){continue bd}this.tree.push.apply(this.tree,ba)}return this.tree}finally{if(bb){this.tree=be}}};ay.prototype.debug=function(){var ba=Array.prototype.slice.call(arguments);ba.unshift(this.debug_indent);if(typeof print!=="undefined"){print.apply(print,ba)}if(typeof console!=="undefined"&&typeof console.log!=="undefined"){console.log.apply(null,ba)}};ay.prototype.loop_re_over_block=function(bd,be,bc){var bb,ba=be.valueOf();while(ba.length&&(bb=bd.exec(ba))!=null){ba=ba.substr(bb[0].length);bc.call(this,bb)}return ba};ay.dialects={};ay.dialects.Gruber={block:{atxHeader:function aL(bc,bb){var ba=bc.match(/^(#{1,6})\s*(.*?)\s*#*\s*(?:\n|$)/);if(!ba){return undefined}var bd=["header",{level:ba[1].length}];Array.prototype.push.apply(bd,this.processInline(ba[2]));if(ba[0].length<bc.length){bb.unshift(aA(bc.substr(ba[0].length),bc.trailing,bc.lineNumber+2))}return[bd]},setextHeader:function aQ(bc,bb){var ba=bc.match(/^(.*)\n([-=])\2\2+(?:\n|$)/);if(!ba){return undefined}var be=(ba[2]==="=")?1:2;var bd=["header",{level:be},ba[1]];if(ba[0].length<bc.length){bb.unshift(aA(bc.substr(ba[0].length),bc.trailing,bc.lineNumber+2))}return[bd]},code:function aF(bf,be){var bc=[],bd=/^(?: {0,3}\t| {4})(.*)\n?/,bb;if(!bf.match(bd)){return undefined}block_search:do{var ba=this.loop_re_over_block(bd,bf.valueOf(),function(bg){bc.push(bg[1])});if(ba.length){be.unshift(aA(ba,bf.trailing));break block_search}else{if(be.length){if(!be[0].match(bd)){break block_search}bc.push(bf.trailing.replace(/[^\n]/g,"").substring(2));bf=be.shift()}else{break block_search}}}while(true);return[["code_block",bc.join("\n")]]},horizRule:function a8(bc,bb){var ba=bc.match(/^(?:([\s\S]*?)\n)?[ \t]*([-_*])(?:[ \t]*\2){2,}[ \t]*(?:\n([\s\S]*))?$/);if(!ba){return undefined}var bd=[["hr"]];if(ba[1]){bd.unshift.apply(bd,this.processBlock(ba[1],[]))}if(ba[3]){bb.unshift(aA(ba[3]))}return bd},lists:(function(){var bd="[*+-]|\\d+\\.",bb=/[*+-]/,bj=/\d+\./,bh=new RegExp("^( {0,3})("+bd+")[ \t]+"),bc="(?: {0,3}\\t| {4})";function be(bk){return new RegExp("(?:^("+bc+"{0,"+bk+"} {0,3})("+bd+")\\s+)|(^"+bc+"{0,"+(bk-1)+"}[ ]{0,4})")}function ba(bk){return bk.replace(/ {0,3}\t/g,"    ")}function bi(bl,br,bq,bm){if(br){bl.push(["para"].concat(bq));return}var bk=bl[bl.length-1] instanceof Array&&bl[bl.length-1][0]=="para"?bl[bl.length-1]:bl;if(bm&&bl.length>1){bq.unshift(bm)}for(var bo=0;bo<bq.length;bo++){var bp=bq[bo],bn=typeof bp=="string";if(bn&&bk.length>1&&typeof bk[bk.length-1]=="string"){bk[bk.length-1]+=bp}else{bk.push(bp)}}}function bf(bq,bp){var bo=new RegExp("^("+bc+"{"+bq+"}.*?\\n?)*$"),bn=new RegExp("^"+bc+"{"+bq+"}","gm"),bm=[];while(bp.length>0){if(bo.exec(bp[0])){var bl=bp.shift(),bk=bl.replace(bn,"");bm.push(aA(bk,bl.trailing,bl.lineNumber))}break}return bm}function bg(bn,bm,bk){var bp=bn.list;var bo=bp[bp.length-1];if(bo[1] instanceof Array&&bo[1][0]=="para"){return}if(bm+1==bk.length){bo.push(["para"].concat(bo.splice(1)))}else{var bl=bo.pop();bo.push(["para"].concat(bo.splice(1)),bl)}}return function(bp,bv){var bw=bp.match(bh);if(!bw){return undefined}function bn(bF){var bG=bb.exec(bF[2])?["bulletlist"]:["numberlist"];bo.push({list:bG,indent:bF[1]});return bG}var bo=[],bA=bn(bw),bm,bu=false,bE=[bo[0].list],by;loose_search:while(true){var bk=bp.split(/(?=\n)/);var bB="";tight_search:for(var bC=0;bC<bk.length;bC++){var bl="",bx=bk[bC].replace(/^\n/,function(bF){bl=bF;return""});var bs=be(bo.length);bw=bx.match(bs);if(bw[1]!==undefined){if(bB.length){bi(bm,bu,this.processInline(bB),bl);bu=false;bB=""}bw[1]=ba(bw[1]);var bq=Math.floor(bw[1].length/4)+1;if(bq>bo.length){bA=bn(bw);bm.push(bA);bm=bA[1]=["listitem"]}else{var bt=false;for(by=0;by<bo.length;by++){if(bo[by].indent!=bw[1]){continue}bA=bo[by].list;bo.splice(by+1);bt=true;break}if(!bt){bq++;if(bq<=bo.length){bo.splice(bq);bA=bo[bq-1].list}else{bA=bn(bw);bm.push(bA)}}bm=["listitem"];bA.push(bm)}bl=""}if(bx.length>bw[0].length){bB+=bl+bx.substr(bw[0].length)}}if(bB.length){bi(bm,bu,this.processInline(bB),bl);bu=false;bB=""}var bz=bf(bo.length,bv);if(bz.length>0){aw(bo,bg,this);bm.push.apply(bm,this.toTree(bz,[]))}var br=bv[0]&&bv[0].valueOf()||"";if(br.match(bh)||br.match(/^ /)){bp=bv.shift();var bD=this.dialect.block.horizRule(bp,bv);if(bD){bE.push.apply(bE,bD);break}aw(bo,bg,this);bu=true;continue loose_search}break}return bE}})(),blockquote:function a4(bf,bd){if(!bf.match(/^>/m)){return undefined}var bh=[];if(bf[0]!=">"){var bb=bf.split(/\n/),be=[];while(bb.length&&bb[0][0]!=">"){be.push(bb.shift())}bf=bb.join("\n");bh.push.apply(bh,this.processBlock(be.join("\n"),[]))}while(bd.length&&bd[0][0]==">"){var ba=bd.shift();bf=new String(bf+bf.trailing+ba);bf.trailing=ba.trailing}var bc=bf.replace(/^> ?/gm,""),bg=this.tree;bh.push(this.toTree(bc,["blockquote"]));return bh},referenceDefn:function a2(be,bd){var bc=/^\s*\[(.*?)\]:\s*(\S+)(?:\s+(?:(['"])(.*?)\3|\((.*?)\)))?\n?/;if(!be.match(bc)){return undefined}if(!aV(this.tree)){this.tree.splice(1,0,{})}var bb=aV(this.tree);if(bb.references===undefined){bb.references={}}var ba=this.loop_re_over_block(bc,be,function(bf){if(bf[2]&&bf[2][0]=="<"&&bf[2][bf[2].length-1]==">"){bf[2]=bf[2].substring(1,bf[2].length-1)}var bg=bb.references[bf[1].toLowerCase()]={href:bf[2]};if(bf[4]!==undefined){bg.title=bf[4]}else{if(bf[5]!==undefined){bg.title=bf[5]}}});if(ba.length){bd.unshift(aA(ba,be.trailing))}return[]},para:function aW(bb,ba){return[["para"].concat(this.processInline(bb))]}}};ay.dialects.Gruber.inline={__oneElement__:function ax(bf,bb,be){var ba,bc,bg=0;bb=bb||this.dialect.inline.__patterns__;var bd=new RegExp("([\\s\\S]*?)("+(bb.source||bb)+")");ba=bd.exec(bf);if(!ba){return[bf.length,bf]}else{if(ba[1]){return[ba[1].length,ba[1]]}}var bc;if(ba[2] in this.dialect.inline){bc=this.dialect.inline[ba[2]].call(this,bf.substr(ba.index),ba,be||[])}bc=bc||[ba[2].length,ba[2]];return bc},__call__:function aK(be,bc){var ba=[],bb;function bd(bf){if(typeof bf=="string"&&typeof ba[ba.length-1]=="string"){ba[ba.length-1]+=bf}else{ba.push(bf)}}while(be.length>0){bb=this.dialect.inline.__oneElement__.call(this,be,bc,ba);be=be.substr(bb.shift());aw(bb,bd)}return ba},"]":function(){},"}":function(){},"\\":function aM(ba){if(ba.match(/^\\[\\`\*_{}\[\]()#\+.!\-]/)){return[2,ba[1]]}else{return[1,"\\"]}},"![":function aG(bc){var ba=bc.match(/^!\[(.*?)\][ \t]*\([ \t]*(\S*)(?:[ \t]+(["'])(.*?)\3)?[ \t]*\)/);if(ba){if(ba[2]&&ba[2][0]=="<"&&ba[2][ba[2].length-1]==">"){ba[2]=ba[2].substring(1,ba[2].length-1)}ba[2]=this.dialect.inline.__call__.call(this,ba[2],/\\/)[0];var bb={alt:ba[1],href:ba[2]||""};if(ba[4]!==undefined){bb.title=ba[4]}return[ba[0].length,["img",bb]]}ba=bc.match(/^!\[(.*?)\][ \t]*\[(.*?)\]/);if(ba){return[ba[0].length,["img_ref",{alt:ba[1],ref:ba[2].toLowerCase(),original:ba[0]}]]}return[2,"!["]},"[":function aH(bk){var bh=String(bk);var bf=ay.DialectHelpers.inline_until_char.call(this,bk.substr(1),"]");if(!bf){return[1,"["]}var bi=1+bf[0],bb=bf[1],bg,bj;bk=bk.substr(bi);var bd=bk.match(/^\s*\([ \t]*(\S+)(?:[ \t]+(["'])(.*?)\2)?[ \t]*\)/);if(bd){var ba=bd[1];bi+=bd[0].length;if(ba&&ba[0]=="<"&&ba[ba.length-1]==">"){ba=ba.substring(1,ba.length-1)}if(!bd[3]){var bc=1;for(var be=0;be<ba.length;be++){switch(ba[be]){case"(":bc++;break;case")":if(--bc==0){bi-=ba.length-be;ba=ba.substring(0,be)}break}}}ba=this.dialect.inline.__call__.call(this,ba,/\\/)[0];bj={href:ba||""};if(bd[3]!==undefined){bj.title=bd[3]}bg=["link",bj].concat(bb);return[bi,bg]}bd=bk.match(/^\s*\[(.*?)\]/);if(bd){bi+=bd[0].length;bj={ref:(bd[1]||String(bb)).toLowerCase(),original:bh.substr(0,bi)};bg=["link_ref",bj].concat(bb);return[bi,bg]}if(bb.length==1&&typeof bb[0]=="string"){bj={ref:bb[0].toLowerCase(),original:bh.substr(0,bi)};bg=["link_ref",bj,bb[0]];return[bi,bg]}return[1,"["]},"<":function aO(bb){var ba;if((ba=bb.match(/^<(?:((https?|ftp|mailto):[^>]+)|(.*?@.*?\.[a-zA-Z]+))>/))!=null){if(ba[3]){return[ba[0].length,["link",{href:"mailto:"+ba[3]},ba[3]]]}else{if(ba[2]=="mailto"){return[ba[0].length,["link",{href:ba[1]},ba[1].substr("mailto:".length)]]}else{return[ba[0].length,["link",{href:ba[1]},ba[1]]]}}}return[1,"<"]},"`":function aR(bb){var ba=bb.match(/(`+)(([\s\S]*?)\1)/);if(ba&&ba[2]){return[ba[1].length+ba[2].length,["inlinecode",ba[3]]]}else{return[1,"`"]}},"  \n":function a7(ba){return[3,["linebreak"]]}};function aY(ba,bd){var bc=ba+"_state",be=ba=="strong"?"em_state":"strong_state";function bb(bf){this.len_after=bf;this.name="close_"+bd}return function(bm,bl){if(this[bc][0]==bd){this[bc].shift();return[bm.length,new bb(bm.length-bd.length)]}else{var bf=this[be].slice(),bk=this[bc].slice();this[bc].unshift(bd);var bh=this.processInline(bm.substr(bd.length));var bi=bh[bh.length-1];var bg=this[bc].shift();if(bi instanceof bb){bh.pop();var bj=bm.length-bi.len_after;return[bj,[ba].concat(bh)]}else{this[be]=bf;this[bc]=bk;return[bd.length,bd]}}}}ay.dialects.Gruber.inline["**"]=aY("strong","**");ay.dialects.Gruber.inline.__=aY("strong","__");ay.dialects.Gruber.inline["*"]=aY("em","*");ay.dialects.Gruber.inline._=aY("em","_");ay.buildBlockOrder=function(bc){var ba=[];for(var bb in bc){if(bb=="__order__"||bb=="__call__"){continue}ba.push(bb)}bc.__order__=ba};ay.buildInlinePatterns=function(be){var bd=[];for(var bb in be){if(bb.match(/^__.*__$/)){continue}var ba=bb.replace(/([\\.*+?|()\[\]{}])/g,"\\$1").replace(/\n/,"\\n");bd.push(bb.length==1?ba:"(?:"+ba+")")}bd=bd.join("|");be.__patterns__=bd;var bc=be.__call__;be.__call__=function(bg,bf){if(bf!=undefined){return bc.call(this,bg,bf)}else{return bc.call(this,bg,bd)}}};ay.DialectHelpers={};ay.DialectHelpers.inline_until_char=function(be,bd){var bc=0,ba=[];while(true){if(be[bc]==bd){bc++;return[bc,ba]}if(bc>=be.length){return null}var bb=this.dialect.inline.__oneElement__.call(this,be.substr(bc));bc+=bb[0];ba.push.apply(ba,bb.slice(1))}};ay.subclassDialect=function(bc){function ba(){}ba.prototype=bc.block;function bb(){}bb.prototype=bc.inline;return{block:new ba(),inline:new bb()}};ay.buildBlockOrder(ay.dialects.Gruber.block);ay.buildInlinePatterns(ay.dialects.Gruber.inline);ay.dialects.Maruku=ay.subclassDialect(ay.dialects.Gruber);ay.dialects.Maruku.processMetaHash=function aE(bd){var be=aI(bd),ba={};for(var bb=0;bb<be.length;++bb){if(/^#/.test(be[bb])){ba.id=be[bb].substring(1)}else{if(/^\./.test(be[bb])){if(ba["class"]){ba["class"]=ba["class"]+be[bb].replace(/./," ")}else{ba["class"]=be[bb].substring(1)}}else{if(/\=/.test(be[bb])){var bc=be[bb].split(/\=/);ba[bc[0]]=bc[1]}}}}return ba};function aI(bc){var be=bc.split(""),bd=[""],ba=false;while(be.length){var bb=be.shift();switch(bb){case" ":if(ba){bd[bd.length-1]+=bb}else{bd.push("")}break;case"'":case'"':ba=!ba;break;case"\\":bb=be.shift();default:bd[bd.length-1]+=bb;break}}return bd}ay.dialects.Maruku.block.document_meta=function aD(bf,bc){if(bf.lineNumber>1){return undefined}if(!bf.match(/^(?:\w+:.*\n)*\w+:.*$/)){return undefined}if(!aV(this.tree)){this.tree.splice(1,0,{})}var be=bf.split(/\n/);for(p in be){var ba=be[p].match(/(\w+):\s*(.*)$/),bb=ba[1].toLowerCase(),bd=ba[2];this.tree[1][bb]=bd}return[]};ay.dialects.Maruku.block.block_meta=function aX(bh,be){var bd=bh.match(/(^|\n) {0,3}\{:\s*((?:\\\}|[^\}])*)\s*\}$/);if(!bd){return undefined}var bc=this.dialect.processMetaHash(bd[2]);var bg;if(bd[1]===""){var bf=this.tree[this.tree.length-1];bg=aV(bf);if(typeof bf==="string"){return undefined}if(!bg){bg={};bf.splice(1,0,bg)}for(a in bc){bg[a]=bc[a]}return[]}var bb=bh.replace(/\n.*$/,""),ba=this.processBlock(bb,[]);bg=aV(ba[0]);if(!bg){bg={};ba[0].splice(1,0,bg)}for(a in bc){bg[a]=bc[a]}return ba};ay.dialects.Maruku.block.definition_list=function a6(bc,bf){var bh=/^((?:[^\s:].*\n)+):\s+([\s\S]+)$/,bg=["dl"],be;if((bb=bc.match(bh))){var ba=[bc];while(bf.length&&bh.exec(bf[0])){ba.push(bf.shift())}for(var bi=0;bi<ba.length;++bi){var bb=ba[bi].match(bh),bd=bb[1].replace(/\n$/,"").split(/\n/),bj=bb[2].split(/\n:\s+/);for(be=0;be<bd.length;++be){bg.push(["dt",bd[be]])}for(be=0;be<bj.length;++be){bg.push(["dd"].concat(this.processInline(bj[be].replace(/(\n)\s+/,"$1"))))}}}else{return undefined}return[bg]};ay.dialects.Maruku.inline["{:"]=function aU(bh,bf,bd){if(!bd.length){return[2,"{:"]}var be=bd[bd.length-1];if(typeof be==="string"){return[2,"{:"]}var bb=bh.match(/^\{:\s*((?:\\\}|[^\}])*)\s*\}/);if(!bb){return[2,"{:"]}var bg=this.dialect.processMetaHash(bb[1]),ba=aV(be);if(!ba){ba={};be.splice(1,0,ba)}for(var bc in bg){ba[bc]=bg[bc]}return[bb[0].length,""]};ay.buildBlockOrder(ay.dialects.Maruku.block);ay.buildInlinePatterns(ay.dialects.Maruku.inline);var aT=Array.isArray||function(ba){return Object.prototype.toString.call(ba)=="[object Array]"};var aw;if(Array.prototype.forEach){aw=function(bb,ba,bc){return bb.forEach(ba,bc)}}else{aw=function(bb,ba,bd){for(var bc=0;bc<bb.length;bc++){ba.call(bd||bb,bb[bc],bc,bb)}}}function aV(ba){return aT(ba)&&ba.length>1&&typeof ba[1]==="object"&&!(aT(ba[1]))?ba[1]:undefined}a3.renderJsonML=function(bc,ba){ba=ba||{};ba.root=ba.root||false;var bb=[];if(ba.root){bb.push(a9(bc))}else{bc.shift();if(bc.length&&typeof bc[0]==="object"&&!(bc[0] instanceof Array)){bc.shift()}while(bc.length){bb.push(a9(bc.shift()))}}return bb.join("\n\n")};function av(ba){return ba.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function a9(bf){if(typeof bf==="string"){return av(bf)}var ba=bf.shift(),bc={},bd=[];if(bf.length&&typeof bf[0]==="object"&&!(bf[0] instanceof Array)){bc=bf.shift()}while(bf.length){bd.push(arguments.callee(bf.shift()))}var be="";for(var bb in bc){be+=" "+bb+'="'+av(bc[bb])+'"'}if(ba=="img"||ba=="br"||ba=="hr"){return"<"+ba+be+"/>"}else{return"<"+ba+be+">"+bd.join("")+"</"+ba+">"}}function aC(bi,bf,bh){var bc;bh=bh||{};var be=bi.slice(0);if(typeof bh.preprocessTreeNode==="function"){be=bh.preprocessTreeNode(be,bf)}var bg=aV(be);if(bg){be[1]={};for(bc in bg){be[1][bc]=bg[bc]}bg=be[1]}if(typeof be==="string"){return be}switch(be[0]){case"header":be[0]="h"+be[1].level;delete be[1].level;break;case"bulletlist":be[0]="ul";break;case"numberlist":be[0]="ol";break;case"listitem":be[0]="li";break;case"para":be[0]="p";break;case"markdown":be[0]="html";if(bg){delete bg.references}break;case"code_block":be[0]="pre";bc=bg?2:1;var ba=["code"];ba.push.apply(ba,be.splice(bc));be[bc]=ba;break;case"inlinecode":be[0]="code";break;case"img":be[1].src=be[1].href;delete be[1].href;break;case"linebreak":be[0]="br";break;case"link":be[0]="a";break;case"link_ref":be[0]="a";var bb=bf[bg.ref];if(bb){delete bg.ref;bg.href=bb.href;if(bb.title){bg.title=bb.title}delete bg.original}else{return bg.original}break;case"img_ref":be[0]="img";var bb=bf[bg.ref];if(bb){delete bg.ref;bg.src=bb.href;if(bb.title){bg.title=bb.title}delete bg.original}else{return bg.original}break}bc=1;if(bg){for(var bd in be[1]){bc=2}if(bc===1){be.splice(bc,1)}}for(;bc<be.length;++bc){be[bc]=arguments.callee(be[bc],bf,bh)}return be}function aJ(bb){var ba=aV(bb)?2:1;while(ba<bb.length){if(typeof bb[ba]==="string"){if(ba+1<bb.length&&typeof bb[ba+1]==="string"){bb[ba]+=bb.splice(ba+1,1)[0]}else{++ba}}else{arguments.callee(bb[ba]);++ba}}}})((function(){if(typeof exports==="undefined"){window.markdown={};return window.markdown}else{return exports}})());shortcut={all_shortcuts:{},add:function(aw,aC,ay){var aB={type:"keydown",propagate:false,disable_in_input:false,target:document,keycode:false};if(!ay){ay=aB}else{for(var av in aB){if(typeof ay[av]=="undefined"){ay[av]=aB[av]}}}var aA=ay.target;if(typeof ay.target=="string"){aA=document.getElementById(ay.target)}var ax=this;aw=aw.toLowerCase();var az=function(aH){aH=aH||window.event;if(ay.disable_in_input){var aE;if(aH.target){aE=aH.target}else{if(aH.srcElement){aE=aH.srcElement}}if(aE.nodeType==3){aE=aE.parentNode}if(aE.tagName=="INPUT"||aE.tagName=="TEXTAREA"){return}}if(aH.keyCode){code=aH.keyCode}else{if(aH.which){code=aH.which}}var aG=String.fromCharCode(code).toLowerCase();if(code==188){aG=","}if(code==190){aG="."}var aL=aw.split("+");var aK=0;var aI={"`":"~","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"_","=":"+",";":":","'":'"',",":"<",".":">","/":"?","\\":"|"};var aF={esc:27,escape:27,tab:9,space:32,"return":13,enter:13,backspace:8,scrolllock:145,scroll_lock:145,scroll:145,capslock:20,caps_lock:20,caps:20,numlock:144,num_lock:144,num:144,pause:19,"break":19,insert:45,home:36,"delete":46,end:35,pageup:33,page_up:33,pu:33,pagedown:34,page_down:34,pd:34,left:37,up:38,right:39,down:40,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123};var aJ={shift:{wanted:false,pressed:false},ctrl:{wanted:false,pressed:false},alt:{wanted:false,pressed:false},meta:{wanted:false,pressed:false}};if(aH.ctrlKey){aJ.ctrl.pressed=true}if(aH.shiftKey){aJ.shift.pressed=true}if(aH.altKey){aJ.alt.pressed=true}if(aH.metaKey){aJ.meta.pressed=true}for(var aD=0;k=aL[aD],aD<aL.length;aD++){if(k=="ctrl"||k=="control"){aK++;aJ.ctrl.wanted=true}else{if(k=="shift"){aK++;aJ.shift.wanted=true}else{if(k=="alt"){aK++;aJ.alt.wanted=true}else{if(k=="meta"){aK++;aJ.meta.wanted=true}else{if(k.length>1){if(aF[k]==code){aK++}}else{if(ay.keycode){if(ay.keycode==code){aK++}}else{if(aG==k){aK++}else{if(aI[aG]&&aH.shiftKey){aG=aI[aG];if(aG==k){aK++}}}}}}}}}}if(aK==aL.length&&aJ.ctrl.pressed==aJ.ctrl.wanted&&aJ.shift.pressed==aJ.shift.wanted&&aJ.alt.pressed==aJ.alt.wanted&&aJ.meta.pressed==aJ.meta.wanted){aC(aH);if(!ay.propagate){aH.cancelBubble=true;aH.returnValue=false;if(aH.stopPropagation){aH.stopPropagation();aH.preventDefault()}return false}}};this.all_shortcuts[aw]={callback:az,target:aA,event:ay.type};if(aA.addEventListener){aA.addEventListener(ay.type,az,false)}else{if(aA.attachEvent){aA.attachEvent("on"+ay.type,az)}else{aA["on"+ay.type]=az}}},remove:function(av){av=av.toLowerCase();var ay=this.all_shortcuts[av];delete (this.all_shortcuts[av]);if(!ay){return}var aw=ay.event;var ax=ay.target;var az=ay.callback;if(ax.detachEvent){ax.detachEvent("on"+aw,az)}else{if(ax.removeEventListener){ax.removeEventListener(aw,az,false)}else{ax["on"+aw]=false}}}};jQuery.prototype._outerWidth=jQuery.prototype.outerWidth;jQuery.prototype.outerWidth=function(av,aw){var ax;if(av==null){av=false}if(typeof av==="number"){aw=av;av=false}if(aw!=null){ax=this.nonContentWidth(av);return this.width(aw-ax)}return this._outerWidth(av)};jQuery.prototype._outerHeight=jQuery.prototype.outerHeight;jQuery.prototype.outerHeight=function(av,aw){var ax;if(av==null){av=false}if(typeof av==="number"){aw=av;av=false}if(aw!=null){ax=this.nonContentHeight(av);return this.height(aw-ax)}return this._outerHeight(av)};jQuery.prototype.nonContentWidth=function(av){if(av==null){av=false}return this._outerWidth(av)-this.width()};jQuery.prototype.nonContentHeight=function(av){if(av==null){av=false}return this._outerHeight(av)-this.height()};jQuery.prototype.ncss=function(aw,av){var ax;if(av==null){av=null}ax=this.css(aw);if(ax===""||ax==="none"||ax===null||ax===(void 0)||ax===NaN){return av}ax=parseInt(ax,10);return ax};jQuery.prototype.minWidth=function(){return this.ncss("min-width")};jQuery.prototype.minHeight=function(){return this.ncss("min-height")};jQuery.prototype.maxWidth=function(){return this.ncss("max-width")};jQuery.prototype.maxHeight=function(){return this.ncss("max-height")};jQuery.prototype.contentX=function(av){var ay,ax,aw;if(av==null){av=false}ax=av?this.ncss("margin-left"):0;ay=this.ncss("border-left-width");aw=this.ncss("padding-left");return ax+ay+aw};jQuery.prototype.contentY=function(av){var ay,ax,aw;if(av==null){av=false}ax=av?this.ncss("margin-top"):0;ay=this.ncss("border-top-width");aw=this.ncss("padding-top");return ax+ay+aw};jQuery.prototype.absoluteX=function(av){var aw;aw=this.offset();if(av!=null){aw.left=av;return this.offset(aw)}return aw.left};jQuery.prototype.absoluteY=function(av){var aw;aw=this.offset();if(av!=null){aw.top=av;return this.offset(aw)}return aw.top};jQuery.prototype.relativeX=function(av,ax){var ay,aw;if(av==null){av=false}if(typeof av==="number"){ax=av;av=false}aw=this.parent();ay=aw.absoluteX()+aw.contentX(av);if(ax!=null){return this.absoluteX(ax+ay)}return this.absoluteX()-ay};jQuery.prototype.relativeY=function(av,ax){var ay,aw;if(av==null){av=false}if(typeof av==="number"){ax=av;av=false}aw=this.parent();ay=aw.absoluteY()+aw.contentY(av);if(ax!=null){return this.absoluteY(ax+ay)}return this.absoluteY()-ay};var e,n,H,N,au={}.hasOwnProperty,q=function(ay,aw){for(var av in aw){if(au.call(aw,av)){ay[av]=aw[av]}}function ax(){this.constructor=ay}ax.prototype=aw.prototype;ay.prototype=new ax();ay.__super__=aw.prototype;return ay};n=(function(){function av(aw,ay){var ax=this;this._receiver=aw;this._callback=ay||function(){return ax.callback()}}av.prototype.callback=function(){throw"NotImplementedError"};av.prototype.getReceiver=function(){return this._receiver};av.prototype.getCallback=function(){return this._callback};av.prototype.invoke=function(){var ax,aw;aw=this.getReceiver();ax=this.getCallback();this._prev=aw.createMemento();ax.call(aw);return this._next=aw.createMemento()};av.prototype.undo=function(){var aw;aw=this.getReceiver();return aw.setMemento(this._prev)};av.prototype.redo=function(){var aw;aw=this.getReceiver();return aw.setMemento(this._next)};return av})();H=(function(aw){q(av,aw);function av(ax){av.__super__.constructor.call(this,ax,function(){return this})}return av})(n);N=(function(){function av(){}av.prototype.createMemento=function(){throw"NotImplementedError"};av.prototype.setMemento=function(aw){throw"NotImplementedError"};return av})();e=(function(){function av(){this._undoStack=[];this._redoStack=[]}av.prototype.invoke=function(aw){aw.invoke();this._redoStack=[];return this._undoStack.push(aw)};av.prototype.undo=function(){var aw;if(!this.canUndo()){return false}aw=this._undoStack.pop();aw.undo();this._redoStack.push(aw);return true};av.prototype.redo=function(){var aw;if(!this.canRedo()){return false}aw=this._redoStack.pop();aw.redo();this._undoStack.push(aw);return true};av.prototype.canUndo=function(){return this._undoStack.length>0};av.prototype.canRedo=function(){return this._redoStack.length>0};return av})();var ac,ab;ac=(function(){function av(aw,ax){this.document=aw;this.element=ax;this}av.prototype._getCaret=function(){var az,ay,aw,ax;if(this.document.selection!=null){aw=this.document.selection.createRange();az=aw.duplicate();az.moveToElementText(this.element);az.setEndPoint("EndToEnd",aw);ax=az.text.length-aw.text.length;ay=ax+aw.text.length}else{if(this.element.setSelectionRange!=null){ax=this.element.selectionStart;ay=this.element.selectionEnd}}return[ax,ay]};av.prototype._setCaret=function(az,aw){var ax,ay;ay=this.element.scrollTop;if(this.element.setSelectionRange!=null){this.element.setSelectionRange(az,aw)}else{if(this.element.createTextRange){ax=this.element.createTextRange();ax.collapse(true);ax.moveStart("character",az);ax.moveEnd("character",aw-az);ax.select()}}this.element.focus();this.element.scrollTop=ay;return this};av.prototype.caret=function(ax,aw){if((ax!=null)&&(aw!=null)){return this._setCaret(ax,aw)}return this._getCaret()};av.prototype.text=function(){var az,aw,ax,ay;if(this.document.selection!=null){aw=this.document.selection.createRange();return aw.text}else{if(this.element.setSelectionRange){ay=this.caret(),ax=ay[0],az=ay[1];return this.element.value.substring(ax,az)}}return null};av.prototype.replace=function(aB,aC,ay){var ax,aw,az,aA;aA=this.element.scrollTop;if(this.document.selection){this.element.focus();az=document.selection.createRange();az.text=aB;az.select()}else{if(this.element.setSelectionRange){aw=this.element.value.substring(0,aC);ax=this.element.value.substring(ay);this.element.value=aw+aB+ax}}this.element.scrollTop=aA;return this};av.prototype.replaceSelection=function(aB,ax){var aA,aw,az,ay;az=this.element.scrollTop;ay=this.caret(),aw=ay[0],aA=ay[1];this.replace(aB,aw,aA);aA=aw+aB.length;if(!ax){aw=aA}this.caret(aw,aA);this.element.focus();this.element.scrollTop=az;return this};av.prototype.insertBeforeSelection=function(aC,ax){var aA,aw,az,aB,ay;az=this.element.scrollTop;ay=this.caret(),aw=ay[0],aA=ay[1];aB=this.text();this.replace(aC+aB,aw,aA);aA=aw+aC.length;if(!ax){aw=aA}this.caret(aw,aA);this.element.focus();this.element.scrollTop=az;return this};av.prototype.insertAfterSelection=function(aC,ax){var aA,aw,az,aB,ay;az=this.element.scrollTop;ay=this.caret(),aw=ay[0],aA=ay[1];aB=this.text();this.replace(aB+aC,aw,aA);aw=aA;aA=aA+aC.length;if(!ax){aw=aA}this.caret(aw,aA);this.element.focus();this.element.scrollTop=az;return this};av.prototype.wrapSelection=function(aB,aC,ax){var az,aE,aw,aA,aD,ay;aw=this.element.scrollTop;aD=this.text();if(aD.indexOf(aB)===0&&aD.lastIndexOf(aC)===(aD.length-aC.length)){aA=aD.substring(aB.length,aD.length-aC.length);this.replaceSelection(aA,ax)}else{ay=this.caret(),aE=ay[0],az=ay[1];this.replace(aB+aD+aC,aE,az);az=aE+aB.length+aD.length+aC.length;if(!ax){aE=az}this.caret(aE,az)}this.element.focus();this.element.scrollTop=aw;return this};return av})();ab=(function(){function av(aw,ax){this.document=aw;this.element=ax;this.selection=new ac(this.document,this.element)}av.prototype.val=function(aw){if(aw!=null){this.element.value=aw;return this}return this.element.value};return av})();if(typeof exports!=="undefined"&&exports!==null){exports.Selection=ac}if(typeof exports!=="undefined"&&exports!==null){exports.Textarea=ab}var ak;ak=function(av){var ay,aw,ax;av=$.extend({start:0,end:100,duration:1000,callback:null,easing:null},av);aw=ak.now();ay=av.end-av.start;av.easing=av.easing||ak.easings["default"];ax=function(){var aA,az;aA=ak.now()-aw;az=av.easing(aA,0,1,av.duration);az=az*ay+av.start;av.callback(az,aA);if(aA<av.duration){return setTimeout(ax,1)}else{return av.callback(av.end,av.duration)}};ax();return null};ak.now=function(){return(new Date()).getTime()};ak.easings={"default":function(aw,ay,av,ax){return jQuery.easing.swing(aw/ax,aw,ay,av,ax)}};if(typeof exports!=="undefined"&&exports!==null){exports.animate=ak}var t;t=(function(){function av(aw){var ax=this;this.caretaker=new e();this.profile=new K();this.element=aw;this.element.hide();this.fullscreen=new y(this);this.wrapper=new B(this);this.element.after(this.fullscreen.element);this.element.after(this.wrapper.element);this.update(function(ay){return ax.element.val(ay)});$(window).resize(function(){return ax.adjust()});this.init().adjust()}av.prototype.setProfile=function(aw){return this.wrapper.workspace.reconstructor(aw)};av.prototype.getEditor=function(){return this.wrapper.workspace.editorPanel};av.prototype.getViewer=function(){return this.wrapper.workspace.viewerPanel};av.prototype.init=function(){this.wrapper.init();return this};av.prototype.adjust=function(){this.wrapper.adjust();return this};av.prototype.focus=function(){this.getEditor().focus();return this};av.prototype.update=function(ax){var aw;aw=this.getEditor();if(ax!=null){aw.update(ax);return this}this.editor.update();return this};av.prototype.options={defaultSplitterVolume:1,previewTemplatePath:null};return av})();$.fn.jencil=function(aw){var ax,av;ax=$(this);av=new t(ax);return ax.data("jencil",av)};var o,P,ao,au={}.hasOwnProperty,q=function(ay,aw){for(var av in aw){if(au.call(aw,av)){ay[av]=aw[av]}}function ax(){this.constructor=ay}ax.prototype=aw.prototype;ay.prototype=new ax();ay.__super__=aw.prototype;return ay};o=(function(aw){q(av,aw);function av(ax,ay,az){this.core=ax;av.__super__.constructor.call(this,ay,az)}return av})(n);P=(function(av){q(aw,av);function aw(ax,ay){aw.__super__.constructor.call(this,ax,null,ay)}aw.prototype.getReceiver=function(){return this.core.getEditor()};return aw})(o);ao=(function(aw){q(av,aw);function av(ax,ay){this.name=ay;av.__super__.constructor.call(this,ax,null)}av.prototype.getCallback=function(){var ax;ax=this.getReceiver();return ax[this.name]};return av})(P);var h;h=(function(){function av(ay,ax,az){var aw;this.core=ay;if(ax==null){ax="<div>"}if(ax instanceof jQuery){this.element=ax}else{this.element=jQuery(ax,az)}aw=this.element.data("widget-instance");if((aw!=null)&&aw instanceof av){return aw}this.element.data("widget-instance",this)}av.prototype.factory=function(aw){return new av(this.core,aw)};av.prototype.parent=function(){if(this._parentCache!=null){return this._parentCache}this._parentCache=this.factory(this.element.parent());return this._parentCache};av.prototype.children=function(){var aw;if(this._childrenCache!=null){return this._childrenCache}this._childrenCache=(function(){var aA,ay,az,ax;az=this.element.children();ax=[];for(aA=0,ay=az.length;aA<ay;aA++){aw=az[aA];ax.push(this.factory(jQuery(aw)))}return ax}).call(this);return this._childrenCache};av.prototype.init=function(){var az,ay,aw,ax;ax=this.children();for(ay=0,aw=ax.length;ay<aw;ay++){az=ax[ay];az.init()}return this.adjust()};av.prototype.adjust=function(){var az,ay,aw,ax;ax=this.children();for(ay=0,aw=ax.length;ay<aw;ay++){az=ax[ay];az.adjust()}return this};return av})();var M,ah,Z,au={}.hasOwnProperty,q=function(ay,aw){for(var av in aw){if(au.call(aw,av)){ay[av]=aw[av]}}function ax(){this.constructor=ay}ax.prototype=aw.prototype;ay.prototype=new ax();ay.__super__=aw.prototype;return ay};ah=(function(av){q(aw,av);function aw(ay,az,ax,aA){var aB,aC,aD=this;this.fst=az;this.snd=ax;this.defaultVolume=aA!=null?aA:0.5;aw.__super__.constructor.call(this,ay);this.element.addClass("splitter");this._volume=this.defaultVolume;aB=function(aE){aD.mousemove(aE);aE.stopPropagation();aE.stopImmediatePropagation();return aE.preventDefault()};aC=function(aE){var aF;aF=$(window);aF.unbind("mousemove",aB);aF.unbind("mouseup",aC);aE.stopPropagation();aE.stopImmediatePropagation();return aE.preventDefault()};this.element.mousedown(function(aE){var aF;aF=$(window);aF.mousemove(aB);aF.mouseup(aC);aE.stopPropagation();aE.stopImmediatePropagation();return aE.preventDefault()})}aw.prototype.volume=function(ay,ax){if(ax==null){ax=false}if(ay!=null){this._volume=ay;if(!ax){this.adjust()}return this}return this._volume};aw.prototype.value=function(aA,az){var ax,ay;if(az==null){az=false}ax=this.valueWidth();if(aA!=null){ay=aA/ax;return this.volume(ay,az)}return this.volume()*ax};aw.prototype.regulateValue=function(ay){var az,ax;ax=this.minValue();az=this.maxValue();if(ay<ax){ay=ax}if(ay>az){ay=az}return ay};return aw})(h);Z=(function(av){q(aw,av);function aw(ay,az,ax,aA){aw.__super__.constructor.call(this,ay,az,ax,aA);this.element.addClass("vertical");this.fst.element.addClass("left");this.snd.element.addClass("right");this.fst.element.css({"float":"left"});this.snd.element.css({"float":"left"})}aw.prototype.mousemove=function(az){var ax,ay;ax=this.fst.parent();ay=az.pageX-(ax.element.absoluteX()+ax.element.contentX(true));ay=this.regulateValue(ay);return this.value(ay)};aw.prototype.valueWidth=function(){var ax;ax=this.fst.parent();return ax.element.width()};aw.prototype.minValue=function(){var ay,ax;ay=this.fst.element.minWidth()+this.fst.element.nonContentWidth();ax=this.snd.element.maxWidth()+this.snd.element.nonContentWidth();if(ax!=null){ax=this.valueWidth()-ax}if((ay!=null)&&(ax!=null)){return Math.min(ay,ax)}return ay||ax||0};aw.prototype.maxValue=function(){var az,ay,ax;ax=this.valueWidth();az=this.fst.element.maxWidth()+this.fst.element.nonContentWidth();ay=this.snd.element.minWidth()+this.snd.element.nonContentWidth();if(ay!=null){ay=ax-ay}if((az!=null)&&(ay!=null)){return Math.max(az,ay)}return az||ay||ax};aw.prototype.adjust=function(){var aA,az,ay,ax;ay=this.value();ax=this.valueWidth();aA=ay-this.fst.element.nonContentWidth(true);az=(ax-ay)-this.snd.element.nonContentWidth(true);if(aA<=0){if(this.fst.element.is(":visible")){this.fst.element.hide()}if(!this.snd.element.is(":visible")){this.snd.element.show()}this.snd.element.outerWidth(true,ax);this._value=ay=0}else{if(az<=0){if(!this.fst.element.is(":visible")){this.fst.element.show()}if(this.snd.element.is(":visible")){this.snd.element.hide()}this.fst.element.outerWidth(true,ax);this._value=ay=ax}else{if(!this.fst.element.is(":visible")){this.fst.element.show()}if(!this.snd.element.is(":visible")){this.snd.element.show()}this.fst.element.width(aA);this.snd.element.width(az)}}this.fst.adjust();this.snd.adjust();this.element.relativeX(ay-this.element.outerWidth()/2);return this};return aw})(ah);M=(function(aw){q(av,aw);function av(ay,az,ax,aA){av.__super__.constructor.call(this,ay,az,ax,aA);this.element.addClass("horizontal");this.fst.element.addClass("top");this.snd.element.addClass("bottom")}av.prototype.mousemove=function(az){var ax,ay;ax=this.fst.parent();ay=az.pageY-(ax.element.absoluteY()+ax.element.contentY(true));ay=this.regulateValue(ay);return this.value(ay)};av.prototype.valueWidth=function(){var ax;ax=this.fst.parent();return ax.element.height()};av.prototype.minValue=function(){var ay,ax;ay=this.fst.element.minHeight()+this.fst.element.nonContentHeight();ax=this.snd.element.maxHeight()+this.snd.element.nonContentHeight();if(ax!=null){ax=this.valueWidth()-ax}if((ay!=null)&&(ax!=null)){return Math.min(ay,ax)}return ay||ax||0};av.prototype.maxValue=function(){var az,ay,ax;ax=this.valueWidth();az=this.fst.element.maxHeight()+this.fst.element.nonContentHeight();ay=this.snd.element.minHeight()+this.snd.element.nonContentHeight();if(ay!=null){ay=ax-ay}if((az!=null)&&(ay!=null)){return Math.max(az,ay)}return az||ay||ax};av.prototype.adjust=function(){var aA,az,ay,ax;ay=this.value();ax=this.valueWidth();aA=ay-this.fst.element.nonContentHeight(true);az=(ax-ay)-this.snd.element.nonContentHeight(true);if(aA<=0){if(this.fst.element.is(":visible")){this.fst.element.hide()}if(!this.snd.element.is(":visible")){this.snd.element.show()}this.snd.element.outerHeight(true,ax);this._value=ay=0}else{if(az<=0){if(!this.fst.element.is(":visible")){this.fst.element.show()}if(this.snd.element.is(":visible")){this.snd.element.hide()}this.fst.element.outerHeight(true,ax);this._value=ay=ax}else{if(!this.fst.element.is(":visible")){this.fst.element.show()}if(!this.snd.element.is(":visible")){this.snd.element.show()}this.fst.element.height(aA);this.snd.element.height(az)}}this.fst.adjust();this.snd.adjust();this.element.relativeY(ay-this.element.outerHeight()/2);return this};return av})(ah);var y,aj,f,i,au={}.hasOwnProperty,q=function(ay,aw){for(var av in aw){if(au.call(aw,av)){ay[av]=aw[av]}}function ax(){this.constructor=ay}ax.prototype=aw.prototype;ay.prototype=new ax();ay.__super__=aw.prototype;return ay};f=(function(av){q(aw,av);function aw(ay,ax,az){if(ax==null){ax="<div>"}aw.__super__.constructor.call(this,ay,ax,az);this.element.addClass("panel")}return aw})(h);i=(function(aw){q(av,aw);function av(ay,az,ax,aA){this.fst=az;this.snd=ax;this.defaultVolume=aA!=null?aA:0.5;av.__super__.constructor.call(this,ay);this.element.addClass("vertical");this.fst=this.fst||new f(ay);this.snd=this.snd||new f(ay);this.splitter=new Z(ay,this.fst,this.snd,this.defaultVolume);this.element.append(this.fst.element);this.element.append(this.splitter.element);this.element.append(this.snd.element)}av.prototype.init=function(){this.splitter.init();this.fst.init();return this.snd.init()};av.prototype.adjust=function(){this.fst.element.outerHeight(this.element.height());this.snd.element.outerHeight(this.element.height());this.splitter.element.outerHeight(this.element.height());this.splitter.adjust();return this};return av})(f);aj=(function(aw){q(av,aw);function av(ay,az,ax,aA){this.fst=az;this.snd=ax;this.defaultVolume=aA!=null?aA:0.5;av.__super__.constructor.call(this,ay);this.element.addClass("horizontal");this.fst=this.fst||new f(ay);this.snd=this.snd||new f(ay);this.splitter=new M(ay,this.fst,this.snd,this.defaultVolume);this.element.append(this.fst.element);this.element.append(this.splitter.element);this.element.append(this.snd.element)}av.prototype.init=function(){this.splitter.init();this.fst.init();return this.snd.init()};av.prototype.adjust=function(){this.fst.element.outerWidth(this.element.width());this.snd.element.outerWidth(this.element.width());this.splitter.element.outerWidth(this.element.width());this.splitter.adjust();return this};return av})(f);y=(function(aw){q(av,aw);function av(ax){var ay=this;av.__super__.constructor.call(this,ax);this.element.addClass("fullscreen");this.element.css({display:"table",position:"fixed",top:"0",left:"0",width:"100%",height:"100%"});if($.browser.msie&&$.browser.version<7){this.element.css("position","absolute");$(window).scroll(function(){return ay.element.css("top",$(document).scrollTop())})}this.curtain=$("<div>").addClass("curtain");this.curtain.css({position:"absolute",top:"0",left:"0",width:"100%",height:"100%",background:"black",opacity:"0.6"});this.curtain.click(function(){return ay.hide()});this.cell=$("<div>").css({display:"table-cell","vertical-align":"middle",width:"95%",height:"95%"});this.element.append(this.curtain);this.element.append(this.cell);this.element.hide()}av.prototype.show=function(){var ax=this;this._width=this.core.wrapper.element.css("width");this._height=this.core.wrapper.element.css("height");this.core.wrapper.element.css("width","90%");this.core.wrapper.element.css("height","90%");this.cell.append(this.core.wrapper.element);return this.element.fadeIn("fast",function(){ax.core.init();return ax.core.adjust()})};av.prototype.hide=function(){var ax=this;this.core.wrapper.element.css("width",this._width);this.core.wrapper.element.css("height",this._height);this.core.element.after(this.core.wrapper.element);return this.element.fadeOut("fast",function(){ax.core.init();return ax.core.adjust()})};return av})(f);var u,au={}.hasOwnProperty,q=function(ay,aw){for(var av in aw){if(au.call(aw,av)){ay[av]=aw[av]}}function ax(){this.constructor=ay}ax.prototype=aw.prototype;ay.prototype=new ax();ay.__super__=aw.prototype;return ay};u=(function(aw){q(av,aw);function av(ax){av.__super__.constructor.call(this,ax);this.element.addClass("toolbar")}return av})(f);var al,ai,c,j,C,au={}.hasOwnProperty,q=function(ay,aw){for(var av in aw){if(au.call(aw,av)){ay[av]=aw[av]}}function ax(){this.constructor=ay}ax.prototype=aw.prototype;ay.prototype=new ax();ay.__super__=aw.prototype;return ay};C=(function(av){q(aw,av);function aw(ax){aw.__super__.constructor.call(this,ax,"<span>");this.element.addClass("separator")}return aw})(h);ai=(function(aw){q(av,aw);function av(ax,ay){this.name=ay;av.__super__.constructor.call(this,ax,"<a>");this.element.addClass("button").addClass(ay);this.element.append($("<span>"+ay+"</span>"));this.element.attr("title",ay)}return av})(h);al=(function(aw){q(av,aw);function av(ay,az,aB,ax){var aA=this;this.callback=aB;this.shortcut=ax;av.__super__.constructor.call(this,ay,az);this.element.click(function(){return aA.callback()});if((this.shortcut!=null)&&(window.shortcut!=null)){window.shortcut.add(this.shortcut,function(){return aA.callback()});this.element.attr("title",""+az+" ("+this.shortcut+")")}}return av})(ai);c=(function(av){q(aw,av);function aw(ay,az,aA,ax){var aC,aB=this;this.command=aA;aC=function(){return aB.core.caretaker.invoke(aB.command)};aw.__super__.constructor.call(this,ay,az,aC,ax)}return aw})(al);j=(function(av){q(aw,av);function aw(ay,az,ax){var aA;aA=new ao(ay,az);aw.__super__.constructor.call(this,ay,az,aA,ax)}return aw})(c);var r,am,b,I,au={}.hasOwnProperty,q=function(ay,aw){for(var av in aw){if(au.call(aw,av)){ay[av]=aw[av]}}function ax(){this.constructor=ay}ax.prototype=aw.prototype;ay.prototype=new ax();ay.__super__=aw.prototype;return ay};I=(function(av){q(aw,av);function aw(ay){var aA,ax,az=this;aA=function(aB){return az.core.caretaker.undo()};ax=function(){if(!az.core.caretaker.canUndo()){az.element.addClass("disabled")}else{az.element.removeClass("disabled")}return setTimeout(ax,100)};aw.__super__.constructor.call(this,ay,"undo",aA,"Ctrl+Z");ax()}return aw})(al);b=(function(aw){q(av,aw);function av(ay){var aA,ax,az=this;aA=function(aB){return az.core.caretaker.redo()};ax=function(){if(!az.core.caretaker.canRedo()){az.element.addClass("disabled")}else{az.element.removeClass("disabled")}return setTimeout(ax,100)};av.__super__.constructor.call(this,ay,"redo",aA,"Ctrl+Shift+Z");ax()}return av})(al);r=(function(aw){q(av,aw);function av(ax){var az,ay=this;az=function(aA){if(ay.core.fullscreen.element.is(":visible")){ay.core.fullscreen.hide();return ay.element.removeClass("hide")}else{ay.core.fullscreen.show();return ay.element.addClass("hide")}};av.__super__.constructor.call(this,ax,"fullscreen",az,"Ctrl+F")}return av})(al);am=(function(av){q(aw,av);function aw(ax){var az,ay=this;az=function(aA){var aB;aB=ay.core.getViewer();if(!aB.element.is(":visible")){ay.element.addClass("hide")}else{ay.element.removeClass("hide")}return ay.core.wrapper.workspace.toggleViewer()};aw.__super__.constructor.call(this,ax,"preview",az,"Ctrl+P")}aw.prototype.init=function(){if(this.core.wrapper.workspace.mainPanel.splitter.defaultValue===0){return this.element.addClass("hide")}else{return this.element.removeClass("hide")}};return aw})(al);var ar,ag,Q,z,ae,O,S,X,U,R,W,T,at,an,G,w,V,s,x,E,D,af,au={}.hasOwnProperty,q=function(ay,aw){for(var av in aw){if(au.call(aw,av)){ay[av]=aw[av]}}function ax(){this.constructor=ay}ax.prototype=aw.prototype;ay.prototype=new ax();ay.__super__=aw.prototype;return ay};S=(function(aw){q(av,aw);function av(ax){av.__super__.constructor.call(this,ax,"h1")}return av})(j);X=(function(av){q(aw,av);function aw(ax){aw.__super__.constructor.call(this,ax,"h2")}return aw})(j);U=(function(av){q(aw,av);function aw(ax){aw.__super__.constructor.call(this,ax,"h3")}return aw})(j);R=(function(aw){q(av,aw);function av(ax){av.__super__.constructor.call(this,ax,"h4")}return av})(j);W=(function(aw){q(av,aw);function av(ax){av.__super__.constructor.call(this,ax,"h5")}return av})(j);T=(function(aw){q(av,aw);function av(ax){av.__super__.constructor.call(this,ax,"h6")}return av})(j);O=(function(aw){q(av,aw);function av(ax){av.__super__.constructor.call(this,ax,"bold","Ctrl+B")}return av})(j);G=(function(av){q(aw,av);function aw(ax){aw.__super__.constructor.call(this,ax,"italic","Ctrl+I")}return aw})(j);D=(function(av){q(aw,av);function aw(ax){aw.__super__.constructor.call(this,ax,"underline","Ctrl+U")}return aw})(j);s=(function(aw){q(av,aw);function av(ax){av.__super__.constructor.call(this,ax,"strike")}return av})(j);E=(function(aw){q(av,aw);function av(ax){av.__super__.constructor.call(this,ax,"superscript")}return av})(j);x=(function(av){q(aw,av);function aw(ax){aw.__super__.constructor.call(this,ax,"subscript")}return aw})(j);ae=(function(aw){q(av,aw);function av(ax){av.__super__.constructor.call(this,ax,"anchor")}return av})(j);at=(function(av){q(aw,av);function aw(ax){aw.__super__.constructor.call(this,ax,"image")}return aw})(j);af=(function(aw){q(av,aw);function av(ax){av.__super__.constructor.call(this,ax,"unorderedList")}return av})(j);w=(function(aw){q(av,aw);function av(ax){av.__super__.constructor.call(this,ax,"orderedList")}return av})(j);an=(function(aw){q(av,aw);function av(ax){av.__super__.constructor.call(this,ax,"indent")}return av})(j);V=(function(av){q(aw,av);function aw(ax){aw.__super__.constructor.call(this,ax,"outdent")}return aw})(j);Q=(function(aw){q(av,aw);function av(ax){av.__super__.constructor.call(this,ax,"alignLeft")}return av})(j);ar=(function(aw){q(av,aw);function av(ax){av.__super__.constructor.call(this,ax,"alignCenter")}return av})(j);z=(function(aw){q(av,aw);function av(ax){av.__super__.constructor.call(this,ax,"alignRight")}return av})(j);ag=(function(aw){q(av,aw);function av(ax){av.__super__.constructor.call(this,ax,"alignJustify")}return av})(j);var l,B,au={}.hasOwnProperty,q=function(ay,aw){for(var av in aw){if(au.call(aw,av)){ay[av]=aw[av]}}function ax(){this.constructor=ay}ax.prototype=aw.prototype;ay.prototype=new ax();ay.__super__=aw.prototype;return ay};B=(function(av){q(aw,av);function aw(ax){aw.__super__.constructor.call(this,ax);this.element.addClass("jencil wrapper");this.workspace=new l(this.core);this.workspace.element.appendTo(this.element)}aw.prototype.init=function(){var ax=this;if(this.element.resizable!=null){this.element.resizable({resize:function(){return ax.adjust()},stop:function(){return ax.adjust()}})}this.workspace.init();return this};aw.prototype.adjust=function(){this.workspace.element.outerWidth(this.element.width());this.workspace.element.outerHeight(this.element.height());this.workspace.adjust();return this};return aw})(f);l=(function(aw){q(av,aw);function av(ax){av.__super__.constructor.call(this,ax);this.element.addClass("workspace");this.reconstructor(ax.profile)}av.prototype.reconstructor=function(ax){var aB,aF,ay,aC,aA,az,aE,aD=this;this.element.empty();aC=ax.getEditorClass();this.editorPanel=new aC(this.core);aA=ax.getViewerClass();this.viewerPanel=new aA(this.core);this.editorPanel.update(function(aG){return aD.viewerPanel.update(aG)});this.mainPanel=new i(this.core,this.editorPanel,this.viewerPanel,this.core.options.defaultSplitterVolume);this.mainPanel.element.addClass("mainPanel");this.toolbar=new u(this.core);ay=ax.getButtonClasses();for(az=0,aE=ay.length;az<aE;az++){aF=ay[az];aB=new aF(this.core);this.toolbar.element.append(aB.element)}this.toolbar.element.appendTo(this.element);return this.mainPanel.element.appendTo(this.element)};av.prototype.init=function(){this.toolbar.init();return this.mainPanel.init()};av.prototype.adjust=function(){this.toolbar.element.outerWidth(this.element.width());this.mainPanel.element.outerWidth(this.element.width());this.mainPanel.element.outerHeight(this.element.height()-this.toolbar.element.outerHeight());this.toolbar.adjust();this.mainPanel.adjust();return this};av.prototype.toggleViewer=function(aA){var ax,ay,az=this;ay=this.mainPanel.splitter.volume();if((0<ay&&ay<1)){ax=1;this._previousSplitterVolume=ay}else{ax=this._previousSplitterVolume||this.mainPanel.splitter.defaultVolume;if(ax===1){ax=0.5}}return ak({start:ay,end:ax,duration:500,callback:function(aC,aB){return az.mainPanel.splitter.volume(aC)}})};return av})(f);var J,Y,aq,au={}.hasOwnProperty,q=function(ay,aw){for(var av in aw){if(au.call(aw,av)){ay[av]=aw[av]}}function ax(){this.constructor=ay}ax.prototype=aw.prototype;ay.prototype=new ax();ay.__super__=aw.prototype;return ay};J=(function(aw){q(av,aw);function av(ay,ax,az){av.__super__.constructor.call(this,ay,ax,az);this.element.addClass("editor");this._updateCallbacks=[]}av.prototype.focus=function(){throw"NotImplementedError"};av.prototype.getValue=function(){throw"NotImplementedError"};av.prototype.setValue=function(){throw"NotImplementedError"};av.prototype.update=function(aB){var aA,ay,az,ax;if(aB!=null){this._updateCallbacks.push(aB);return this}az=this._updateCallbacks;ax=[];for(aA=0,ay=az.length;aA<ay;aA++){aB=az[aA];ax.push(aB.call(this,this.getValue()))}return ax};av.prototype.createMemento=function(){return this.getValue()};av.prototype.setMemento=function(ax){return this.setValue(ax)};return av})(f);aq=(function(aw){q(av,aw);function av(ax){av.__super__.constructor.call(this,ax,"<textarea>");this.element.css({margin:"0",padding:"0",border:"none",outline:"none",resize:"none"});if($.fn.tabby!=null){this.element.tabby()}this.helper=new ab(window.document,this.element.get(0))}av.prototype.caret=function(ay,ax){return this.helper.selection.caret(ay,ax)};av.prototype.selection=function(ax){if(ax!=null){return this.helper.selection.replaceSelection(ax,true)}return this.helper.selection.text()};av.prototype.insertBefore=function(ax){return this.helper.selection.insertBeforeSelection(ax,true)};av.prototype.insertAfter=function(ax){return this.helper.selection.insertAfterSelection(ax,true)};av.prototype.wrap=function(ax,ay){return this.helper.selection.wrapSelection(ax,ay,true)};return av})(f);Y=(function(av){q(aw,av);function aw(ax){var ay=this;aw.__super__.constructor.call(this,ax);this.textPanel=new aq(ax);this.element.append(this.textPanel.element);this.textPanel.element.on("keyup keypress click blur",function(){return ay.update()});this.textPanel.element.on("keyup",function(aA){var az;if(aA.which===13){az=new H(ay);return ay.core.caretaker.invoke(az)}})}aw.prototype.adjust=function(){this.textPanel.element.outerWidth(this.element.width());this.textPanel.element.outerHeight(this.element.height());this.textPanel.adjust();return this};aw.prototype.focus=function(){this.textPanel.element.focus();return this};aw.prototype.getValue=function(){return this.textPanel.helper.val()};aw.prototype.setValue=function(ax){this.textPanel.helper.val(ax);this.update();return this};aw.prototype.caret=function(ay,ax){this.textPanel.focus();return this.textPanel.caret(ay,ax)};aw.prototype.selection=function(ax){if(ax!=null){this.textPanel.selection(ax);this.update();return this}return this.textPanel.selection(ax)};aw.prototype.insertBefore=function(ax){this.textPanel.insertBefore(ax);return this.update()};aw.prototype.insertAfter=function(ax){this.textPanel.insertAfter(ax);return this.update()};aw.prototype.wrap=function(ax,ay){this.textPanel.wrap(ax,ay);return this.update()};return aw})(J);var aa,au={}.hasOwnProperty,q=function(ay,aw){for(var av in aw){if(au.call(aw,av)){ay[av]=aw[av]}}function ax(){this.constructor=ay}ax.prototype=aw.prototype;ay.prototype=new ax();ay.__super__=aw.prototype;return ay};aa=(function(aw){q(av,aw);function av(){return av.__super__.constructor.apply(this,arguments)}av.prototype.h1=function(){return this.wrap("<h1>","</h1>")};av.prototype.h2=function(){return this.wrap("<h2>","</h2>")};av.prototype.h3=function(){return this.wrap("<h3>","</h3>")};av.prototype.h4=function(){return this.wrap("<h4>","</h4>")};av.prototype.h5=function(){return this.wrap("<h5>","</h5>")};av.prototype.h6=function(){return this.wrap("<h6>","</h6>")};av.prototype.bold=function(){return this.wrap("<b>","</b>")};av.prototype.italic=function(){return this.wrap("<i>","</i>")};av.prototype.underline=function(){return this.wrap("<u>","</u>")};av.prototype.strike=function(){return this.wrap("<s>","</s>")};av.prototype.superscript=function(){return this.wrap("<sup>","</sup>")};av.prototype.subscript=function(){return this.wrap("<sub>","</sub>")};av.prototype.anchor=function(){var ax,ay;ay=this.selection();if(!ay){ay=window.prompt("Please input a link text","Here")}ax=window.prompt("Please input a link url","http://");return this.selection("<a href='"+ax+"'>"+ay+"</a>")};av.prototype.image=function(){var ax,ay;ay=window.prompt("Please input a image url","http://");ax=window.prompt("(Optional) Please input a alt message","Image");return this.selection("<img src='"+ay+"' alt='"+ax+"'>")};av.prototype.unorderedList=function(){var ay,ax;ay=this.selection();ay=(function(){var aC,aA,aB,az;aB=ay.split("\n");az=[];for(aC=0,aA=aB.length;aC<aA;aC++){ax=aB[aC];az.push("  <li>"+ax+"</li>")}return az})();ay.unshift("<ul>");ay.push("</ul>");return this.selection(ay.join("\n"))};av.prototype.orderedList=function(){var ay,ax;ay=this.selection();ay=(function(){var aC,aA,aB,az;aB=ay.split("\n");az=[];for(aC=0,aA=aB.length;aC<aA;aC++){ax=aB[aC];az.push("  <li>"+ax+"</li>")}return az})();ay.unshift("<ol>");ay.push("</ol>");return this.selection(ay.join("\n"))};av.prototype.indent=function(){var ay,ax;ay=this.selection();ay=(function(){var aC,aA,aB,az;aB=ay.split("\n");az=[];for(aC=0,aA=aB.length;aC<aA;aC++){ax=aB[aC];az.push("  "+ax)}return az})();ay.unshift("<div style='margin-left: 4em'>");ay.push("</div>");return this.selection(ay.join("\n"))};av.prototype.outdent=function(){var ay,ax;ay=this.selection();ay=(function(){var aC,aA,aB,az;aB=ay.split("\n");az=[];for(aC=0,aA=aB.length;aC<aA;aC++){ax=aB[aC];az.push("  "+ax)}return az})();ay.unshift("<div style='margin-left: -4em'>");ay.push("</div>");return this.selection(ay.join("\n"))};av.prototype.alignLeft=function(){var ay,ax;ay=this.selection();ay=(function(){var aC,aA,aB,az;aB=ay.split("\n");az=[];for(aC=0,aA=aB.length;aC<aA;aC++){ax=aB[aC];az.push("  "+ax)}return az})();ay.unshift("<div style='text-align: left'>");ay.push("</div>");return this.selection(ay.join("\n"))};av.prototype.alignCenter=function(){var ay,ax;ay=this.selection();ay=(function(){var aC,aA,aB,az;aB=ay.split("\n");az=[];for(aC=0,aA=aB.length;aC<aA;aC++){ax=aB[aC];az.push("  "+ax)}return az})();ay.unshift("<div style='text-align: center'>");ay.push("</div>");return this.selection(ay.join("\n"))};av.prototype.alignRight=function(){var ay,ax;ay=this.selection();ay=(function(){var aC,aA,aB,az;aB=ay.split("\n");az=[];for(aC=0,aA=aB.length;aC<aA;aC++){ax=aB[aC];az.push("  "+ax)}return az})();ay.unshift("<div style='text-align: right'>");ay.push("</div>");return this.selection(ay.join("\n"))};av.prototype.alignJustify=function(){var ay,ax;ay=this.selection();ay=(function(){var aC,aA,aB,az;aB=ay.split("\n");az=[];for(aC=0,aA=aB.length;aC<aA;aC++){ax=aB[aC];az.push("  "+ax)}return az})();ay.unshift("<div style='text-align: justify'>");ay.push("</div>");return this.selection(ay.join("\n"))};return av})(Y);var F,au={}.hasOwnProperty,q=function(ay,aw){for(var av in aw){if(au.call(aw,av)){ay[av]=aw[av]}}function ax(){this.constructor=ay}ax.prototype=aw.prototype;ay.prototype=new ax();ay.__super__=aw.prototype;return ay};F=(function(aw){q(av,aw);function av(){return av.__super__.constructor.apply(this,arguments)}av.prototype.h1=function(){return this.insertBefore("# ")};av.prototype.h2=function(){return this.insertBefore("## ")};av.prototype.h3=function(){return this.insertBefore("### ")};av.prototype.h4=function(){return this.insertBefore("#### ")};av.prototype.h5=function(){return this.insertBefore("##### ")};av.prototype.h6=function(){return this.insertBefore("###### ")};av.prototype.bold=function(){return this.wrap("**","**")};av.prototype.italic=function(){return this.wrap("*","*")};av.prototype.anchor=function(){var ax,ay;ay=this.selection();if(!ay){ay=window.prompt("Please input a link text","Here")}ax=window.prompt("Please input a link url","http://");return this.selection("["+ay+"]("+ax+")")};av.prototype.image=function(){var ax,ay;ay=window.prompt("Please input a image url","http://");ax=window.prompt("(Optional) Please input a alt message","Image");return this.selection("!["+ax+"]("+ay+")")};av.prototype.unorderedList=function(){var ay,ax;ay=this.selection();ay=(function(){var aC,aA,aB,az;aB=ay.split("\n");az=[];for(aC=0,aA=aB.length;aC<aA;aC++){ax=aB[aC];az.push("-   "+ax)}return az})();ay.unshift("");ay.push("");return this.selection(ay.join("\n"))};av.prototype.orderedList=function(){var ay,az,ax;az=this.selection();az=(function(){var aD,aB,aC,aA;aC=az.split("\n");aA=[];for(ay=aD=0,aB=aC.length;aD<aB;ay=++aD){ax=aC[ay];aA.push(""+ay+". "+ax)}return aA})();az.unshift("");az.push("");return this.selection(az.join("\n"))};av.prototype.indent=function(){var ay,ax;ay=this.selection();ay=(function(){var aC,aA,aB,az;aB=ay.split("\n");az=[];for(aC=0,aA=aB.length;aC<aA;aC++){ax=aB[aC];az.push("  "+ax)}return az})();ay.unshift("");ay.push("");return this.selection(ay.join("\n"))};return av})(aa);var ad,v,ap,m,au={}.hasOwnProperty,q=function(ay,aw){for(var av in aw){if(au.call(aw,av)){ay[av]=aw[av]}}function ax(){this.constructor=ay}ax.prototype=aw.prototype;ay.prototype=new ax();ay.__super__=aw.prototype;return ay};m=(function(av){q(aw,av);function aw(ay,ax,az){aw.__super__.constructor.call(this,ay,ax,az);this.element.addClass("viewer")}aw.prototype.update=function(ax){throw"NotImplementedError"};return aw})(f);ad=(function(av){q(aw,av);function aw(ax){aw.__super__.constructor.call(this,ax,"<iframe>");this.element.css({margin:"0",padding:"0",border:"none",outline:"none",resize:"none",width:"100%",height:"100%",pointerEvents:"none"});this.element.attr("frameborder",0)}aw.prototype.init=function(){var ax;ax=this.element.get(0);if(ax.contentDocument!=null){this.document=ax.contentDocument}else{this.document=ax.contentWindow.document}return this.document.write("<body></body>")};aw.prototype.write=function(ax){var az;if(this.document!=null){try{az=this.document.documentElement.scrollTop}catch(ay){az=0}this.document.open();this.document.write(ax);this.document.close();this.document.documentElement.scrollTop=az;return true}return false};return aw})(f);v=(function(av){q(aw,av);function aw(){return aw.__super__.constructor.apply(this,arguments)}aw.prototype.loadTemplate=function(ax,ay){var az=this;return $.ajax({url:ax,success:function(aA){az._template=aA;return az.write(ay)}})};aw.prototype.write=function(ax){if(this._template!=null){ax=this._template.replace("{{content}}",ax)}else{if(this.templatePath!=null){this.loadTemplate(this.templatePath,ax)}}return aw.__super__.write.call(this,ax)};return aw})(ad);ap=(function(aw){q(av,aw);function av(ax){av.__super__.constructor.call(this,ax);this.templatePanel=new v(ax);this.templatePanel.templatePath=this.core.options.previewTemplatePath;this.element.append(this.templatePanel.element)}av.prototype.adjust=function(){this.templatePanel.element.outerWidth(this.element.width());this.templatePanel.element.outerHeight(this.element.height());this.templatePanel.adjust();return this};av.prototype.update=function(ax){this.templatePanel.write(ax);return this};return av})(m);var A;A=ap;var g,au={}.hasOwnProperty,q=function(ay,aw){for(var av in aw){if(au.call(aw,av)){ay[av]=aw[av]}}function ax(){this.constructor=ay}ax.prototype=aw.prototype;ay.prototype=new ax();ay.__super__=aw.prototype;return ay};g=(function(aw){q(av,aw);function av(){return av.__super__.constructor.apply(this,arguments)}av.prototype.update=function(ax){return av.__super__.update.call(this,window.markdown.toHTML(ax))};return av})(ap);var d;d=(function(){function av(){}av.prototype.buttonClasses=[S,X,U,R,W,T,C,I,b,C,O,G,D,s,E,x,C,ae,at,C,af,w,C,an,V,C,Q,ar,z,ag,C,r,am];av.prototype.getEditorClass=function(){return this.editorClass};av.prototype.getViewerClass=function(){return this.viewerClass};av.prototype.getButtonClasses=function(){return this.buttonClasses};return av})();var L,au={}.hasOwnProperty,q=function(ay,aw){for(var av in aw){if(au.call(aw,av)){ay[av]=aw[av]}}function ax(){this.constructor=ay}ax.prototype=aw.prototype;ay.prototype=new ax();ay.__super__=aw.prototype;return ay};L=(function(aw){q(av,aw);function av(){return av.__super__.constructor.apply(this,arguments)}av.prototype.editorClass=aa;av.prototype.viewerClass=A;return av})(d);var K,au={}.hasOwnProperty,q=function(ay,aw){for(var av in aw){if(au.call(aw,av)){ay[av]=aw[av]}}function ax(){this.constructor=ay}ax.prototype=aw.prototype;ay.prototype=new ax();ay.__super__=aw.prototype;return ay};K=(function(aw){q(av,aw);function av(){return av.__super__.constructor.apply(this,arguments)}av.prototype.editorClass=F;av.prototype.viewerClass=g;return av})(d)}).call(this);