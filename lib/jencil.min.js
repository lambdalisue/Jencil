/*!
 * Jencil - A JavaScript Cross-browser WYSIWYM and WYSIWYG editor v0.0.2rc2
 * http://lambdalisue.github.com/Jencil
 * 
 * Copyright 2011 (c) hashnote.net, Alisue allright reserved.
 * Licensed under the MIT license.
 * 
 * Dependencies:
 * - jQuery v1.4.2
 *   http://jquery.com/
 * - Tabby jQuery plugin v0.12
 *   http://teddevito.com/demos/textarea.html
 * - Textarea v0.1.0 (included)
 *   http://demos.textarea.hashnote.net/
 * - Richarea v0.1.1 (included)
 *   http://demos.richarea.hashnote.net/
 * 
 * Includes Tabby jQuery plugin v0.12
 *   http://teddevito.com/demos/textarea.html
 *   Copyright (c) 2009 Ted Devito
 * 
 * Includes Textarea v0.1.0
 *   http://demos.textarea.hashnote.net/
 *   Copyright (c) 2011 hashnote.net, Alisue allright reserved
 * 
 * Includes Richarea v0.1.1 (included)
 *   http://demos.richarea.hashnote.net/
 *   Copyright (c) 2011 hashnote.net, Alisue allright reserved
 * 
 * Last-Modified: Thu, 06 Oct 2011 15:13:29 GMT
 */
(function(){this.Textarea=function(){function i(l){this.textarea=typeof jQuery!=="undefined"&&jQuery!==null&&l instanceof jQuery?l.get(0):l}i.prototype.getValue=function(){return this.textarea.value};i.prototype.setValue=function(l){return this.textarea.value=l};i.prototype.getSelection=function(){var l,i;if(document.selection)i=document.selection.createRange(),l=i.duplicate(),l.moveToElementText(this.textarea),l.setEndPoint("EndToEnd",i),l=l.text.length-i.text.length,i=l+i.text.length;else if(this.textarea.setSelectionRange)l=
this.textarea.selectionStart,i=this.textarea.selectionEnd;return[l,i]};i.prototype.setSelection=function(l,i){var k,m;m=this.textarea.scrollTop;if(this.textarea.createTextRange){if($.browser.opera&&$.browser.version>=9.5&&length===0)return!1;k=this.textarea.createTextRange();k.collapse(!0);k.moveStart("character",l);k.moveEnd("character",i-l);k.select()}else this.textarea.setSelectionRange&&this.textarea.setSelectionRange(l,i);this.textarea.focus();return this.textarea.scrollTop=m};i.prototype.getSelected=
function(){var l,i,k;if(document.selection)return l=document.selection.createRange(),l.text;else if(this.textarea.setSelectionRange)return k=this.getSelection(),i=k[0],l=k[1],this.textarea.value.substring(i,l);return!1};i.prototype._replaceSelected=function(i,o,k){o==null&&(o=void 0);k==null&&(k=void 0);if(document.selection)return this.textarea.focus(),k=document.selection.createRange(),k.text=i,k.select();else if(this.textarea.setSelectionRange)return o=this.textarea.value.substring(0,o),k=this.textarea.value.substring(k),
this.textarea.value=o+i+k};i.prototype.replaceSelected=function(i,o){var k,m,j;o==null&&(o=!1);m=this.textarea.scrollTop;k=this.getSelection();j=k[0];k=k[1];this._replaceSelected(i,j,k);k=j+i.length;o||(j=k);this.setSelection(j,k);this.textarea.focus();return this.textarea.scrollTop=m};i.prototype.insertBeforeSelected=function(i,o){var k,m,j,h;o==null&&(o=!1);m=this.textarea.scrollTop;j=this.getSelection();h=j[0];k=j[1];j=this.getSelected();this._replaceSelected(i+j,h,k);k=h+i.length;o||(h=k);this.setSelection(h,
k);this.textarea.focus();return this.textarea.scrollTop=m};i.prototype.insertAfterSelected=function(i,o){var k,m,j,h;o==null&&(o=!1);m=this.textarea.scrollTop;j=this.getSelection();h=j[0];k=j[1];j=this.getSelected();this._replaceSelected(j+i,h,k);k=h+i.length;o?h+=j.length:h=k;this.setSelection(h,k);this.textarea.focus();return this.textarea.scrollTop=m};i.prototype.wrapSelected=function(i,o,k,m){var j,h,f,d,b;k==null&&(k=!1);m==null&&(m=void 0);f=this.getSelected();return f.indexOf(i)===0&&f.lastIndexOf(o)===
f.length-o.length?(i=f.substring(i.length,f.length-o.length),this.replaceSelected(i,k)):(f===""&&m!=null?f=m:m=void 0,h=this.textarea.scrollTop,b=this.getSelection(),d=b[0],j=b[1],this._replaceSelected(i+f+o,d,j),k?m?(j=d+i.length+f.length,d+=i.length):j=d+i.length+o.length+f.length:d=j=d+i.length+f.length+o.length,this.setSelection(d,j),this.textarea.focus(),this.textarea.scrollTop=h)};return i}()}).call(this);
(function(){var i,l,o,k,m,j,h,f,d,b,e=function(a,g){return function(){return a.apply(g,arguments)}},c=Array.prototype.indexOf||function(a){for(var g=0,n=this.length;g<n;g++)if(this[g]===a)return g;return-1};o=function(){function a(){this.browser=this.searchString(a.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"An unknown browser";this.OS=this.searchString(a.dataOS)||"An unknown OS"}a.prototype.searchString=function(g){var a,
b,c;for(b=0,c=g.length;b<c;b++)if(a=g[b],this.versionSearchString=a.versionSearch||a.identify,a.string!=null)if(a.string.indexOf(a.subString)!==-1)return a.identify;else if(a.prop)return a.identify;return[]};a.prototype.searchVersion=function(g){var a;a=g.indexOf(this.versionSearchString);return a===-1?void 0:parseFloat(g.substring(a+this.versionSearchString.length+1))};a.dataBrowser=[{string:navigator.userAgent,subString:"Chrome",identify:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",
versionSearch:"OmniWeb/",identify:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identify:"Safari",versionSearch:"Version"},{prop:window.opera,identify:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identify:"iCab"},{string:navigator.vendor,subString:"KDE",identify:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identify:"Firefox"},{string:navigator.vendor,subString:"Camino",identify:"Camino"},{string:navigator.userAgent,subString:"Netscape",identify:"Netscape"},
{string:navigator.userAgent,subString:"MSIE",identify:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identify:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identify:"Netscape",versionSearch:"Mozilla"}];a.dataOS=[{string:navigator.platform,subString:"Win",identify:"Windows"},{string:navigator.platform,subString:"Mac",identify:"Mac"},{string:navigator.userAgent,subString:"iPhone",identify:"iPhone/iPad"},{string:navigator.platform,subString:"Linux",
identify:"Linux"}];return a}();if(typeof exports!=="undefined"&&exports!==null)exports.Detector=o;b=function(a,g){var n,b;for(b in g)n=g[b],a.prototype[b]=n;return a};if(typeof exports!=="undefined"&&exports!==null)exports.partial=b;l=function(){function a(){}a.findChildPosition=function(g){var a;for(a=0;g.previousSibling;)g=g.previousSibling,a+=1;return a};a.isDataNode=function(g){return g!=null&&g.nodeValue!=null&&g.data!=null};a.isDataContainerNode=function(g){var n,b,c;if(g.firstChild==null)return!1;
c=g.childNodes;for(n=0,b=c.length;n<b;n++)if(g=c[n],!a.isDataNode(g))return!1;return!0};a.isAncestorOf=function(g,n){var b,c,e;b=!a.isDataNode(g);c=typeof g.contains==="function"?g.contains(a.isDataNode(n)?n.parentNode:n):void 0;e=n.parentNode===g;return b&&(c||e)};a.isAncestorOrSelf=function(g,n){return a.isAncestorOf(g,n)||g===n};a.findClosestAncestor=function(g,n){if(a.isAncestorOf(g,n))for(;(n!=null?n.parentNode:void 0)!==g;)n=n.parentNode;return n};a.getNodeLength=function(g){if(a.isDataNode(g))return g.length||
g.childNodes.length};a.splitDataNode=function(g,n){var b;if(!a.isDataNode(g))return!1;b=g.cloneNode(!1);g.deleteData(n,g.length);b.deleteData(0,n);return g.parentNode.insertBefore(b,g.nextSibling)};return a}();h=function(){function a(){}a.convertToW3CRange=function(g,a){var b,c,e,d;b=function(g,b,c){var e,d,p,f,h;p=a.createElement("span");d=b.duplicate();d.collapse(c);f=d.parentElement();e=function(g,a){return g.compareEndPoints(c?"StartToStart":"StartToEnd",a)};h=function(){f.insertBefore(p,p.previousSibling);
return d.moveToElementText(p)};for(h();e(d,b)>0&&p.previousSibling;)h();if(e(d,b)===-1&&p.nextSibling)d.setEndPoint(c?"EndToStart":"EndToEnd",b),g[c?"setStart":"setEnd"](p.nextSibling,d.text.length);else g[c?"setStartBefore":"setEndBefore"](p);return p.parentNode.removeChild(p)};d=new f(a);c=g.compareEndPoints("StartToEnd",g)!==0;e=g.parentElement().isContentEditable;if(c&&e)b(d,g,!0),b(d,g,!1),d.startContainer===d.endContainer&&d.endOffset===1&&l.isDataContainerNode(d.startContainer)&&(b=l.getNodeLength(d.endContainer.firstChild),
d.setEnd(d.endContainer,b));else if(e)e=g.duplicate(),c=e.parentElement(),b=a.createElement("span"),c.insertBefore(b,c.firstChild),e.moveToElementText(b),e.setEndPoint("EndToEnd",g),e=e.text.length,d.setStart(c,e),d.setEnd(c,e),c.removeChild(b);return d};a.convertFromW3CRange=function(g){var a,b;a=function(g,a,n){var b,c,e,d,p;e=a[n?"startContainer":"endContainer"];d=a[n?"startOffset":"endOffset"];p=0;b=l.isDataNode(e)?e:e.childNodes[d];c=b.parentNode;if(e.nodeType===3||e.nodeType===4)p=d;e=a._document.createElement("span");
c.insertBefore(e,b);a=a._document.body.createTextRange();a.moveToElementText(e);e.parentNode.removeChild(e);g.setEndPoint(n?"StartToStart":"EndToStart",a);return g[n?"moveStart":"moveEnd"]("character",p)};b=g._document.body.createTextRange();a(b,g,!0);a(b,g,!1);return b};return a}();m=function(){function a(g){var a;this.range=g;if(!this.range.collapsed)a=g.commonAncestorContainer,this._current=null,this._next=g.startContainer===a&&!l.isDataNode(g.startContainer)?g.startContainer.childNodes[g.startOffset]:
l.findClosestAncestor(a,g.startContainer),this._end=g.endContainer===a&&!l.isDataNode(g.endContainer)?g.endContainer.childNodes[g.endOffset]:l.findClosestAncestor(a,g.endContainer).nextSibling}a.prototype.hasNext=function(){return this._next!=null};a.prototype.next=function(){var g;g=this._current=this._next;this._next=this._current!=null&&this._current.nextSibling!==this._end?this._current.nextSibling:null;l.isDataNode(this._current)&&(this.range.endContainer===this._current&&(g=g.cloneNode(!0),
g.deleteData(this.range.endOffset,g.length-this.range.endOffset)),this.range.startContainer===this._current&&(g=g.cloneNode(!0),g.deleteData(0,this.range.startOffset)));return g};a.prototype.remove=function(){var g,a;return l.isDataNode(this._current&&(this.range.startContainer===this._current||this.range.endContainer===this._current))?(a=this.range.startContainer===this._current?this.range.startOffset:0,g=this.range.endContainer===this._current?this.range.endOffset:this._current.length,this._current.deleteData(a,
g-a)):this._current.parentNode.removeChild(this._current)};a.prototype.hasPartialSubtree=function(){var g,a,b;g=!l.isDataNode(this._current);a=l.isAncestorOrSelf(this._current,this.range.startContainer);b=l.isAncestorOrSelf(this._current,this.range.endContainer);return g&&(a||b)};a.prototype.getSubtreeIterator=function(){var g;g=new f(this.range._document);g.selectNodeContents(this._current);l.isAncestorOrSelf(this._current,this.range.startContainer)&&g.setStart(this.range.startContainer,this.range.startOffset);
l.isAncestorOrSelf(this._current,this.range.endContainer)&&g.setEnd(this.range.endContainer,this.range.endOffset);return new a(g)};return a}();f=function(){function a(g){this._document=g;this.startContainer=g.body;this.startOffset=0;this.endContainer=g.body;this.endOffset=l.getNodeLength(g.body);this.commonAncestorContainer=null;this.collapsed=!1}a.START_TO_START=0;a.START_TO_END=1;a.END_TO_END=2;a.END_TO_START=3;a.prototype._refreshProperties=function(){var g;this.collapsed=this.startContainer===
this.endContainer&&this.startOffset===this.endOffset;for(g=this.startContainer;g!=null&&g!==this.endContainer&&!l.isAncestorOf(g,this.endContainer);)g=g.parentNode;return this.commonAncestorContainer=g};a.prototype.setStart=function(g,a){this.startContainer=g;this.startOffset=a;return this._refreshProperties()};a.prototype.setEnd=function(g,a){this.endContainer=g;this.endOffset=a;return this._refreshProperties()};a.prototype.setStartBefore=function(g){var a;a=g.parentNode;g=l.findChildPosition(g);
return this.setStart(a,g)};a.prototype.setStartAfter=function(g){var a;a=g.parentNode;g=l.findChildPosition(g);return this.setStart(a,g+1)};a.prototype.setEndBefore=function(g){var a;a=g.parentNode;g=l.findChildPosition(g);return this.setEnd(a,g)};a.prototype.setEndAfter=function(g){var a;a=g.parentNode;g=l.findChildPosition(g);return this.setEnd(a,g+1)};a.prototype.selectNode=function(g){this.setStartBefore(g);return this.setEndAfter(g)};a.prototype.selectNodeContents=function(g){this.setStart(g,
0);return this.setEnd(g,l.getNodeLength(g))};a.prototype.collapse=function(g){return g?this.setEnd(this.startContainer,this.startOffset):this.setStart(this.endContainer,this.endOffset)};a.prototype.cloneContents=function(){var g;g=function(a){var b,c;for(b=document.createDocumentFragment();(c=a.next())!=null;)c=c.cloneNode(!a.hasPartialSubtree()),a.hasPartialSubtree()&&c.appendChild(g(a.getSubtreeIterator())),b.appendChild(c);return flag};return g(new m(this))};a.prototype.extractContents=function(){var g,
a;a=this.cloneRange();this.startContainer!==this.commonAncestorContainer&&this.setStartAfter(l.findClosestAncestor(this.commonAncestorContainer,this.startContainer));this.collapse(!0);g=function(a){var b,n;for(b=document.createDocumentFragment();(n=a.next())!=null;)a.hasPartialSubtree(),a.hasPartialSubtree()?n=n.cloneNode(!1):a.remove(),a.hasPartialSubtree()&&n.appendChild(g(a.getSubtreeIterator())),b.appendChild(n);return b};return g(new m(a))};a.prototype.deleteContents=function(){var a,b;b=this.cloneRange();
this.startContainer!==this.commonAncestorContainer&&this.setStartAfter(l.findClosestAncestor(this.commonAncestorContainer,this.startContainer));this.collapse(!0);return a=function(c){for(;c.next();)c.hasPartialSubtree()?a(c.getSubtreeIterator()):c.remove();return a(new m(b))}};a.prototype.insertNode=function(a){l.isDataNode(this.startContainer)?(l.splitDataNode(this.startContainer,this.startOffset),this.startContainer.parentNode.insertBefore(a,this.startContainer.nextSibling)):this.startContainer.insertBefore(a,
this.startContainer.childNodes[this.startOffset]);return this.setStart(this.startContainer,this.startOffset)};a.prototype.surroundContents=function(a){var b;b=this.extractContents();this.insertNode(a);a.appendChild(b);return this.selectNode(a)};a.prototype.compareBoundaryPoints=function(g,b){var c,e,d,f;switch(g){case a.START_TO_START:case a.START_TO_END:c=this.startContainer;d=this.startOffset;break;case a.END_TO_END:case a.END_TO_START:c=this.endContainer,d=this.endOffset}switch(g){case a.START_TO_START:case a.END_TO_START:e=
b.startContainer;f=b.startOffset;break;case a.START_TO_END:case a.END_TO_END:e=b.endContainer,f=b.endOffset}if(c.sourceIndex<e.souceIndex)return-1;if(c.sourceIndex===e.sourceIndex){if(d<f)return-1;if(d===f)return 0}return 1};a.prototype.cloneRange=function(){var g;g=new a(this.document);g.setStart(this.startContainer,this.startOffset);g.setEnd(this.endContainer,this.endOffset);return g};a.prototype.detach=function(){};a.prototype.toString=function(){return h.convertFromW3CRange(this).text};a.prototype.createContextualFragment=
function(a){var b;b=l.isDataNode(this.startContainer)?this.startContainer.parentNode:this.startContainer;b=b.cloneNode(!1);b.innerHTML=a;for(a=this._document.createDocumentFragment();b.firstChild!=null;)a.appendChild(b.firstChild);return a};return a}();d=function(){function a(a){this.rangeCount=0;this._document=a;this._document.parentWindow.focus();this._document.attachEvent("onselectionchange",e(function(){return this._selectionChangeHolder()},this));this._refreshProperties()}a.prototype._selectionChangeHolder=
function(){var a,b;b=this._document.selection.createRange();a=b.compareEndPoints("StartToEnd",b)!==0;b=b.parentElement().isContentEditable;return a&&b?this.rangeCount=1:this.rangeCount=0};a.prototype._refreshProperties=function(){var a;a=this.getRangeAt(0);return this.isCollapsed=a==null||a.collapsed?!0:!1};a.prototype.addRange=function(a){var b;b=this._document.selection.createRange();a=h.convertFromW3CRange(a);return this._selectionExists(b)?(a.compareEndPoints("StartToStart",b)===-1?a.compareEndPoints("StartToEnd",
b)>-1&&a.compareEndPoints("EndToEnd",b)===-1&&b.setEndPoint("StartToStart",a):a.compareEndPoints("EndToStart",b)<1&&a.compareEndPoints("EndToEnd",b)>-1&&b.sendEndPoint("EndToEnd",a),b.select()):a.select()};a.prototype.removeAllRanges=function(){return this._document.selection.empty()};a.prototype.getRangeAt=function(){var a;try{return a=this._document.selection.createRange(),h.convertToW3CRange(a,this._document)}catch(b){return null}};a.prototype.toString=function(){return this._document.selection.createRange().text};
return a}();String.prototype.startsWith=function(a){return this.lastIndexOf(a,0)===0};String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};k=function(){function a(){}a.prototype.CONTAINER_ELEMENTS="body,div,center,blockquote,li,td".split(",");a.prototype.BLOCK_ELEMENTS="address,dir,dl,form,h1,h2,h3,h4,h5,h6,hr,menu,noframes,ol,p,pre,table,ul,xmp".split(",");a.prototype.createElementFromHTML=function(a){var b;b=document.createElement("div");b.innerHTML=a;return b.firstChild};a.prototype.getTextContent=
function(a,b){var c;b==null&&(b=!1);c=a.textContent||a.nodeValue;return b?c.trim():c};a.prototype.isContainerNode=function(a){var b,e;return(b=(e=a.tagName)!=null?e.toLowerCase():void 0,a=b)&&c.call(this.CONTAINER_ELEMENTS,a)>=0};a.prototype.isBlockNode=function(a){var b,e;return(b=(e=a.tagName)!=null?e.toLowerCase():void 0,a=b)&&c.call(this.BLOCK_ELEMENTS,a)>=0};a.prototype.isInlineNode=function(a){return!this.isContainerNode(a&&!this.isBlockNode(a))};a.prototype.isVisibleNode=function(a){var b,
c,e;if(a.nodeType===3)return a=this.getTextContent(a),a=a.replace(/\s\t\r\n/,""),a.length!==0;else{e=a.childNodes;for(b=0,c=e.length;b<c;b++)if(a=e[b],this.isVisibleNode(a)===!1)return!1;return!0}};a.prototype.isIsolateNode=function(a){return!a.nextSibling&&!a.previousSibling};a.prototype.getNextNode=function(a){for(;!a.nextSibling;)if(a=a.parentNode,!a)return null;return a.nextSibling};a.prototype.getNextLeaf=function(a){for(a=this.getNextNode(a);(a!=null?a.firstChild:void 0)!=null;)a=a.firstChild;
return a};a.prototype.getPreviousNode=function(a){for(;!a.previousSibling;)if(a=a.parentNode,!a)return null;return a.previousSibling};a.prototype.getPreviousLeaf=function(a){for(a=this.getPreviousNode(a);(a!=null?a.lastChild:void 0)!=null;)a=a.lastChild;return a};a.prototype.extractLeaf=function(a,b,c){var e,d,f,h;b==null&&(b=void 0);c==null&&(c=void 0);d=this.getTextContent(a,!1);b==null&&(b=0);if(c==null)c=d.length;if(b===c||b===0&&c===d.length)return a;e=d.substring(0,b);b=d.substring(b,c);f=d.substring(c,
d.length);c=a.nextSibling;d=a.parentNode;d.removeChild(a);e.length>0&&(a=document.createTextNode(e.trim()),this.isVisibleNode(a)&&d.insertBefore(a,c));b.length>0&&(h=document.createTextNode(b.trim()),d.insertBefore(h,c));f.length>0&&(a=document.createTextNode(f.trim()),this.isVisibleNode(a)&&d.insertBefore(a,c));return h};return a}();if(typeof exports!=="undefined"&&exports!==null)exports.NodeUtils=k;if(typeof require!=="undefined"&&require!==null)b=require("./partial").partial,k=require("./nodeutils.core").NodeUtils;
k=b(k,{_unwrapNode:function(a){var b,c,e,d;e=a.parentNode;c=e.nextSibling;b=e.parentNode;b.removeChild(e);for(d=[];e.firstChild!=null;)a=e.firstChild,d.push(b.insertBefore(a,c));return d},unwrapNode:function(a,b,e){var d,f,h;for(e==null&&(e=!1);a.parentNode!=null&&(e||this.isIsolateNode(a));){d=a.parentNode;if(f=(h=d.tagName)!=null?h.toLowerCase():void 0,c.call(b,f)>=0)return this._unwrapNode(a),!0;a=d}return!1},convertNode:function(a,b,e,d){var f,h,i,j;d==null&&(d=!1);for(i=function(a,b){var g,c;
g=a.nextSibling;c=a.parentNode;for(c.removeChild(a);a.firstChild!=null;)b.appendChild(a.firstChild);return c.insertBefore(b,g)};a.parentNode!=null&&(d||this.isIsolateNode(a));){f=a.parentNode;h=(j=f.tagName)!=null?j.toLowerCase():void 0;if(c.call(b,h)>=0)return h===e.tagName.toLowerCase()?this._unwrapNode(a):i(f,e),!0;a=f}return!1},wrapLeaf:function(a,b,c){var e,d,f;c==null&&(c=!0);if(!this.isVisibleNode(a))return!1;d=function(a,b){var g,c;g=a.nextSibling;c=a.parentNode;c.removeChild(a);b.appendChild(a);
return c.insertBefore(b,g)};f=function(a,b){var g,c,e,d,f;d=a.parentNode;f=null;if(a.previousSibling!=null){f=d.cloneNode(!1);for(g=a;g.previousSibling!=null;)g=g.previousSibling,f.insertBefore(g,f.firstChild)}e=null;if(a.nextSibling!=null){e=d.cloneNode(!1);for(g=a;g.nextSibling!=null;)g=g.nextSibling,e.insertBefore(g,null)}c=d.nextSibling;g=d.parentNode;g.removeChild(d);f!=null&&g.insertBefore(f,c);b.appendChild(a);g.insertBefore(b,c);if(e!=null)return g.insertBefore(e,c)};if(this.isContainerNode(b)){if(c||
!this.unwrapNode(a,[b.tagName.toLowerCase()],!0)){for(c=a;c.parentNode!=null;){e=c.parentNode;if(this.isContainerNode(e))return d(c,b),!0;c=e}d(a,b)}}else if(this.isBlockNode(b)){if(c||!this.convertNode(a,this.BLOCK_ELEMENTS,b,!0)){for(c=a;c.parentNode!=null;){e=c.parentNode;if(this.isContainerNode(e)&&this.isBlockNode(e))return f(c,b),!0;c=e}for(c=a;c.parentNode!=null;){e=c.parentNode;if(this.isContainerNode(e))return d(c,b),!0;c=e}d(a,b)}}else(c||!this.unwrapNode(a,[b.tagName.toLowerCase()],!0))&&
d(a,b);return!0},wrapNode:function(a,b,c,e,d){var f,h,i,j;c==null&&(c=!1);e==null&&(e=void 0);d==null&&(d=void 0);if(a.firstChild==null)return a=this.extractLeaf(a,e,d),this.wrapLeaf(a,b,c);e==null&&(e=0);if(d==null)d=a.childNodes.length;i=a.childNodes;j=[];for(f=0,h=i.length;f<h;f++)a=i[f],j.push(a!=null?this.wrapNode(a,b,c,e,d):void 0);return j},wrapRange:function(a,b,c){var e,d,f,h,i,j;c==null&&(c=!1);if(a.startContainer===a.endContainer)return this.wrapNode(a.startContainer,b,c,a.startOffset,
a.endOffset);if(!c&&(d=!1,this.isContainerNode(b)?d=this.convertNode(a.commonAncestorContainer,[(i=b.tagName)!=null?i.toLowerCase():void 0],b,!0):this.isBlockNode(b)&&(d=this.convertNode(a.commonAncestorContainer,this.BLOCK_ELEMENTS,b,!0)),d===!0))return!0;if(this.isContainerNode(b))b.appendChild(a.extractContents()),a.insertNode(b);else{if(this.isBlockNode(b)){if(!function(a,b){var g;for(g=a;g!=null||g===b;){if(this.isBlockNode(g))return!0;g=this.getNextNode(g)}return!1}(a.startContainer,a.endContainer)){b.appendChild(a.extractContents());
a.insertNode(b);return}h=!0}else h=!1;d=function(a){return h?this.getNextNode(a):this.getNextLeaf(a)};e=function(a){return h?this.getPreviousNode(a):this.getPreviousLeaf(a)};a.startContainer.firstChild!=null?i=a.startContainer.childNodes[a.startOffset]:(i=d(a.startContainer),this.wrapNode(a.startContainer,b,c,a.startOffset,void 0));a.endContainer.firstChild!=null?e=a.endOffset>0?a.endContainer.childNodes[a.endOffset-1]:e(a.endContainer):(e=e(a.endContainer),this.wrapNode(a.endContainer,b,c,void 0,
a.endOffset));for(j=[];i!=null&&i!==a.endContainer;){f=d(i);i.parentNode!=null&&this.wrapNode(i,b,c);if(i===e)break;j.push(i=f)}return j}},unwrapRange:function(a,b,c){c==null&&(c=!1);return this.unwrapNode(a.commonAncestorContainer,b,c)},convertRange:function(a,b,c,e){e==null&&(e=!1);return this.convertNode(a.commonAncestorContainer,b,c,e)}});if(typeof exports!=="undefined"&&exports!==null)exports.NodeUtils=k;if(typeof require!=="undefined"&&require!==null)b=require("./partial").partial,k=require("./nodeutils.wrap").NodeUtils;
k=b(k,{unstyleLeaf:function(a,b,c){var e,d,f;c==null&&(c=!1);for(e=c?"div":"span";a.parentNode!=null&&a.parentNode.tagName!=null;){c=a.parentNode;d=c.tagName.toLowerCase();if(d===e){for(d=0,f=b.length;d<f;d++)e=b[d],c.style[e]="";c.getAttribute("style")===""&&this._unwrapNode(a);return!0}a=c}return!1},styleLeaf:function(a,b,c,e){var d,f,h,i,j,k,m,l,o;c==null&&(c=!1);e==null&&(e=!1);o=c?"div":"span";l=document.createElement(o);for(h in b)m=b[h],l.style[h]=m;k=function(){var a;a=[];for(h in b)m=b[h],
a.push(h);return a}();f=function(a){var b,c,g;for(c=0,g=k.length;c<g;c++)if(b=k[c],a.style[b]!==l.style[b])return!1;return!0};for(d=a;d.parentNode!=null&&d.parentNode.tagName!=null;){i=d.parentNode;j=i.tagName.toLowerCase();if(j===o){if(!e&&f(i))this.unstyleLeaf(d,k,c);else for(h in b)m=b[h],i.style[h]=m;return!0}d=i}this.wrapLeaf(a,l);return!0},styleNode:function(a,b,c,e,d,f){var h,i,j,k;c==null&&(c=!1);e==null&&(e=!1);d==null&&(d=void 0);f==null&&(f=void 0);if(a.firstChild==null)return a=this.extractLeaf(a,
d,f),this.styleLeaf(a,b,c,e);d==null&&(d=0);if(f==null)f=a.childNodes.length;j=a.childNodes;k=[];for(h=0,i=j.length;h<i;h++)a=j[h],k.push(a!=null?this.styleNode(a,b,c,e,d,f):void 0);return k},styleRange:function(a,b,c,e){var d,f,h,i,j;c==null&&(c=!1);e==null&&(e=!1);if(a.startContainer===a.endContainer)return this.styleNode(a.startContainer,b,c,e,a.startOffset,a.endOffset);f=function(a){return this.getNextLeaf(a)};d=function(a){return this.getPreviousLeaf(a)};a.startContainer.firstChild!=null?i=a.startContainer.childNodes[a.startOffset]:
(i=f(a.startContainer),this.styleNode(a.startContainer,b,c,e,a.startOffset,void 0));a.endContainer.firstChild!=null?d=a.endOffset>0?a.endContainer.childNodes[a.endOffset-1]:d(a.endContainer):(d=d(a.endContainer),this.styleNode(a.endContainer,b,c,e,void 0,a.endOffset));for(j=[];i!=null&&i!==a.endContainer;){h=f(i);i.parentNode!=null&&this.styleNode(i,b,c,e);if(i===d)break;j.push(i=h)}return j},unstyleRange:function(a,b,c,e){c==null&&(c=!1);e==null&&(e=!1);return this.unstyleLeaf(a.commonAncestorContainer,
b,c,e)}});if(typeof exports!=="undefined"&&exports!==null)exports.NodeUtils=k;i=function(){function a(a){this.raw=a;this.utils=new k}a.prototype.execCommand=function(a,b,c){var f,h,i;c==null&&(c=!1);f=e(function(){if(this.raw.window.getSelection!=null)return this.raw.window.getSelection();else if(this.raw.document.selection!=null)return new d(this.raw.document)},this)();if(f==null)return((h=window.console)!=null?h.error:void 0)!=null&&console.error("This browser does not support W3C type of range or Microsoft type of range."),
!1;f=f.getRangeAt(0);switch(a){case "wrap":this.utils.wrapRange(f,this.utils.createElementFromHTML(b),c);break;case "unwrap":this.utils.unwrapRange(f,b,c);break;case "style":this.utils.styleRange(f,b,c);break;case "unstyle":this.utils.unstyleRange(f,b,c);break;default:return((i=window.console)!=null?i.error:void 0)!=null&&console.error("Unknown command type has passed. type: "+a),!1}return!0};return a}();if(typeof exports!=="undefined"&&exports!==null)exports.API=i;if(typeof require!=="undefined"&&
require!==null)b=require("../utils/partial").partial,i=require("./api.core").API;i=b(i,{strong:function(){return this.execCommand("wrap","<strong>")},em:function(){return this.execCommand("wrap","<em>")},ins:function(){return this.execCommand("wrap","<ins>")},del:function(){return this.execCommand("wrap","<del>")},sub:function(){return this.execCommand("wrap","<sub>")},sup:function(){return this.execCommand("wrap","<sup>")}});if(typeof exports!=="undefined"&&exports!==null)exports.API=i;if(typeof require!==
"undefined"&&require!==null)b=require("../utils/partial").partial,i=require("./api.core").API;i=b(i,{blockquote:function(){return this.execCommand("wrap","<blockquote>",!0)},unblockquote:function(){return this.execCommand("unwrap",["blockquote"],!0)},heading:function(a){return this.execCommand("wrap","<h"+a+">")},h1:function(){return this.heading(1)},h2:function(){return this.heading(2)},h3:function(){return this.heading(3)},h4:function(){return this.heading(4)},h5:function(){return this.heading(5)},
h6:function(){return this.heading(6)},p:function(){return this.execCommand("wrap","<p>")},pre:function(){return this.execCommand("wrap","<pre>")}});if(typeof exports!=="undefined"&&exports!==null)exports.API=i;if(typeof require!=="undefined"&&require!==null)b=require("../utils/partial").partial,i=require("./api.core").API;i=b(i,{a:function(a){return this.execCommand("wrap","<a href='"+a+"'>")},img:function(a){return this.execCommand("wrap","<img src='"+a+"'>")},ul:function(){return this.raw.execCommand("insertUnorderedList")},
ol:function(){return this.raw.execCommand("insertOrderedList")},hr:function(){return this.raw.execCommand("insertHorizontalRule")}});if(typeof exports!=="undefined"&&exports!==null)exports.API=i;if(typeof require!=="undefined"&&require!==null)b=require("../utils/partial").partial,i=require("./commandapi.core").API;i=b(i,{forecolor:function(a){return this.execCommand("style",{color:a})},backcolor:function(a){return this.execCommand("style",{backgroundColor:a})},fontfamily:function(a){return this.execCommand("style",
{fontFamily:a})},fontsize:function(a){return this.execCommand("style",{fontSize:a})},justifyleft:function(){return this.execCommand("style",{textAlign:"left"},!0)},justifycenter:function(){return this.execCommand("style",{textAlign:"center"},!0)},justifyright:function(){return this.execCommand("style",{textAlign:"right"},!0)},justifyfull:function(){return this.execCommand("style",{textAlign:"justify"},!0)}});if(typeof exports!=="undefined"&&exports!==null)exports.API=i;if(typeof require!=="undefined"&&
require!==null)b=require("../utils/partial").partial,i=require("./api.core").API;i=b(i,{indent:function(){return this.raw.execCommand("indent")},outdent:function(){return this.raw.execCommand("outdent")}});if(typeof exports!=="undefined"&&exports!==null)exports.API=i;if(typeof require!=="undefined"&&require!==null)o=require("./utils/detector").Detector;j=function(){function a(a){var b,c;this.iframe=a;b=new o;this._loaded=!1;this._callbacks=[];this.ready(e(function(){var a,c;this.document=this.iframe.contentDocument!=
null?this.iframe.contentDocument:this.iframe.contentWindow.document;this.document.body==null&&this.document.writeln("<body></body>");this.body=this.document.body;this.body.style.cursor="text";this.body.style.height="100%";b.browser==="Explorer"&&b.version<9&&(a=e(function(){return this.body.style.height=""+this.iframe.offsetHeight+"px"},this),setTimeout(e(function(){var b,c;((b=this.iframe)!=null?b.offsetHeight:void 0)!==((c=this.body)!=null?c.offsetHeight:void 0)&&a();return setTimeout(arguments.callee,
100)},this),100));if(this.body.spellcheck!=null)this.body.spellcheck=!1;this.body.contentEditable!=null?this.body.contentEditable=!0:this.document.designMode!=null?this.document.designMode="On":((c=window.console)!=null?c.error:void 0)!=null&&console.error("This browser doesn't support contentEditable nor designMode");return this.window=this.iframe.contentWindow},this));c=e(function(){var a,b,c,g;this._loaded=!0;g=this._callbacks;for(b=0,c=g.length;b<c;b++)a=g[b],a();return this._callbacks=void 0},
this);this.iframe.getAttribute("src")!=null?b.browser==="Explorer"&&b.version<9?this.iframe.attachEvent("onreadystatechange",e(function(){if(this.iframe.readyState==="complete")return this.iframe.onreadystatechange=null,c()},this)):this.iframe.addEventListener("load",e(function(){return c()},this),!1):c()}a.prototype.ready=function(a){a==null&&(a=void 0);return a==null?this._loaded:this._loaded?a():this._callbacks.push(a)};a.prototype.getValue=function(){if(this.ready())return this.body.innerHTML};
a.prototype.setValue=function(a){if(this.ready())return this.body.innerHTML=a};a.prototype.execCommand=function(a,b,c){b==null&&(b=!1);c==null&&(c=null);return this.document.execCommand(a,b,c)};a.prototype.queryCommandState=function(a){return this.document.queryCommandState(a)};a.prototype.queryCommandEnabled=function(a){return this.document.queryCommandEnabled(a)};a.prototype.queryCommandIndeterm=function(a){return this.document.queryCommandIndeterm(a)};a.prototype.queryCommandSupported=function(a){return this.document.queryCommandSupported(a)};
a.prototype.queryCommandValue=function(a){return this.document.queryCommandValue(a)};return a}();if(typeof exports!=="undefined"&&exports!==null)exports.Rawarea=j;this.Richarea=function(){function a(a){this.iframe=a;if(window.jQuery!=null&&this.iframe instanceof jQuery)this.iframe=this.iframe.get(0);this.raw=new j(this.iframe);this.raw.ready(e(function(){var a;if(this.iframe.innerHTML!=null)return a=this.iframe.innerHTML,a=a.split("&lt;").join("<"),a=a.split("&gt;").join(">"),this.setValue(a)},this));
this.api=new i(this.raw)}a.prototype.ready=function(a){a==null&&(a=void 0);return this.raw.ready(a)};a.prototype.getValue=function(){return this.raw.getValue()};a.prototype.setValue=function(a){return this.raw.setValue(a)};a.prototype.execCommand=function(a,b){var c;b==null&&(b=void 0);if(a in this.api)return this.api[a](b);else if(((c=window.console)!=null?c.error:void 0)!=null)return console.error("Command '"+a+"' not found.")};return a}();if(typeof exports!=="undefined"&&exports!==null)exports.Richarea=
Richarea}).call(this);
(function(i){i.fn.tabby=function(l){var o=i.extend({},i.fn.tabby.defaults,l),k=i.fn.tabby.pressed;return this.each(function(){$this=i(this);var m=i.meta?i.extend({},o,$this.data()):o;$this.bind("keydown",function(j){var h=i.fn.tabby.catch_kc(j);if(16==h)k.shft=!0;if(17==h)k.ctrl=!0,setTimeout("$.fn.tabby.pressed.ctrl = false;",1E3);if(18==h)k.alt=!0,setTimeout("$.fn.tabby.pressed.alt = false;",1E3);if(9==h&&!k.ctrl&&!k.alt){k.last=h;setTimeout("$.fn.tabby.pressed.last = null;",0);var j=i(j.target).get(0),
f=k.shft,h=j.scrollTop;if(j.setSelectionRange){var d=j.selectionStart,b=j.selectionEnd;if(d==b)if(f)if("\t"==j.value.substring(d-m.tabString.length,d))j.value=j.value.substring(0,d-m.tabString.length)+j.value.substring(d),j.focus(),j.setSelectionRange(d-m.tabString.length,d-m.tabString.length);else{if("\t"==j.value.substring(d,d+m.tabString.length))j.value=j.value.substring(0,d)+j.value.substring(d+m.tabString.length),j.focus(),j.setSelectionRange(d,d)}else j.value=j.value.substring(0,d)+m.tabString+
j.value.substring(d),j.focus(),j.setSelectionRange(d+m.tabString.length,d+m.tabString.length);else{var e=j.value.split("\n"),c=[],a=0,g=0,n;for(n in e)g=a+e[n].length,c.push({start:a,end:g,selected:a<=d&&g>d||g>=b&&a<b||a>d&&g<b}),a=g+1;e=0;for(n in c)if(c[n].selected)if(a=c[n].start+e,f&&m.tabString==j.value.substring(a,a+m.tabString.length))j.value=j.value.substring(0,a)+j.value.substring(a+m.tabString.length),e-=m.tabString.length;else if(!f)j.value=j.value.substring(0,a)+m.tabString+j.value.substring(a),
e+=m.tabString.length;j.focus();j.setSelectionRange(d+(e>0?m.tabString.length:e<0?-m.tabString.length:0),b+e)}}else if(document.selection&&(n=document.selection.createRange(),j==n.parentElement()))if(""==n.text){if(f){f=n.getBookmark();n.moveStart("character",-m.tabString.length);if(m.tabString==n.text)n.text="";else if(n.moveToBookmark(f),n.moveEnd("character",m.tabString.length),m.tabString==n.text)n.text="";n.collapse(!0)}else n.text=m.tabString,n.collapse(!1);n.select()}else{b=n.text;d=b.length;
c=b.split("\r\n");b=document.body.createTextRange();b.moveToElementText(j);b.setEndPoint("EndToStart",n);a=b.text;e=a.split("\r\n");a=a.length;g=document.body.createTextRange();g.moveToElementText(j);g.setEndPoint("StartToEnd",n);var g=g.text,l=document.body.createTextRange();l.moveToElementText(j);l.setEndPoint("StartToEnd",b);var o=l.text,l=i(j).html();i("#r3").text(a+" + "+d+" + "+g.length+" = "+l.length);a+o.length<l.length?(e.push(""),a+=2,f&&m.tabString==c[0].substring(0,m.tabString.length)?
c[0]=c[0].substring(m.tabString.length):f||(c[0]=m.tabString+c[0])):f&&m.tabString==e[e.length-1].substring(0,m.tabString.length)?e[e.length-1]=e[e.length-1].substring(m.tabString.length):f||(e[e.length-1]=m.tabString+e[e.length-1]);for(o=1;o<c.length;o++)f&&m.tabString==c[o].substring(0,m.tabString.length)?c[o]=c[o].substring(m.tabString.length):f||(c[o]=m.tabString+c[o]);1==e.length&&0==a&&(f&&m.tabString==c[0].substring(0,m.tabString.length)?c[0]=c[0].substring(m.tabString.length):f||(c[0]=m.tabString+
c[0]));a+d+g.length<l.length&&c.push("");b.text=e.join("\r\n");n.text=c.join("\r\n");f=document.body.createTextRange();f.moveToElementText(j);0<a?f.setEndPoint("StartToEnd",b):f.setEndPoint("StartToStart",b);f.setEndPoint("EndToEnd",n);f.select()}j.scrollTop=h;return!1}}).bind("keyup",function(j){if(16==i.fn.tabby.catch_kc(j))k.shft=!1}).bind("blur",function(j){9==k.last&&i(j.target).one("focus",function(){k.last=null}).get(0).focus()})})};i.fn.tabby.catch_kc=function(i){return i.keyCode?i.keyCode:
i.charCode?i.charCode:i.which};i.fn.tabby.pressed={shft:!1,ctrl:!1,alt:!1,last:null};i.fn.tabby.defaults={tabString:String.fromCharCode(9)}})(jQuery);
(function(){var i,l,o=Array.prototype.slice,k=function(h,f){return function(){return h.apply(f,arguments)}},m=Object.prototype.hasOwnProperty,j=function(h,f){function d(){this.constructor=h}for(var b in f)m.call(f,b)&&(h[b]=f[b]);d.prototype=f.prototype;h.prototype=new d;h.__super__=f.prototype;return h};l=function(){function h(){this.browser=this.searchString(h.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"An unknown browser";
this.OS=this.searchString(h.dataOS)||"An unknown OS"}h.prototype.searchString=function(f){var d,b,e;for(b=0,e=f.length;b<e;b++)if(d=f[b],this.versionSearchString=d.versionSearch||d.identify,d.string!=null)if(d.string.indexOf(d.subString)!==-1)return d.identify;else if(d.prop)return d.identify;return[]};h.prototype.searchVersion=function(f){var d;d=f.indexOf(this.versionSearchString);return d===-1?void 0:parseFloat(f.substring(d+this.versionSearchString.length+1))};h.dataBrowser=[{string:navigator.userAgent,
subString:"Chrome",identify:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identify:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identify:"Safari",versionSearch:"Version"},{prop:window.opera,identify:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identify:"iCab"},{string:navigator.vendor,subString:"KDE",identify:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identify:"Firefox"},{string:navigator.vendor,subString:"Camino",
identify:"Camino"},{string:navigator.userAgent,subString:"Netscape",identify:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identify:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identify:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identify:"Netscape",versionSearch:"Mozilla"}];h.dataOS=[{string:navigator.platform,subString:"Win",identify:"Windows"},{string:navigator.platform,subString:"Mac",identify:"Mac"},{string:navigator.userAgent,
subString:"iPhone",identify:"iPhone/iPad"},{string:navigator.platform,subString:"Linux",identify:"Linux"}];return h}();if(typeof exports!=="undefined"&&exports!==null)exports.Detector=l;window.namespace=function(h,f,d){var b,e,c,a,g;arguments.length<3&&(b=[typeof exports!=="undefined"?exports:window].concat(o.call(arguments)),h=b[0],f=b[1],d=b[2]);e=h;g=f.split(".");for(c=0,a=g.length;c<a;c++)b=g[c],h=h[b]||(h[b]={});return d(h,e)};if(typeof exports!=="undefined"&&exports!==null)exports.namespace=
namespace;namespace(this,"dynamicloader.script",function(h){var f;h.include=f=function(d){var b;b=document.createElement("script");b.type="text/javascript";b.src=d;document.head=document.head||document.getElementsByTagName("head")[0];return document.head.appendChild(b)};h.load=function(d,b,e,c){var a;c==null&&(c=5E3);a=new Function("return !!("+b+")");return a()?typeof e==="function"?e():void 0:(f(d),setTimeout(function(){return c=!0},c),setTimeout(function(){return c!==!0&&!a()?setTimeout(arguments.callee,
100):typeof e==="function"?e():void 0},100))};return h.loadall=function(){return next()}});namespace("dynamicloader.css",function(h){h.include=function(f,d){var b;d==null&&(d="all");b=document.createElement("link");b.rel="stylesheet";b.type="text/css";b.media=d;b.href=f;document.head=document.head||document.getElementsByTagName("head")[0];return document.head.appendChild(b)};return h.remove=function(f){return i("link").each(function(d,b){if(b.href.match(f)!=null)return i(b).remove()})}});if(String.prototype.startsWith==
null)String.prototype.startsWith=function(h){return this.lastIndexOf(h,0)===0};if(String.prototype.endsWith==null)String.prototype.endsWith=function(h){var f;f=this.length-h.length;return f>=0&&this.lastIndexOf(h,f)===f};if(String.prototype.replaceAll==null)String.prototype.replaceAll=function(h,f){return this.split(h).join(f)};if(String.prototype.trim==null)String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};i=jQuery;i.fn.jencil=function(h){h=i.extend(!0,Jencil.options["default"],
h);if(this.length>1&&h.documentTypeElement!=null)logger.warn("documentTypeElement is not avaialble on multiple textarea"),h.documentTypeElement=void 0;Jencil.utils.path.init(h);Jencil.theme.init(h);if(Jencil.jencils==null)Jencil.jencils=[];return this.each(function(){return Jencil.jencils.push(new Jencil.core.JencilCore(i(this),h))})};namespace("Jencil.core",function(h){return h.JencilCore=function(){function f(d,b){this.$textarea=d;this.options=b;this.profile=void 0;this.wrapper=new Jencil.widget.Wrapper(this);
this.buttonHolder=new Jencil.widget.ButtonHolder(this);this.documentType=new Jencil.widget.DocumentType(this);this.toolbar=new Jencil.widget.Toolbar(this);this.toolbar.append(this.buttonHolder);this.toolbar.append(this.documentType);this.wrapper.append(this.toolbar);this.workspace=new Jencil.widget.Workspace(this);this.wrapper.append(this.workspace);this.$textarea.after(this.wrapper.$element);this.$textarea.hide();Jencil.profile.load(this,this.getProfileName())}f.prototype.update=function(){return this.workspace.use(this.profile.editor,
k(function(){this.buttonHolder.update();return this.workspace.editor.update()},this))};f.prototype.getProfileName=function(){return this.documentType.getProfileName()};f.prototype.getSourceValue=function(){return this.$textarea.val()};f.prototype.setSourceValue=function(d){return this.$textarea.val(d)};return f}()});namespace("Jencil.utils",function(h){return h.detector=new l});namespace("Jencil.utils.path",function(h){var f;h.init=function(d){var b,e;return h.path=new f((b=(e=d.root)!=null?e:d.rootPattern)!=
null?b:/(.*)jencil(\.min)?\.js/)};h.abspath=function(d,b,e){e==null&&(e="~/");return h.path.abspath(d,b,e)};return h.Path=f=function(){function d(b){b instanceof RegExp?i("script").each(k(function(e,c){var a;a=c.src.match(b);if(a!=null)return this.root=a[1],this.root=this.root.slice(0,this.root.length-2+1||9E9)},this)):this.root=b}d.prototype.abspath=function(b,e,c){c==null&&(c="~/");if(e==null)e=this.root;b!=null&&b.startsWith(c)&&(b=""+e+"/"+b.slice(2,b.length+1||9E9));return b};return d}()});namespace("Jencil.utils.script",
function(h){h.load=function(f,d,b){return dynamicloader.script.load(Jencil.utils.path.abspath(f),d,b)};return h.loadall=function(f,d){var b;b=0;return function(){var e,c;c=f[b][0];e=f[b][1];b++;return b>f.length?typeof d==="function"?d():void 0:Jencil.utils.module.load(c,e,next)}()}});namespace("Jencil.utils.css",function(h){h.include=function(f){return dynamicloader.css.include(f)};return h.remove=function(f){return dynamicloader.css.remove(f)}});namespace("Jencil.utils.string",function(h){return h.format=
function(f,d){var b,e;for(b in d)e=d[b],f=f.replace("{{"+b+"}}",e);return f}});namespace("Jencil.options",function(h){return h["default"]={debug:!0,root:null,rootPattern:null,theme:{root:"~/extras/themes","default":"default"},profile:{root:"~/extras/profiles","default":"default"}}});namespace("Jencil.profile",function(h){h.abspath=function(f,d){f.endsWith(".js")||(f=""+d.options.profile.root+"/"+f+".js");return Jencil.utils.path.abspath(f)};return h.load=function(f,d){var b;b=Jencil.profile.abspath(d,
f);delete Jencil.profile.Profile;delete f.profile;return Jencil.utils.script.load(b,"Jencil.profile.Profile",function(){f.profile=new Jencil.profile.Profile(f);return f.update()})}});namespace("Jencil.theme",function(h){h.root=void 0;h.init=function(f){h.root=Jencil.utils.path.abspath(f.theme.root);return Jencil.theme.load(f.theme["default"])};h.load=function(f){var d,b,e,c,a;Jencil.theme.current!=null&&Jencil.utils.css.remove(RegExp(""+Jencil.theme.current+"/.*.css"));Jencil.theme.current=Jencil.utils.path.abspath(""+
Jencil.theme.root+"/"+f);Jencil.theme.include(""+Jencil.theme.current+"/style.css","screen, projection");if(Jencil.jencils!=null){e=Jencil.jencils;a=[];for(f=0,b=e.length;f<b;f++)d=e[f],d=d.workspace.editor.constructor,a.push(((c=d.extras)!=null?c.stylesheets:void 0)!=null?Jencil.theme.includeall(d.extras.stylesheets):void 0);return a}};h.abspath=function(f){return Jencil.utils.path.abspath(f,Jencil.theme.current)};h.include=function(f,d){f=Jencil.theme.abspath(f);return Jencil.utils.css.include(f,
d)};return h.includeall=function(f){var d,b,e,c;c=[];for(b=0,e=f.length;b<e;b++)d=f[b],c.push(Jencil.theme.include(d,"screen, projection"));return c}});namespace("Jencil.widget",function(h){var f;h.Widget=f=function(){function d(b,e,c){this.jencil=b;this.cls=e;c==null&&(c="div");this.$element=i("<"+c+">").addClass(e)}d.prototype.after=function(b){return this.$element.after(b.$element)};d.prototype.append=function(b){return this.$element.append(b.$element)};d.prototype.appendTo=function(b){return this.$element.appendTo(b.$element)};
d.prototype.before=function(b){return this.$element.before(b.$element)};d.prototype.prepend=function(b){return this.$element.prepend(b.$element)};d.prototype.prependTo=function(b){return this.$element.prependTo(b.$element)};return d}();h.Wrapper=function(){function d(b){d.__super__.constructor.call(this,b,"jencil")}j(d,f);return d}();h.DocumentType=function(){function d(b){d.__super__.constructor.call(this,b,"jencil-document-type");this.$documentTypeElement=this.jencil.options.documentTypeElement;
if(this.$documentTypeElement!=null){if(!(this.$documentTypeElement instanceof jQuery))this.$documentTypeElement=i(this.$documentTypeElement);this.$element.append(this.$documentTypeElement);this.$documentTypeElement.change(k(function(){return Jencil.profile.load(this.jencil,this.getProfileName())},this))}}j(d,f);d.prototype.getProfileName=function(){return this.$documentTypeElement!=null?this.$documentTypeElement.val():this.jencil.options.profile["default"]};return d}();h.ButtonHolder=function(){function d(b){d.__super__.constructor.call(this,
b,"jencil-button-holder")}j(d,f);d.prototype.update=function(){var b,e,c,a,g,d;this.$element.children().remove();g=this.jencil.profile.buttonsets;d=[];for(c=0,a=g.length;c<a;c++)b=g[c],e=b[0],b=b.slice(1,b.length+1||9E9),e=Jencil.button.createButton(this.jencil,e,b),d.push(this.append(e));return d};return d}();h.Toolbar=function(){function d(b){d.__super__.constructor.call(this,b,"jencil-toolbar")}j(d,f);return d}();return h.Workspace=function(){function d(b){d.__super__.constructor.call(this,b,"jencil-workspace");
this.editor=null}j(d,f);d.prototype.use=function(b,e){return Jencil.editor.use(this.jencil,b,k(function(){return e()},this))};return d}()});namespace("Jencil.button",function(h){var f,d;d=Jencil.widget.Widget;h.createButton=function(b,e,c){var a;switch(e){case "-":case "separator":a=Jencil.button.Separator;break;case "+":case "exec":a=Jencil.button.ExecButton;break;case "preview":a=Jencil.button.PreviewButton;break;default:if(a=Jencil.button[e],a==null)throw Error("Unknown button type is passed (type: "+
e+")");}return new a(b,c)};h.ButtonBase=f=function(){function b(e,c,a){b.__super__.constructor.call(this,e,"button","a");this.$element.addClass(c);this.$element.attr("title",a);this.$element.css("cursor","pointer");Jencil.utils.detector.browser==="Explorer"&&Jencil.utils.detector.version<8&&this.$element.attr("href","javascript:void(0);");this.$element.append(i("<span>"+a+"</span>"));this.$element.click(k(function(){this.clickBefore();this.click();return this.clickAfter()},this))}j(b,d);b.prototype.editor=
function(){return this.jencil.workspace.editor};b.prototype.clickBefore=function(){};b.prototype.click=function(){};b.prototype.clickAfter=function(){};return b}();h.MarkupButtonBase=function(){function b(){b.__super__.constructor.apply(this,arguments)}j(b,f);b.prototype.clickAfter=function(){this.editor().update();return this.editor().focus()};return b}();h.Separator=function(){function b(e){b.__super__.constructor.call(this,e,"separator","span");this.$element.append(i("<span>|</span>"))}j(b,d);
return b}();h.ExecButton=function(){function b(e,c){var a,g;a=c[0];g=c[1];this._click=c[2];this._clickBefore=c[3];this._clickAfter=c[4];b.__super__.constructor.call(this,e,a,g)}j(b,f);b.prototype.clickBefore=function(){return this._clickBefore(this.editor())};b.prototype.click=function(){return this._click(this.editor())};b.prototype.clickAfter=function(){return this._clickAfter(this.editor())};return b}();return h.PreviewButton=function(){function b(e){b.__super__.constructor.call(this,e,"preview",
"Preview")}j(b,f);b.prototype.click=function(){var b,c;b=this.editor();(c=b.preview)!=null&&c.toggle();return b.relocate()};return b}()});namespace("Jencil.editor",function(h){var f,d,b,e;d=Jencil.widget.Widget;b=function(b){return b.outerWidth(!0)-b.width()};e=function(b){return b.outerHeight(!0)-b.height()};h.use=function(b,a,e){var d,f,h,j,k;e==null&&(e=void 0);f=function(){var e,d;e=Jencil.editor[a].extras;if((e!=null?e.options:void 0)!=null)b.options.extras=i.extend(!0,e.options,(d=b.options.extras)!=
null?d:{});(e!=null?e.stylesheets:void 0)!=null&&Jencil.theme.includeall(e.stylesheets);return(e!=null?e.requires:void 0)!=null?Jencil.utils.script.loadall(e.requires,function(){return h()}):h()};h=function(){var d;d=Jencil.editor[a];if(b.workspace.editor!=null)b.workspace.editor.$element.remove(),b.workspace.editor=null;d=new d(b);b.workspace.append(d);b.workspace.editor=d;d.init();if(e!=null)return e()};return a instanceof Array?(k=a,a=k[0],j=k[1],d=k[2],Jencil.utils.script.load(j,d,function(){return f()})):
f()};h.EditorBase=f=function(){function c(a,b){c.__super__.constructor.call(this,a,b);this.workspace=this.jencil.workspace;this.$element.addClass("jencil-editor");this.$element.hide()}j(c,d);c.prototype.init=function(){this.$element.show();return this.relocate()};c.prototype.update=function(){return this.relocate()};c.prototype.relocate=function(){var a,c,d,f;c=b(this.$element);d=e(this.$element);f=this.workspace.$element.width();a=this.workspace.$element.height();this.$element.width(f-c);return this.$element.height(a-
d)};c.prototype.focus=function(){throw Error("subclass must override this method to focus editor main panel");};return c}();h.SinglePaneEditorBase=function(){function c(a,b,e){this.pane=e;c.__super__.constructor.call(this,a,b);this.pane.$element.appendTo(this.$element);this.pane.$element.addClass("jencil-pane");this.$element.addClass("jencil-siglepane-editor")}j(c,f);c.prototype.init=function(){this.pane.init();return c.__super__.init.call(this)};c.prototype.update=function(){this.pane.update();return c.__super__.update.call(this)};
c.prototype.relocate=function(){var a,d,f,h;c.__super__.relocate.call(this);d=b(this.pane.$element);f=e(this.pane.$element);h=this.$element.width();a=this.$element.height();this.pane.$element.width(h-d);return this.pane.$element.height(a-f)};c.prototype.focus=function(){return this.pane.focus()};return c}();return h.DualPaneEditorBase=function(){function c(a,b,e,d,f){this.lhspane=e;this.rhspane=d;this.panedir=f!=null?f:"horizontal";c.__super__.constructor.call(this,a,b);this.lhspane.$element.appendTo(this.$element);
this.rhspane.$element.appendTo(this.$element);this.lhspane.$element.addClass("jencil-lhspane");this.rhspane.$element.addClass("jencil-rhspane");this.$element.addClass("jencil-panedir-"+this.panedir)}j(c,f);c.prototype.init=function(){this.lhspane.init();this.rhspane.init();return c.__super__.init.call(this)};c.prototype.update=function(){this.lhspane.update();this.rhspane.update();return c.__super__.update.call(this)};c.prototype.relocate=function(){var a,d,f,h,i,j;c.__super__.relocate.call(this);
this.lhspane.isVisible()&&this.rhspane.isVisible()?(this.$element.removeClass("jencil-singlepane-editor"),this.$element.addClass("jencil-dualpane-editor")):(this.$element.addClass("jencil-singlepane-editor"),this.$element.removeClass("jencil-dualpane-editor"));d=b(this.lhspane.$element);h=b(this.rhspane.$element);f=e(this.lhspane.$element);i=e(this.rhspane.$element);j=this.$element.width();a=this.$element.height();this.lhspane.isVisible()&&this.rhspane.isVisible()?this.panedir==="horizontal"?(this.lhspane.$element.css({"float":"left"}),
this.rhspane.$element.css({"float":"right"}),this.lhspane.$element.width(j/2-d),this.rhspane.$element.width(j/2-h),this.lhspane.$element.height(a-f),this.rhspane.$element.height(a-i)):(this.lhspane.$element.css({"float":"none"}),this.rhspane.$element.css({"float":"none"}),this.lhspane.$element.width(j-d),this.rhspane.$element.width(j-h),this.lhspane.$element.height(a/2-f),this.rhspane.$element.height(a/2-i)):this.lhspane.isVisible()?(this.lhspane.$element.css({"float":"none"}),this.lhspane.$element.width(j-
d),this.lhspane.$element.height(a-f)):(this.rhspane.$element.css({"float":"none"}),this.rhspane.$element.width(j-h),this.rhspane.$element.height(a-i));this.lhspane.relocate();return this.rhspane.relocate()};return c}()});namespace("Jencil.editor.pane",function(h){var f,d;d=Jencil.widget.Widget;h.EditorPane=f=function(){function b(e,c,a){this.editor=a;b.__super__.constructor.call(this,e,c);this._updateCallbacks=[]}j(b,d);b.prototype.init=function(){return this};b.prototype.update=function(b){var c,
a,d,f;if(b!=null)return this._updateCallbacks.push(b);else{d=this._updateCallbacks;f=[];for(c=0,a=d.length;c<a;c++)b=d[c],f.push(b());return f}};b.prototype.isVisible=function(){return this.$element.is(":visible")};b.prototype.show=function(){this.update();this.editor.$element.removeClass(""+this.cls+"-invisible");return this.$element.show()};b.prototype.hide=function(){this.editor.$element.addClass(""+this.cls+"-invisible");return this.$element.hide()};b.prototype.toggle=function(){return this.isVisible()?
this.hide():this.show()};b.prototype.relocate=function(){};b.prototype.focus=function(){return this.$element.focus()};return b}();return h.PreviewPane=function(){function b(e,c){b.__super__.constructor.call(this,e,"jencil-preview-pane",c);this.$element.css({position:"relative"});this.$surface=i("<div>").addClass("surface");this.$surface.appendTo(this.$element);this.$surface.css({width:"100%",height:"100%",border:"",margin:0,padding:0,overflow:"auto"})}j(b,f);b.prototype._writeContent=function(b){var c,
a;c=k(function(a){return this.$surface.html(a.replace("{{content}}",b))},this);return this._previewTemplate==null?(a=Jencil.utils.path.abspath(this.jencil.options.extras.previewTemplatePath),this.$surface.load(a,k(function(a){this._previewTemplate=a;return c(a)},this))):c(this._previewTemplate)};b.prototype.update=function(){var d,c;d=k(function(a){this._writeContent(a);return d.__super__.constructor.call(this)},this);d.__super__=b.__super__.update.apply(this,arguments);c=k(function(){var a,b;a=this.editor.getValue();
return((b=this.jencil.profile.extras)!=null?b.previewParserPath:void 0)!=null?(a=encodeURIComponent(a),i.ajax({url:Jencil.utils.path.abspath(this.jencil.profile.extras.previewParserPath),type:this.jencil.profile.extras.previewParserMethod||"GET",dataType:this.jencil.profile.extras.previewParserType||"text",data:""+(this.jencil.profile.extras.previewParserVal||"data")+"="+a,success:k(function(a){return d(a)},this)})):d(a)},this);return this.jencil.profile!=null?c():setTimeout(k(function(){return this.jencil.profile!=
null?c():setTimeout(arguments.callee,100)},this),100)};b.prototype.relocate=function(){b.__super__.relocate.call(this);if(Jencil.utils.detector.browser==="Explorer"&&Jencil.utils.detector.version<8)return this.$surface.height(this.$element.height())};return b}()});namespace("Jencil.editor.pane",function(h){var f;f=Jencil.editor.pane.EditorPane;return h.TextareaPane=function(){function d(b,e){d.__super__.constructor.call(this,b,"jencil-textarea-pane",e);this.$element.css({position:"relative"});this.$surface=
i("<textarea>").addClass("surface");this.$surface.appendTo(this.$element);this.$surface.css({width:"100%",height:"100%",border:"none",margin:0,padding:0,resize:"none",outline:"none"});this.$surface.bind("keyup keypress click change blur enter",k(function(){return this.update()},this));this.controller=new Textarea(this.$surface)}j(d,f);d.prototype.init=function(){i.fn.tabby!=null&&this.$element.tabby();return d.__super__.init.call(this)};d.prototype.relocate=function(){d.__super__.relocate.call(this);
if(Jencil.utils.detector.browser==="Explorer"&&Jencil.utils.detector.version<8)return this.$surface.height(this.$element.height())};d.prototype.getValue=function(){return this.controller.getValue()};d.prototype.setValue=function(b){return this.controller.setValue(b)};d.prototype.focus=function(){return this.$surface.focus()};return d}()});namespace("Jencil.editor",function(h){var f,d,b;f=Jencil.editor.DualPaneEditorBase;d=Jencil.editor.pane.PreviewPane;b=Jencil.editor.pane.TextareaPane;return h.TextEditor=
function(){function e(c){var a,g;(a=c.options.extras.previewPosition)==="top"||a==="left"?(a=this.preview=new d(c,this),g=this.textarea=new b(c,this)):(a=this.textarea=new b(c,this),g=this.preview=new d(c,this));e.__super__.constructor.call(this,c,"jencil-text-editor",a,g);this.$element.addClass("jencil-preview-position-"+this.jencil.options.extras.previewPosition);this.setValue(this.jencil.getSourceValue());this.jencil.options.extras.defaultPreviewState==="close"&&this.preview.hide();this.textarea.update(k(function(){this.jencil.setSourceValue(this.getValue());
return this.preview.update()},this))}j(e,f);e.extras={options:{previewPosition:"right",previewTemplatePath:"~/extras/templates/preview.html",defaultPreviewState:"open"}};e.prototype.relocate=function(){e.__super__.relocate.call(this);if(Jencil.utils.detector.browser==="Explorer"&&Jencil.utils.detector.version===8)return document.selection.createRange().select()};e.prototype.getValue=function(){return this.textarea.getValue()};e.prototype.setValue=function(b){return this.textarea.setValue(b)};e.prototype.focus=
function(){return this.textarea.focus()};e.prototype.getSelection=function(){return this.textarea.controller.getSelection()};e.prototype.setSelection=function(b,a){return this.textarea.controller.setSelection(b,a)};e.prototype.getSelected=function(){return this.textarea.controller.getSelected()};e.prototype.replaceSelected=function(b,a){a==null&&(a=!1);return this.textarea.controller.replaceSelected(b,a)};e.prototype.insertBeforeSelected=function(b,a){a==null&&(a=!1);return this.textarea.controller.insertBeforeSelected(b,
a)};e.prototype.insertAfterSelected=function(b,a){a==null&&(a=!1);return this.textarea.controller.insertAfterSelected(b,a)};e.prototype.wrapSelected=function(b,a,d,e){d==null&&(d=!1);e==null&&(e=void 0);return this.textarea.controller.wrapSelected(b,a,d,e)};return e}()});namespace("Jencil.button",function(h){var f,d;f=Jencil.button.ButtonBase;h.MarkupButtonBase=d=function(){function b(){b.__super__.constructor.apply(this,arguments)}j(b,f);b.prototype.clickAfter=function(){return this.editor().update()};
return b}();h.SimpleMarkupButton=function(){function b(d,c){var a,g;a=c[0];g=c[1];this.before=c[2];this.after=c[3];this.insert=c[4];b.__super__.constructor.call(this,d,a,g)}j(b,d);b.prototype.click=function(){return this.editor().wrapSelected(this.before,this.after,!0,this.insert||this.jencil.options.defaultInsertText)};return b}();h.MultilineMarkupButton=function(){function b(d,c){var a,g;a=c[0];g=c[1];this.before=c[2];this.after=c[3];this.blockBefore=c[4];this.blockAfter=c[5];b.__super__.constructor.call(this,
d,a,g)}j(b,d);b.prototype.click=function(){var b,c,a,d,f,h,i;d=this.editor().getSelected().split("\n");a=d[0]===this.blockBefore?1:0;for(b=0,i=d.length;0<=i?b<i:b>i;0<=i?b++:b--)h=Jencil.utils.string.format(this.before,{i:b+1-a}),f=Jencil.utils.string.format(this.after,{i:b+1-a}),c=d[b],c===this.blockBefore||c===this.blockAfter||(d[b]=c.startsWith(h)&&c.endsWith(f)?c.substring(h.length,c.length-f.length):""+h+c+f);this.blockBefore!==void 0&&(d[0]===this.blockBefore?d.shift():d.unshift(this.blockBefore));
this.blockAfter!==void 0&&(d[d.length-1]===this.blockAfter?d.pop():d.push(this.blockAfter));b=d.join("\n");return this.editor().replaceSelected(b,!0)};return b}();h.LinkMarkupButton=function(){function b(d,c){this.formatstr=c[0];b.__super__.constructor.call(this,d,"link","Link")}j(b,d);b.prototype.click=function(){var b,c,a;b=prompt("Please input link url");if(b!==null&&(c=prompt("Please input link label",this.editor().getSelected()),c!==null&&(a=prompt("(Optional) Please input link title"),a!==null)))return b=
Jencil.utils.string.format(this.formatstr,{href:b,label:c,title:a}),this.editor().replaceSelected(b)};return b}();return h.ImageMarkupButton=function(){function b(d,c){this.formatstr=c[0];b.__super__.constructor.call(this,d,"image","Image")}j(b,d);b.prototype.click=function(){var b,c,a;c=prompt("Please input image src url");if(c!==null&&(b=prompt("(Optional) Please input image alt label",this.editor().getSelected()),b!==null&&(a=prompt("(Optional) Please input image title"),a!==null)))return b=Jencil.utils.string.format(this.formatstr,
{src:c,alt:b,title:a}),this.editor().replaceSelected(b)};return b}()});namespace("Jencil.editor.pane",function(h){var f;f=Jencil.editor.pane.EditorPane;return h.RichareaPane=function(){function d(b,e){var c;d.__super__.constructor.call(this,b,"jencil-richarea-pane",e);this.$element.css({position:"relative"});this.$surface=i("<iframe>").addClass("surface");this.$surface.appendTo(this.$element);this.$surface.css({width:"100%",height:"100%",border:"none",margin:0,padding:0});if(this.jencil.options.extras.richareaTemplatePath!=
null)c=this.jencil.options.extras.richareaTemplatePath,this.$surface.attr("src",Jencil.utils.path.abspath(c));Jencil.utils.detector.browser==="Explorer"&&this.$surface.attr("frameborder",0);this.controller=null}j(d,f);d.prototype.init=function(){this.controller=new Richarea(this.$surface);return this.controller.ready(k(function(){this.relocate();this.$body=i(this.controller.raw.body);this.$body.css({margin:0,padding:0});this.$body.bind("keyup keypress change click blur enter",k(function(){this.update();
if(Jencil.utils.detector.browser==="Firefox")return setTimeout(k(function(){return this.update()},this),100)},this));return d.__super__.init.call(this)},this))};d.prototype.relocate=function(){d.__super__.relocate.call(this);Jencil.utils.detector.browser==="Explorer"&&Jencil.utils.detector.version<8&&this.$surface.height(this.$element.height());if(Jencil.utils.detector.browser==="Explorer"&&Jencil.utils.detector.version<9)return this.$body.height(this.$surface.height())};d.prototype.getValue=function(){var b;
if((b=this.controller)!=null&&b.ready())return this.controller.getValue()};d.prototype.setValue=function(b){var d;if((d=this.controller)!=null&&d.ready())return this.controller.setValue(b)};d.prototype.focus=function(){return this.$surface.focus()};return d}()});namespace("Jencil.editor",function(h){var f,d,b;f=Jencil.editor.DualPaneEditorBase;b=Jencil.editor.pane.TextareaPane;d=Jencil.editor.pane.RichareaPane;return h.RichEditor=function(){function e(c){var a,f;(a=c.options.extras.previewPosition)===
"top"||a==="left"?(a=this.preview=new b(c,this),f=this.richarea=new d(c,this)):(a=this.richarea=new d(c,this),f=this.preview=new b(c,this));e.__super__.constructor.call(this,c,"jencil-rich-editor",a,f);this.$element.addClass("jencil-preview-position-"+this.jencil.options.extras.previewPosition);this.jencil.options.extras.defaultPreviewState==="close"&&this.preview.hide()}j(e,f);e.extras={options:{richareaTemplatePath:"~/extras/templates/richarea.html"}};e.prototype.init=function(){e.__super__.init.call(this);
return this.richarea.controller.ready(k(function(){this.setValue(this.jencil.getSourceValue());this.preview.setValue(this.getValue());this.richarea.update(k(function(){this.jencil.setSourceValue(this.getValue());return this.preview.setValue(this.getValue())},this));this.preview.update(k(function(){this.jencil.setSourceValue(this.preview.getValue());return this.richarea.setValue(this.preview.getValue())},this));return this.update()},this))};e.prototype.getValue=function(){return this.richarea.getValue()};
e.prototype.setValue=function(b){return this.richarea.setValue(b)};e.prototype.focus=function(){return this.richarea.focus()};return e}()});namespace("Jencil.button",function(h){var f,d;d=Jencil.button.MarkupButtonBase;h.CommandButton=f=function(){function b(d,c){var a,f;f=c[0];a=c[1];this.command=c[2];this.args=c[3];b.__super__.constructor.call(this,d,f,a)}j(b,d);b.prototype.click=function(){return this.exec(this.command,this.args)};b.prototype.clickAfter=function(){return this.editor().focus()};
b.prototype.exec=function(b,c){if(this.editor().richarea.controller!=null)return this.editor().richarea.controller.execCommand(b,c)};return b}();return h.PromptCommandButton=function(){function b(d,c){var a,f,h;h=c[0];a=c[1];f=c[2];this.message=c[3];this.defaultValue=c[4];b.__super__.constructor.call(this,d,[h,a,f,void 0])}j(b,f);b.prototype.click=function(){var b;b=prompt(this.message,this.defaultValue||"");return b===null?void 0:this.exec(this.command,b)};return b}()})}).call(this);
