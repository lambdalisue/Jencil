/*
Richarea

Cross browser richarea (iframe) munipulator script written in CoffeeScript

:Author: Alisue (lambdalisue@hashnote.net)
:License: MIT License
:Url: http://github.com/lambdalisue/Richarea
:Version: 0.1.1rc2
:Reference:
  - http://help.dottoro.com/ljcvtcaw.php
  - http://wiki.bit-hive.com/tomizoo/pg/JavaScript%20Range%A4%CE%BB%C8%A4%A4%CA%FD
  - http://www.mozilla-japan.org/editor/midas-spec.html
  - https://bugzilla.mozilla.org/show_bug.cgi?id=297494
*/
eval(function(p,a,c,k,e,d){e=function(c){return(c<a?'':e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p}('(5(){o Z,G,J,x;o 14=5(3s,3r){4 5(){4 3s.4K(3r,4J)}},2Y=4I.7.2q||5(3q){15(o i=0,l=3.N;i<l;i++){6(3[i]===3q)4 i}4-1};Z=(5(){5 Z(){3.x=3.2t(3.3o)||"2v 2u x";3.3b=3.2r(y.10)||3.2r(y.4H)||"2v 2u x";3.3p=3.2t(3.3i)||"2v 2u 3p"}Z.7.2t=5(2s){o T,s,M,B;B=[];15(s=0,M=2s.N;s<M;s++){T=2s[s];3.2o=T.1e||T.v;6(T.z!=a){6(T.z.2q(T.A)!==-1){4 T.v}e 6(T.3n){4 T.v}}}4 B};Z.7.2r=5(2p){o 1Q;1Q=2p.2q(3.2o);6(1Q===-1){4}4 4G(2p.1M(1Q+3.2o.N+1))};Z.7.3o=[{z:y.10,A:\'1I\',v:\'1I\'},{z:y.10,A:\'2n\',1e:\'2n/\',v:\'2n\'},{z:y.1P,A:\'4F\',v:\'4E\',1e:\'3m\'},{3n:I.4D,v:\'4C\',1e:\'3m\'},{z:y.1P,A:\'3l\',v:\'3l\'},{z:y.1P,A:\'4B\',v:\'4A\'},{z:y.10,A:\'1w\',v:\'1w\'},{z:y.1P,A:\'3k\',v:\'3k\'},{z:y.10,A:\'2m\',v:\'2m\'},{z:y.10,A:\'3j\',v:\'3c\',1e:\'3j\'},{z:y.10,A:\'4z\',v:\'2l\',1e:\'4y\'},{z:y.10,A:\'2l\',v:\'2m\',1e:\'2l\'}];Z.7.3i=[{z:y.2k,A:\'4x\',v:\'4w\'},{z:y.2k,A:\'3h\',v:\'3h\'},{z:y.10,A:\'3g\',v:\'3g/4v\'},{z:y.2k,A:\'3f\',v:\'3f\'}];4 Z})();x=26 Z;J=(5(){5 J(p){3.p=p;3.1v=V;3.1j=[];6(k.4u!=a){3.p.3e=14(5(){o q,s,M,g;6(3.p.4t===\'4s\'){3.1v=S;g=3.1j;15(s=0,M=g.N;s<M;s++){q=g[s];q()}3.1j=u 0;4 3.p.3e=a}},3)}e{3.p.4r=14(5(){o q,s,M,g;3.1v=S;g=3.1j;15(s=0,M=g.N;s<M;s++){q=g[s];q()}4 3.1j=u 0},3)}3.1r(14(5(){6(3.p.3d!=a){3.k=3.p.3d}e{3.k=3.p.35.k}6(!(3.k.D!=a)){3.k.4q(\'<D></D>\')}3.D=3.k.D;6(x.x===\'3c\'&&x.3b<9){3.D.w.2j=""+3.p.3a+"39";3.p.4p(\'4o\',14(5(){4 3.D.w.2j=""+3.p.3a+"39"},3))}e{3.D.w.4n=\'Y\';3.D.w.2j=\'4m%\'}6(3.D.38!=a){3.D.38=V}6(3.D.37!=a){3.D.37=S}e 6(3.k.36!=a){3.k.36=\'4l\'}4 3.I=3.p.35},3))}J.7.1r=5(q){6(3.1v){4 q()}e{4 3.1j.1D(q)}};J.7.1q=5(){4 3.1v};J.7.1n=5(c){4 3.k.1n(c)};J.7.1p=5(c){4 3.k.1p(c)};J.7.1H=5(c){4 3.k.1H(c)};J.7.1G=5(c){4 3.k.1G(c)};J.7.1F=5(c){4 3.k.1F(c)};J.7.b=5(c,C,j){6(C==a){C=V}6(j==a){j=a}4 3.k.b(c,C,j)};4 J})();G=(5(){5 G(){}G.7.1u=5(f){4!(f.2d!=a)};G.7.1Z=5(L){o 12;12=k.1Y(\'2U\');12.19=L;4 12.2d};G.7.2V=5(1d,1c){o 2g,2f,2e,2i,g,2h;2i=5(1d,1c){o F,1O,j;15(F 1C 1d){j=1d[F];6(j 33 4k){1O=2i(j,1c[F])}e{1O=j===1c[F]}6(!1O){4 V}}4 S};2g=((g=1d.23)!=a?g.22():u 0)===((2h=1c.23)!=a?2h.22():u 0);2f=1d.34===1c.34;2e=1d.21(\'w\')===1c.21(\'w\');4 2g&&2f&&2e};G.7.Q=5(f,1N){o 1i;6(1N==a){1N=V}1i=1N?\'4j\':\'2d\';1o(!3.1u(f)){f=f[1i]}4 f};G.7.28=5(f,Q){6(Q==a){Q=V}1o(!f.m){f=f.d;6(!f){4 a}}f=f.m;6(Q){f=3.Q(f,V)}4 f};G.7.29=5(f,Q){6(Q==a){Q=V}1o(!f.1B){f=f.d;6(!f){4 a}}f=f.1B;6(Q){f=3.Q(f,S)}4 f};G.7.1t=5(n,q,P,O){o 1L,1K,m,d,1J,Y,17;6(P==a){P=u 0}6(O==a){O=u 0}Y=n.4i;6(P==a){P=0}6(O==a){O=Y.N}6(P===0&&O===Y.N){4 q(n)}e{1L=Y.1M(0,P);1K=Y.1M(P,O);1J=Y.1M(O,Y.N);d=n.d;m=n.m;d.1l(n);6(1L.N>0){17=k.2c(1L);d.1a(17,m)}6(1K.N>0){17=k.2c(1K);d.1a(17,m);n=17}6(1J.N>0){17=k.2c(1J);d.1a(17,m)}4 q(n)}};G.7.2b=5(f,q,P,O){o 1i,s,M,g,B;6(P==a){P=u 0}6(O==a){O=u 0}6(3.1u(f)){4 3.1t(f,q,P,O)}e{g=f.2a;B=[];15(s=0,M=g.N;s<M;s++){1i=g[s];B.1D(3.2b(1i,q))}4 B}};G.7.20=5(H,q){o W,1s,1b,27,R,X,16,1h,g,B;6(H.4h){6(((g=I.11)!=a?g.1E:u 0)!=a){4 11.1E("4g 4f 4e")}}e{R=H.4d(0);X=R.X;1h=R.1h;W=R.W;1b=R.1b;H.4c();6(X===W){4 3.2b(X,q,1h,1b)}e{6(!3.1u(X)){16=X.2a[1h]}e{16=3.28(X,S);3.1t(X,q,1h,u 0)}6(!3.1u(W)){6(1b>0){1s=W.2a[1b-1]}e{1s=3.29(W,S)}}e{1s=3.29(W,S);3.1t(W,q,u 0,1b)}B=[];1o(16){27=3.28(16,S);3.1t(16,q);6(16===1s){4b}B.1D(16=27)}4 B}}};4 G})();3.8=(5(){5 8(p){3.p=p;6((I.32!=a)&&3.p 33 32){3.p=3.p.4a(0)}3.r=26 J(3.p);3.1f=26 G;3.r.1r(14(5(){o L;6(3.p.19!=a){L=3.p.19;L=L.31(\'&49;\').30(\'<\');L=L.31(\'&48;\').30(\'>\');4 3.2Z(L)}},3))}8.7.1q=5(){4 3.r.1q()};8.7.1r=5(q){4 3.r.1r(q)};8.7.47=5(){6(3.1q()){4 3.r.D.19}};8.7.2Z=5(j){6(3.1q()){4 3.r.D.19=j}};8.7.1n=5(c){o 25;2X(x.x){24\'1I\':4 a;24\'1w\':25=[\'1z\',\'46\',\'2I\',\'1y\',\'2B\',\'2A\',\'2z\',\'2y\',\'1x\',\'1U\',\'1T\',\'1V\',\'45\'];6(2Y.2w(25,c)<0){4 a}}4 3.r.1n(c)};8.7.1p=5(c){2X(x.x){24\'1I\':4 S}4 3.r.1p(c)};8.7.1H=5(c){4 3.r.1H(c)};8.7.1G=5(c){4 3.r.1G(c)};8.7.1F=5(c){4 3.r.1F(c)};8.7.b=5(c,C,j){o g;6(C==a){C=u 0}6(j==a){j=u 0}6(!3.1p(c)){6(((g=I.11)!=a?g.1E:u 0)!=a){11.1E(""+c+" 44 43 42 1C 3 x")}4}6((C!=a)&&!(j!=a)){j=C;C=V}4 3.r.b(c,C,j)};8.7.41=5(c,C,j){o B;6(C==a){C=u 0}6(j==a){j=u 0}3.b(c,C,j);B=[];1o(3.1n(c)){B.1D({})}4 B};8.7.w=5(1m){o H,1g,g;6(3.r.I.1k!=a){1g=14(5(n){o 13,F,m,d,j,E,g;d=n.d;6(!n.1B&&!n.m){6(((g=d.23)!=a?g.22():u 0)===\'2W\'){15(F 1C 1m){j=1m[F];6(d.w[F]===j){d.w[F]=\'\'}e{d.w[F]=j}}6(d.21(\'w\')===\'\'){m=d.m;13=d.d;13.1l(d);13.1a(n,m)}4}}E=k.1Y(\'2W\');15(F 1C 1m){j=1m[F];E.w[F]=j}m=n.m;d.1l(n);E.1X(n);4 d.1a(E,m)},3);H=3.r.I.1k();4 3.1f.20(H,1g)}e{6(((g=I.11)!=a?g.1A:u 0)!=a){4 11.1A("8.w 2T 2S\'t 2R 3 x.")}}};8.7.U=5(L){o 12,R,H,1g,E,g;6(3.r.I.1k!=a){1g=14(5(n){o 13,m,d,E;E=3.1f.1Z(L);d=n.d;6(!n.1B&&!n.m){6(3.1f.2V(d,E)){m=d.m;13=d.d;13.1l(d);13.1a(n,m);4}}m=n.m;d.1l(n);E.1X(n);4 d.1a(E,m)},3);H=3.r.I.1k();4 3.1f.20(H,1g)}e 6(3.r.k.H!=a){3.r.I.40();R=3.r.k.H.3Z();E=3.1f.1Z(L);E.19=R.3Y;12=k.1Y(\'2U\');12.1X(E);4 R.3X(12.19)}e{6(((g=I.11)!=a?g.1A:u 0)!=a){4 11.1A("8.U 2T 2S\'t 2R 3 x.")}}};8.7.K=5(){6(3.r.I.1k!=a){4 2}e 6(3.r.k.H!=a){4 1}4 0};8.7.3W=5(1W){6(3.K()===2){4 3.U("<h"+1W+">")}e{4 3.b(\'3V\',"<h"+1W+">")}};8.7.1z=5(){6(3.K()>0){4 3.U(\'<2Q>\')}e{4 3.b(\'1z\')}};8.7.2Q=8.1z;8.7.1y=5(){6(3.K()>0){4 3.U(\'<2P>\')}e{4 3.b(\'1y\')}};8.7.2P=8.1y;8.7.1V=5(){6(3.K()>0){4 3.U(\'<3U>\')}e{4 3.b(\'1V\')}};8.7.1x=5(){6(3.K()>0){4 3.U(\'<2O>\')}e{4 3.b(\'1x\')}};8.7.2O=8.1x;8.7.1U=5(){6(3.K()>0){4 3.U(\'<3T>\')}e{4 3.b(\'1U\')}};8.7.1T=5(){6(3.K()>0){4 3.U(\'<3S>\')}e{4 3.b(\'1T\')}};8.7.3R=5(18){6(3.K()===2){4 3.w({18:18})}e{4 3.b(\'3Q\',18)}};8.7.3P=5(18){o c;6(3.K()===2){3.w({3O:18})}e{6(x.x===\'1w\'){c=\'3N\'}e{c=\'3M\'}}4 3.b(c,18)};8.7.3L=5(1S){6(3.K()===2){4 3.w({3K:1S})}e{4 3.b(\'3J\',1S)}};8.7.2N=5(1R){6(3.K()===2){4 3.w({2N:1R})}e{4 3.b(\'3I\',1R)}};8.7.2M=5(){4 3.b(\'2M\')};8.7.2L=5(){4 3.b(\'2L\')};8.7.3H=5(2K){4 3.b(\'3G\',2K)};8.7.3F=5(2J){4 3.b(\'3E\',2J)};8.7.3D=5(){4 3.b(\'3C\')};8.7.3B=5(){4 3.b(\'2I\')};8.7.3A=5(){4 3.b(\'3z\')};8.7.2H=5(){4 3.b(\'2H\')};8.7.2G=5(){4 3.b(\'2G\')};8.7.2F=5(){4 3.b(\'2F\')};8.7["2E"]=5(){4 3.b(\'2E\')};8.7.2D=5(){4 3.b(\'2D\')};8.7.2C=5(){4 3.b(\'2C\')};8.7.3y=5(){4 3.b(\'2B\')};8.7.3x=5(){4 3.b(\'2A\')};8.7.3w=5(){4 3.b(\'2z\')};8.7.3v=5(){4 3.b(\'2y\')};8.7.3u=5(){4 3.b(\'3t\')};8.7.2x=5(){4 3.b(\'2x\')};4 8})()}).2w(3);',62,295,'|||this|return|function|if|prototype|Richarea||null|execCommand|command|parentNode|else|node|_ref|||value|document||nextSibling|leaf|var|iframe|callback|raw|_i||void|identify|style|browser|navigator|string|subString|_results|ui|body|wrap|key|DOMMunipulator|selection|window|RawController|isSurroundSupport|html|_len|length|end|start|dig|range|true|row|surround|false|endContainer|startContainer|text|Browser|userAgent|console|container|grandParentNode|__bind|for|startLeaf|textNode|color|innerHTML|insertBefore|endOffset|rhs|lhs|versionSearch|munipulator|surroundCallback|startOffset|child|_callbacks|getSelection|removeChild|sets|queryCommandState|while|queryCommandEnabled|isReady|ready|endLeaf|execAtLeaf|isLeaf|_hasLoaded|Firefox|strikethrough|italic|bold|error|previousSibling|in|push|warn|queryCommandValue|queryCommandSupported|queryCommandIndeterm|Chrome|right|middle|left|substring|reverse|result|vendor|index|size|name|superscript|subscript|underline|level|appendChild|createElement|createElementFromHTML|execAtSelection|getAttribute|toLowerCase|tagName|case|WORKS|new|nextLeaf|next|previous|childNodes|execAtNode|createTextNode|firstChild|c3|c2|c1|_ref2|deepEqual|height|platform|Mozilla|Netscape|OmniWeb|versionSearchString|dataString|indexOf|searchVersion|data|searchString|unknown|An|call|unselect|justifyright|justifyleft|justifyfull|justifycenter|redo|undo|delete|paste|cut|copy|insertunorderedlist|src|href|outdent|indent|fontSize|del|em|strong|support|doesn|method|div|compare|span|switch|__indexOf|setValue|join|split|jQuery|instanceof|className|contentWindow|designMode|contentEditable|spellcheck|px|offsetHeight|version|Explorer|contentDocument|onreadystatechange|Linux|iPhone|Mac|dataOS|MSIE|Camino|iCab|Version|prop|dataBrowser|OS|item|me|fn|selectall|selectAll|justifyRight|justifyLeft|justifyFull|justifyCenter|inserthorizontalrule|insertHorizontalRule|insertUnorderedList|insertorderedlist|insertOrderedList|insertimage|insertImage|createlink|insertLink|fontsize|fontname|fontFamily|fontName|backcolor|hilitecolor|backgroundColor|backColor|forecolor|foreColor|sup|sub|ins|formatblock|heading|pasteHTML|htmlText|createRange|focus|execCommandAndWait|enabled|not|is|unlink|insertorderlist|getValue|gt|lt|get|break|removeAllRanges|getRangeAt|selected|has|Nothing|isCollapsed|textContent|lastChild|Object|On|100|cursor|onresize|attachEvent|writeln|onload|complete|readyState|all|iPad|Windows|Win|rv|Gecko|Konqueror|KDE|Opera|opera|Safari|Apple|parseFloat|appVersion|Array|arguments|apply'.split('|')))
