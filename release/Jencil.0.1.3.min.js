/**
 * Jencil 0.1.3
 *
 * Author:  lambdalisue
 * URL:     http://hashnote.net/
 * License: MIT License
 * 
 * Copyright (C) 2012 lambdalisue, hashnote.net allright reserved.
 *
 * This application include following Library inside
 * 
 * Tabby jQuery plugin version 0.12
 * Ted Devito - http://teddevito.com/demos/textarea.html
 * Copyright (c) 2009 Ted Devito
 *
 * shortcut.js
 * http://www.openjs.com/scripts/events/keyboard_shortcuts/
 * Version : 2.01.B
 * By Binny V A
 * License : BSD
 */
shortcut={all_shortcuts:{},add:function(b,h,d){var g={type:"keydown",propagate:false,disable_in_input:false,target:document,keycode:false};if(!d){d=g}else{for(var a in g){if(typeof d[a]=="undefined"){d[a]=g[a]}}}var f=d.target;if(typeof d.target=="string"){f=document.getElementById(d.target)}var c=this;b=b.toLowerCase();var e=function(o){o=o||window.event;if(d.disable_in_input){var l;if(o.target){l=o.target}else{if(o.srcElement){l=o.srcElement}}if(l.nodeType==3){l=l.parentNode}if(l.tagName=="INPUT"||l.tagName=="TEXTAREA"){return}}if(o.keyCode){code=o.keyCode}else{if(o.which){code=o.which}}var n=String.fromCharCode(code).toLowerCase();if(code==188){n=","}if(code==190){n="."}var s=b.split("+");var r=0;var p={"`":"~","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"_","=":"+",";":":","'":'"',",":"<",".":">","/":"?","\\":"|"};var m={esc:27,escape:27,tab:9,space:32,"return":13,enter:13,backspace:8,scrolllock:145,scroll_lock:145,scroll:145,capslock:20,caps_lock:20,caps:20,numlock:144,num_lock:144,num:144,pause:19,"break":19,insert:45,home:36,"delete":46,end:35,pageup:33,page_up:33,pu:33,pagedown:34,page_down:34,pd:34,left:37,up:38,right:39,down:40,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123};var q={shift:{wanted:false,pressed:false},ctrl:{wanted:false,pressed:false},alt:{wanted:false,pressed:false},meta:{wanted:false,pressed:false}};if(o.ctrlKey){q.ctrl.pressed=true}if(o.shiftKey){q.shift.pressed=true}if(o.altKey){q.alt.pressed=true}if(o.metaKey){q.meta.pressed=true}for(var j=0;k=s[j],j<s.length;j++){if(k=="ctrl"||k=="control"){r++;q.ctrl.wanted=true}else{if(k=="shift"){r++;q.shift.wanted=true}else{if(k=="alt"){r++;q.alt.wanted=true}else{if(k=="meta"){r++;q.meta.wanted=true}else{if(k.length>1){if(m[k]==code){r++}}else{if(d.keycode){if(d.keycode==code){r++}}else{if(n==k){r++}else{if(p[n]&&o.shiftKey){n=p[n];if(n==k){r++}}}}}}}}}}if(r==s.length&&q.ctrl.pressed==q.ctrl.wanted&&q.shift.pressed==q.shift.wanted&&q.alt.pressed==q.alt.wanted&&q.meta.pressed==q.meta.wanted){h(o);if(!d.propagate){o.cancelBubble=true;o.returnValue=false;if(o.stopPropagation){o.stopPropagation();o.preventDefault()}return false}}};this.all_shortcuts[b]={callback:e,target:f,event:d.type};if(f.addEventListener){f.addEventListener(d.type,e,false)}else{if(f.attachEvent){f.attachEvent("on"+d.type,e)}else{f["on"+d.type]=e}}},remove:function(a){a=a.toLowerCase();var d=this.all_shortcuts[a];delete (this.all_shortcuts[a]);if(!d){return}var b=d.event;var c=d.target;var e=d.callback;if(c.detachEvent){c.detachEvent("on"+b,e)}else{if(c.removeEventListener){c.removeEventListener(b,e,false)}else{c["on"+b]=false}}}};(function(d){d.fn.tabby=function(f){var g=d.extend({},d.fn.tabby.defaults,f);var h=d.fn.tabby.pressed;return this.each(function(){$this=d(this);var i=d.meta?d.extend({},g,$this.data()):g;$this.bind("keydown",function(l){var j=d.fn.tabby.catch_kc(l);if(16==j){h.shft=true}if(17==j){h.ctrl=true;setTimeout("$.fn.tabby.pressed.ctrl = false;",1000)}if(18==j){h.alt=true;setTimeout("$.fn.tabby.pressed.alt = false;",1000)}if(9==j&&!h.ctrl&&!h.alt){l.preventDefault;h.last=j;setTimeout("$.fn.tabby.pressed.last = null;",0);e(d(l.target).get(0),h.shft,i);return false}}).bind("keyup",function(j){if(16==d.fn.tabby.catch_kc(j)){h.shft=false}}).bind("blur",function(j){if(9==h.last){d(j.target).one("focus",function(l){h.last=null}).get(0).focus()}})})};d.fn.tabby.catch_kc=function(f){return f.keyCode?f.keyCode:f.charCode?f.charCode:f.which};d.fn.tabby.pressed={shft:false,ctrl:false,alt:false,last:null};function b(f){if(window.console&&window.console.log){window.console.log("textarea count: "+f.size())}}function e(i,h,g){var f=i.scrollTop;if(i.setSelectionRange){a(i,h,g)}else{if(document.selection){c(i,h,g)}}i.scrollTop=f}d.fn.tabby.defaults={tabString:String.fromCharCode(9)};function a(j,f,v){var u=j.selectionStart;var s=j.selectionEnd;if(u==s){if(f){if(v.tabString==j.value.substring(u-v.tabString.length,u)){j.value=j.value.substring(0,u-v.tabString.length)+j.value.substring(u);j.focus();j.setSelectionRange(u-v.tabString.length,u-v.tabString.length)}else{if(v.tabString==j.value.substring(u,u+v.tabString.length)){j.value=j.value.substring(0,u)+j.value.substring(u+v.tabString.length);j.focus();j.setSelectionRange(u,u)}}}else{j.value=j.value.substring(0,u)+v.tabString+j.value.substring(u);j.focus();j.setSelectionRange(u+v.tabString.length,u+v.tabString.length)}}else{var w=j.value.split("\n");var t=new Array();var m=0;var h=0;var g=false;for(var p in w){h=m+w[p].length;t.push({start:m,end:h,selected:(m<=u&&h>u)||(h>=s&&m<s)||(m>u&&h<s)});m=h+1}var l=0;for(var p in t){if(t[p].selected){var r=t[p].start+l;if(f&&v.tabString==j.value.substring(r,r+v.tabString.length)){j.value=j.value.substring(0,r)+j.value.substring(r+v.tabString.length);l-=v.tabString.length}else{if(!f){j.value=j.value.substring(0,r)+v.tabString+j.value.substring(r);l+=v.tabString.length}}}}j.focus();var q=u+((l>0)?v.tabString.length:(l<0)?-v.tabString.length:0);var n=s+l;j.setSelectionRange(q,n)}}function c(r,x,f){var q=document.selection.createRange();if(r==q.parentElement()){if(""==q.text){if(x){var m=q.getBookmark();q.moveStart("character",-f.tabString.length);if(f.tabString==q.text){q.text=""}else{q.moveToBookmark(m);q.moveEnd("character",f.tabString.length);if(f.tabString==q.text){q.text=""}}q.collapse(true);q.select()}else{q.text=f.tabString;q.collapse(false);q.select()}}else{var l=q.text;var p=l.length;var v=l.split("\r\n");var A=document.body.createTextRange();A.moveToElementText(r);A.setEndPoint("EndToStart",q);var n=A.text;var y=n.split("\r\n");var s=n.length;var z=document.body.createTextRange();z.moveToElementText(r);z.setEndPoint("StartToEnd",q);var w=z.text;var g=document.body.createTextRange();g.moveToElementText(r);g.setEndPoint("StartToEnd",A);var t=g.text;var h=d(r).html();d("#r3").text(s+" + "+p+" + "+w.length+" = "+h.length);if((s+t.length)<h.length){y.push("");s+=2;if(x&&f.tabString==v[0].substring(0,f.tabString.length)){v[0]=v[0].substring(f.tabString.length)}else{if(!x){v[0]=f.tabString+v[0]}}}else{if(x&&f.tabString==y[y.length-1].substring(0,f.tabString.length)){y[y.length-1]=y[y.length-1].substring(f.tabString.length)}else{if(!x){y[y.length-1]=f.tabString+y[y.length-1]}}}for(var u=1;u<v.length;u++){if(x&&f.tabString==v[u].substring(0,f.tabString.length)){v[u]=v[u].substring(f.tabString.length)}else{if(!x){v[u]=f.tabString+v[u]}}}if(1==y.length&&0==s){if(x&&f.tabString==v[0].substring(0,f.tabString.length)){v[0]=v[0].substring(f.tabString.length)}else{if(!x){v[0]=f.tabString+v[0]}}}if((s+p+w.length)<h.length){v.push("");p+=2}A.text=y.join("\r\n");q.text=v.join("\r\n");var j=document.body.createTextRange();j.moveToElementText(r);if(0<s){j.setEndPoint("StartToEnd",A)}else{j.setEndPoint("StartToStart",A)}j.setEndPoint("EndToEnd",q);j.select()}}}})(jQuery);(function(){var Y,P,F,R,c,A,U,g,f,o,N,v,r,i,V,D,M,Z,C,x,b,s,z,G,j,a,O,y,T,H,E,aa,K,t,ab,B,m,J,X,l,n,w,W,e,d,S,p,L,u,Q,h,I=[].slice,ac={}.hasOwnProperty,q=function(ag,ae){for(var ad in ae){if(ac.call(ae,ad)){ag[ad]=ae[ad]}}function af(){this.constructor=ag}af.prototype=ae.prototype;ag.prototype=new af();ag.__super__=ae.prototype;return ag};Q=function(ai,ad,af){var al,aj,ag,ak,ah,ae;if(arguments.length<3){ah=[(typeof exports!=="undefined"?exports:window)].concat(I.call(arguments)),ai=ah[0],ad=ah[1],af=ah[2]}aj=ai;ae=ad.split(".");for(ag=0,ak=ae.length;ag<ak;ag++){al=ae[ag];ai=ai[al]||(ai[al]={})}return af(ai,aj)};if(typeof window!=="undefined"&&window!==null){window.namespace=Q}if(typeof exports!=="undefined"&&exports!==null){exports.namespace=Q}z=(function(){function ad(){}ad.prototype.name="Not implemeted error";ad.prototype.message="The function has not implemented yet";return ad})();G=(function(){function ad(){}ad.prototype.createMemento=function(){throw new z};ad.prototype.setMemento=function(ae){throw new z};return ad})();g=(function(){function ad(ae){this._originator=ae;this._undoStack=[];this._redoStack=[]}ad.prototype.originator=function(ae){if(ae!=null){this._originator=ae;return this}return this._originator};ad.prototype.save=function(ae){ae=ae||this.originator().createMemento();this._undoStack.push(ae);this._redoStack=[];return this};ad.prototype.undo=function(){var ae;if(!this.canUndo()){return false}ae=this.originator();this._redoStack.push(ae.createMemento());ae.setMemento(this._undoStack.pop());if(typeof ae.focus==="function"){ae.focus()}return true};ad.prototype.redo=function(){var ae;if(!this.canRedo()){return false}ae=this.originator();this._undoStack.push(ae.createMemento());ae.setMemento(this._redoStack.pop());if(typeof ae.focus==="function"){ae.focus()}return true};ad.prototype.canUndo=function(){return this._undoStack.length>0};ad.prototype.canRedo=function(){return this._redoStack.length>0};return ad})();if(typeof exports!=="undefined"&&exports!==null){exports.NotImplementedError=z;exports.Originator=G;exports.Caretaker=g}O=(function(){function ad(ae,af){this.document=ae;this.element=af;this}ad.prototype._getCaret=function(){var ah,ai,ag,ae,af;if(this.document.selection!=null){ae=this.document.selection.createRange();ai=ae.duplicate();ai.moveToElementText(this.element);ai.setEndPoint("EndToEnd",ae);af=ai.text.length-ae.text.length;ag=af+ae.text.length}else{if(this.element.setSelectionRange!=null){af=this.element.selectionStart;ag=this.element.selectionEnd}}ah=[af,ag];return ah};ad.prototype._setCaret=function(ah,ae){var af,ag;ag=this.element.scrollTop;if(this.element.setSelectionRange!=null){this.element.setSelectionRange(ah,ae)}else{if(this.element.createTextRange){af=this.element.createTextRange();af.collapse(true);af.moveStart("character",ah);af.moveEnd("character",ae-ah);af.select()}}this.element.focus();this.element.scrollTop=ag;return this};ad.prototype.caret=function(af,ae){if((af!=null)&&af instanceof Array){ae=af[1];af=af[0]}if((af!=null)&&!(ae!=null)){ae=af}if((af!=null)&&(ae!=null)){return this._setCaret(af,ae)}return this._getCaret()};ad.prototype.caretOffset=function(af){var ae;ae=this.caret();return this.caret(ae[0]+af)};ad.prototype.replace=function(ai,aj,ag){var af,ae,ah;ah=this.element.scrollTop;ae=this.element.value.substring(0,aj);af=this.element.value.substring(ag);this.element.value=ae+ai+af;this.element.scrollTop=ah;return this};ad.prototype._getText=function(){var ah,ae,af,ag;if(this.document.selection!=null){ae=this.document.selection.createRange();return ae.text}else{if(this.element.setSelectionRange){ag=this.caret(),af=ag[0],ah=ag[1];return this.element.value.substring(af,ah)}}return null};ad.prototype._setText=function(aj,af){var ai,ae,ah,ag;ah=this.element.scrollTop;ag=this.caret(),ae=ag[0],ai=ag[1];this.replace(aj,ae,ai);ai=ae+aj.length;if(!af){ae=ai}this.caret(ae,ai);this.element.focus();this.element.scrollTop=ah;return this};ad.prototype.text=function(af,ae){if(af!=null){return this._setText(af,ae)}return this._getText()};ad.prototype.insertBefore=function(ak,af){var ai,ae,ah,aj,ag;ah=this.element.scrollTop;ag=this.caret(),ae=ag[0],ai=ag[1];aj=this.text();this.replace(ak+aj,ae,ai);ai=ae+ak.length;if(!af){ae=ai}this.caret(ae,ai);this.element.focus();this.element.scrollTop=ah;return this};ad.prototype.insertAfter=function(ak,af){var ai,ae,ah,aj,ag;ah=this.element.scrollTop;ag=this.caret(),ae=ag[0],ai=ag[1];aj=this.text();this.replace(aj+ak,ae,ai);ae=ai;ai=ai+ak.length;if(!af){ae=ai}this.caret(ae,ai);this.element.focus();this.element.scrollTop=ah;return this};ad.prototype.enclose=function(ag,ai,af){var aj,am,ae,ak,al,ah;ae=this.element.scrollTop;al=this.text();if(al.indexOf(ag)===0&&al.lastIndexOf(ai)===(al.length-ai.length)){ak=al.substring(ag.length,al.length-ai.length);this.text(ak,af)}else{ah=this.caret(),am=ah[0],aj=ah[1];this.replace(ag+al+ai,am,aj);aj=am+ag.length+al.length+ai.length;if(!af){am=aj}this.caret(am,aj)}this.element.focus();this.element.scrollTop=ae;return this};ad.prototype.lineCaret=function(ah){var ag,ae,af;ah=ah||this.caret()[0];af=this.element.value;ae=af.lastIndexOf("\n",ah-1)+1;ag=af.indexOf("\n",ah);if(ag===-1){ag=af.length}return[ae,ag]};ad.prototype._getLine=function(){var ag,ae,af;af=this.lineCaret(),ae=af[0],ag=af[1];return this.element.value.substring(ae,ag)};ad.prototype._setLine=function(ae,ag){var aj,af,ai,ah;ai=this.element.scrollTop;ah=this.lineCaret(),af=ah[0],aj=ah[1];this.replace(ae,af,aj);aj=af+ae.length;if(!ag){af=aj}this.caret(af,aj);this.element.focus();this.element.scrollTop=ai;return this};ad.prototype.line=function(af,ae){if(af!=null){return this._setLine(af,ae)}return this._getLine()};ad.prototype.selectWholeLine=function(ah){var ag,ae,af;af=this.lineCaret(ah),ae=af[0],ag=af[1];return this.caret(ae,ag)};ad.prototype.selectWholeCurrentLine=function(){return this.selectWholeLine(null)};return ad})();L=(function(){var ad,ar,ah,ag,an,ao,ap,af,al,ae,ak,am,aq,aj,ai;ak=function(at){if(at==null){at=false}return this.outerWidth(at)-this.width()};ae=function(at){if(at==null){at=false}return this.outerHeight(at)-this.height()};aq=function(at,au){var av;if(at==null){at=false}if(typeof at==="number"){au=at;at=false}if(au!=null){av=this.nonContentWidth(at);return this.width(au-av)}return this._outerWidth(at)};am=function(at,au){var av;if(at==null){at=false}if(typeof at==="number"){au=at;at=false}if(au!=null){av=this.nonContentHeight(at);return this.height(au-av)}return this._outerHeight(at)};al=function(au,at){var av;if(at==null){at=null}av=this.css(au);if(av===""||av==="none"||av===null||av===(void 0)||av===NaN){return at}av=parseInt(av,10);return av};af=function(){return this.ncss("min-width")};ap=function(){return this.ncss("min-height")};ao=function(){return this.ncss("max-width")};an=function(){return this.ncss("max-height")};ah=function(at){var aw,av,au;if(at==null){at=false}av=at?this.ncss("margin-left"):0;aw=this.ncss("border-left-width");au=this.ncss("padding-left");return av+aw+au};ag=function(at){var aw,av,au;if(at==null){at=false}av=at?this.ncss("margin-top"):0;aw=this.ncss("border-top-width");au=this.ncss("padding-top");return av+aw+au};ad=function(at){var au;au=this.offset();if(at!=null){au.left=at;return this.offset(au)}return au.left};ar=function(at){var au;au=this.offset();if(at!=null){au.top=at;return this.offset(au)}return au.top};aj=function(at,av){var aw,au;if(at==null){at=false}if(typeof at==="number"){av=at;at=false}au=L(this.parent());aw=au.absoluteX()+au.contentX(at);if(av!=null){return this.absoluteX(av+aw)}return this.absoluteX()-aw};ai=function(at,av){var aw,au;if(at==null){at=false}if(typeof at==="number"){av=at;at=false}au=L(this.parent());aw=au.absoluteY()+au.contentY(at);if(av!=null){return this.absoluteY(av+aw)}return this.absoluteY()-aw};L=function(at){if(at.__evoluted__===true){return at}at._outerWidth=at.outerWidth;at._outerHeight=at.outerHeight;at.nonContentWidth=ak;at.nonContentHeight=ae;at.outerWidth=aq;at.outerHeight=am;at.nonContentWidth=ak;at.nonContentHeight=ae;at.ncss=al;at.minWidth=af;at.minHeight=ap;at.maxWidth=ao;at.maxHeight=an;at.contentX=ah;at.contentY=ag;at.absoluteX=ad;at.absoluteY=ar;at.relativeX=aj;at.relativeY=ai;at.__evoluted__=true;return at};return L})();p=function(ae){var ad;ae.css("position","relative");ad=$("<div>").appendTo(ae).hide().css({position:"absolute",top:"0",left:"0",overflow:"hidden","z-index":99999});ad.on=function(){ad.refresh();ad.show();return this};ad.refresh=function(){ad.width(ae.outerWidth(true));ad.height(ae.outerHeight(true));return this};ad.off=function(){ad.hide();return this};return ad};W=(function(){var ad,ae;ae=function(){return(new Date()).getTime()};ad={start:0,end:100,duration:1000,callbackEach:null,callbackDone:null,easing:jQuery.easing.swing};return function(af){var ai,ag,ah;af=jQuery.extend(ad,af);ag=ae();ai=af.end-af.start;ah=function(){var ak,aj;ak=ae()-ag;aj=af.easing(ak/af.duration,ak,0,1,af.duration);aj=aj*ai+af.start;af.callbackEach(aj,ak);if(ak<af.duration){return setTimeout(ah,1)}else{af.callbackEach(af.end,af.duration);return typeof af.callbackDone==="function"?af.callbackDone():void 0}};ah();return null}})();e=(function(){var ad;ad=function(aj){var af,ai,ag,ah,ae;if(aj.which!==13){return}ag=this.selection.line();if((ah=this.autoIndent.pre)!=null){ah.call(this,aj,ag)}af=ag.replace(/^([\t\s]*).*$/,"$1");ai="\n"+af;this.selection.insertAfter(ai,false);if((ae=this.autoIndent.post)!=null){ae.call(this,aj,ag,af,ai)}aj.stopPropagation();aj.stopImmediatePropagation();aj.preventDefault();this.focus();return false};return function(ae,ag,af){if(!(ae instanceof jQuery)){ae=$(ae)}if(!(ae.selection!=null)){ae.selection=new O(document,ae.get(0))}ae.autoIndent=function(ah){return ad.call(ae,ah)};ae.autoIndent.enable=function(){ae.on("keydown",ae.autoIndent);return ae};ae.autoIndent.disable=function(){ae.off("keydown",ae.autoIndent);return ae};if(ag!=null){ae.autoIndent.pre=function(ai,ah){return ag.call(ae,ai,ah)}}if(af!=null){ae.autoIndent.post=function(ak,ai,ah,aj){return af.call(ae,ak,ai,ah,aj)}}return ae.autoIndent.enable()}})();if(window.i18n!=null){h=function(ad){return i18n.t(ad,{defaultValue:ad})}}else{h=function(ad){return ad}}o={mainPanelClass:null,editorClass:null,viewerClass:null,helperClass:null,toolbarButtons:[],statusbarButtons:[],defaultVolume:null,defaultVolume2:null};this.Jencil=(function(){function ad(ae,af){var ag,ah=this;ag={profile:"Html",profiles:{Html:C},resizable:true,enableTabIndent:true,enableAutoIndent:true,tabString:"    ",defaultVolume:null,defaultVolume2:null,width:640,height:620,editorTemplatePath:null,viewerTemplatePath:null,helperTemplatePath:null};this.options=jQuery.extend(ag,af);this.element=ae.hide();this.caretaker=new g();this.caretaker.originator=function(){return ah.editor()};this.wrapper=new w(this,this.options.width,this.options.height);this.fullscreen=new v(this);this.element.after(this.wrapper.element).after(this.fullscreen.element);this.wrapper.init();this.wrapper.adjust();this.caretaker.save()}ad.prototype.editor=function(){return this.wrapper.workspace.mainPanel.editorPanel||null};ad.prototype.viewer=function(){return this.wrapper.workspace.mainPanel.viewerPanel||null};ad.prototype.helper=function(){return this.wrapper.workspace.mainPanel.helperPanel||null};return ad})();$.fn.jencil=function(ad){return new Jencil($(this),ad)};Q("Jencil.profiles",function(ad){return ad.DefaultProfile=o});Q("Jencil.utils.namespace",function(ad){return ad.namespace=Q});Q("Jencil.utils.evolution",function(ad){return ad.evolute=L});Q("Jencil.utils.selection",function(ad){return ad.Selection=O});Q("Jencil.utils.animation",function(ad){return ad.animate=W});Q("Jencil.utils.autoindent",function(ad){return ad.autoIndentable=e});Q("Jencil.utils.curtain",function(ad){return ad.curtainFactory=p});Q("Jencil.utils.i18n",function(ad){return ad.translate=h});Q("Jencil.utils.undo",function(ad){ad.NotImplementedError=z;ad.Originator=G;return ad.Caretaker=g});Q("Jencil",function(ad){return ad.t=h});l=(function(){function ad(af,ae,ag){this.core=af;if(ae==null){ae="<div>"}if(ae instanceof jQuery){this.element=ae}else{this.element=$(ae,ag)}this.element=L(this.element)}ad.prototype.init=function(){return this};ad.prototype.adjust=function(){return this};return ad})();j=(function(ad){q(ae,ad);function ae(ag,af,ah){if(af==null){af="<div>"}ae.__super__.constructor.call(this,ag,af,ah);this.element.addClass("panel")}return ae})(l);s=(function(ae){q(ad,ae);function ad(ah,ai,af,ak){var aj,ag,al=this;this.fst=ai;this.snd=af;this.splitter=ak;ad.__super__.constructor.call(this,ah);this.element.addClass("multiple");this.element.append(this.fst.element);this.element.append(this.splitter.element);this.element.append(this.snd.element);ag=function(am){if(!this.element.is(":visible")){return this.toggle(am,null)}};aj=function(am){if(this.element.is(":visible")){return this.toggle(null,am)}};this.fst.toggle=function(an,am){return al._togglePanel(0,an,am)};this.fst.show=function(){return ag.call(al.fst)};this.fst.hide=function(){return aj.call(al.fst)};this.snd.toggle=function(an,am){return al._togglePanel(1,an,am)};this.snd.show=function(){return ag.call(al.snd)};this.snd.hide=function(){return aj.call(al.snd)};this.splitter.element.dblclick(function(){return al.snd.toggle()})}ad.prototype.init=function(){this.fst.init();this.snd.init();return this.splitter.init()};ad.prototype._togglePanel=function(am,ak,ag){var ai,af,ah,aj,al=this;if(ad._animating){return}ah=this.splitter.volume();ai=null;if((0<ah&&ah<1)){af=am;this.splitter._previousVolume=ah;aj=ag}else{af=this.splitter._previousVolume||this.splitter.defaultVolume;if(af===am){af=0.5}aj=ak}ad._animating=true;ai=function(){ad._animating=false;return typeof aj==="function"?aj():void 0};return W({start:ah,end:af,duration:500,callbackEach:function(ao,an){return al.splitter.volume(ao)},callbackDone:ai})};return ad})(j);m=(function(ae){q(ad,ae);function ad(ag,ah,af,ai){var aj;if(ai==null){ai=0.5}aj=new J(ag,ah,af,ai);ad.__super__.constructor.call(this,ag,ah,af,aj);this.element.addClass("vertical")}ad.prototype.adjust=function(){this.fst.element.outerHeight(true,this.element.height());this.snd.element.outerHeight(true,this.element.height());this.splitter.element.outerHeight(true,this.element.height());this.splitter.adjust();return this};return ad})(s);V=(function(ae){q(ad,ae);function ad(ag,ah,af,ai){var aj;if(ai==null){ai=0.5}aj=new D(ag,ah,af,ai);ad.__super__.constructor.call(this,ag,ah,af,aj);this.element.addClass("horizontal")}ad.prototype.adjust=function(){this.fst.element.outerWidth(true,this.element.width());this.snd.element.outerWidth(true,this.element.width());this.splitter.element.outerWidth(true,this.element.width());this.splitter.adjust();return this};return ad})(s);Q("Jencil.widgets",function(ad){ad.Widget=l;ad.Panel=j;ad.MultiplePanel=s;ad.VerticalPanel=m;return ad.HorizontalPanel=V});T=(function(ad){q(ae,ad);function ae(ag,ah,af,ai){var aj,ak,al=this;this.fst=ah;this.snd=af;this.defaultVolume=ai!=null?ai:0.5;ae.__super__.constructor.call(this,ag);this.element.addClass("splitter");this._volume=this.defaultVolume;aj=function(ao){var an,am;al.mousemove(ao);if((an=al.fst.curtain)!=null){an.refresh()}if((am=al.snd.curtain)!=null){am.refresh()}ao.stopPropagation();ao.stopImmediatePropagation();return ao.preventDefault()};ak=function(ao){var ap,an,am;ap=$(window);ap.unbind("mousemove",aj);ap.unbind("mouseup",ak);if((an=al.fst.curtain)!=null){an.off()}if((am=al.snd.curtain)!=null){am.off()}ao.stopPropagation();ao.stopImmediatePropagation();return ao.preventDefault()};this.element.mousedown(function(ao){var ap,an,am;ap=$(window);ap.mousemove(aj);ap.mouseup(ak);if((an=al.fst.curtain)!=null){an.on()}if((am=al.snd.curtain)!=null){am.on()}ao.stopPropagation();ao.stopImmediatePropagation();return ao.preventDefault()})}ae.prototype.init=function(){this.container=L(this.element.parent());return this};ae.prototype.volume=function(ag,af){if(af==null){af=false}if(ag!=null){this._volume=ag;if(!af){this.adjust()}return this}return this._volume};ae.prototype.value=function(ai,ah){var af,ag;if(ah==null){ah=false}af=this.valueWidth();if(ai!=null){ag=ai/af;return this.volume(ag,ah)}return this.volume()*af};ae.prototype.regulateValue=function(ag){var ah,af;af=this.minValue();ah=this.maxValue();if(ag<af){ag=af}if(ag>ah){ag=ah}return ag};return ae})(l);J=(function(ad){q(ae,ad);function ae(ah,ai,ag,aj){var ak,af;ae.__super__.constructor.call(this,ah,ai,ag,aj);this.element.addClass("vertical");this.fst.element.addClass("left");this.snd.element.addClass("right");this.fst.element.css({"float":"left"});this.snd.element.css({"float":"left"});if((ak=this.fst.curtain)!=null){ak.css("pointer","col-resize")}if((af=this.snd.curtain)!=null){af.css("pointer","col-resize")}}ae.prototype.mousemove=function(ag){var ah,af;ah=this.container.absoluteX()+this.container.contentX(true);af=ag.pageX-ah;af=this.regulateValue(af);return this.value(af)};ae.prototype.valueWidth=function(){return this.container.width()};ae.prototype.minValue=function(){var ag,af;ag=this.fst.element.minWidth()+this.fst.element.nonContentWidth();af=this.snd.element.maxWidth();if(af!=null){af=this.valueWidth()-(af+this.snd.element.nonContentWidth())}if((ag!=null)&&(af!=null)){return Math.max(ag,af)}return ag||af||0};ae.prototype.maxValue=function(){var ah,ag,af;af=this.valueWidth();ah=this.fst.element.maxWidth();if(ah!=null){ah=ah+this.fst.element.nonContentWidth()}ag=this.snd.element.minWidth()+this.snd.element.nonContentWidth();if(ag!=null){ag=af-ag}if((ah!=null)&&(ag!=null)){return Math.min(ah,ag)}return ah||ag||af};ae.prototype.adjust=function(){var ai,ah,ag,af;ag=this.value();af=this.valueWidth();ai=ag-this.fst.element.nonContentWidth(true);ah=(af-ag)-this.snd.element.nonContentWidth(true);if(ai<=0){if(this.fst.element.is(":visible")){this.fst.element.hide()}if(!this.snd.element.is(":visible")){this.snd.element.show()}this.snd.element.outerWidth(true,af);this._value=ag=0}else{if(ah<=0){if(!this.fst.element.is(":visible")){this.fst.element.show()}if(this.snd.element.is(":visible")){this.snd.element.hide()}this.fst.element.outerWidth(true,af);this._value=ag=af}else{if(!this.fst.element.is(":visible")){this.fst.element.show()}if(!this.snd.element.is(":visible")){this.snd.element.show()}this.fst.element.width(ai);this.snd.element.width(ah)}}this.fst.adjust();this.snd.adjust();this.element.relativeX(ag-this.element.outerWidth()/2);return this};return ae})(T);D=(function(ae){q(ad,ae);function ad(ah,ai,ag,aj){var ak,af;ad.__super__.constructor.call(this,ah,ai,ag,aj);this.element.addClass("horizontal");this.fst.element.addClass("top");this.snd.element.addClass("bottom");if((ak=this.fst.curtain)!=null){ak.css("pointer","raw-resize")}if((af=this.snd.curtain)!=null){af.css("pointer","raw-resize")}}ad.prototype.mousemove=function(ag){var ah,af;ah=this.container.absoluteY()+this.container.contentY(true);af=ag.pageY-ah;af=this.regulateValue(af);return this.value(af)};ad.prototype.valueWidth=function(){return this.container.height()};ad.prototype.minValue=function(){var ag,af;ag=this.fst.element.minHeight()+this.fst.element.nonContentHeight();af=this.snd.element.maxHeight();if(af!=null){af=this.valueWidth()-(af+this.snd.element.nonContentHeight())}if((ag!=null)&&(af!=null)){return Math.max(ag,af)}return ag||af||0};ad.prototype.maxValue=function(){var ah,ag,af;af=this.valueWidth();ah=this.fst.element.maxHeight();if(ah!=null){ah=ah+this.fst.element.nonContentHeight()}ag=this.snd.element.minHeight()+this.snd.element.nonContentHeight();if(ag!=null){ag=af-ag}if((ah!=null)&&(ag!=null)){return Math.min(ah,ag)}return ah||ag||af};ad.prototype.adjust=function(){var ai,ah,ag,af;ag=this.value();af=this.valueWidth();ai=ag-this.fst.element.nonContentHeight(true);ah=(af-ag)-this.snd.element.nonContentHeight(true);if(ai<=0){if(this.fst.element.is(":visible")){this.fst.element.hide()}if(!this.snd.element.is(":visible")){this.snd.element.show()}this.snd.element.outerHeight(true,af);this._value=ag=0}else{if(ah<=0){if(!this.fst.element.is(":visible")){this.fst.element.show()}if(this.snd.element.is(":visible")){this.snd.element.hide()}this.fst.element.outerHeight(true,af);this._value=ag=af}else{if(!this.fst.element.is(":visible")){this.fst.element.show()}if(!this.snd.element.is(":visible")){this.snd.element.show()}this.fst.element.height(ai);this.snd.element.height(ah)}}this.fst.adjust();this.snd.adjust();this.element.relativeY(ag-this.element.outerHeight()/2);return this};return ad})(T);Q("Jencil.splitters",function(ad){ad.Splitter=T;ad.VerticalSplitter=J;return ad.HorizontalSplitter=D});R=(function(ae){q(ad,ae);function ad(ag,af,ah){if(af==null){af="<div>"}ad.__super__.constructor.call(this,ag,af,ah);this.element.addClass("editor");this._changeCallbacks=[]}ad.prototype.val=function(af){throw new Error("NotImplementedError")};ad.prototype.change=function(ai){var ah,af,ag;if(ai!=null){this._changeCallbacks.push(ai);return this}ag=this._changeCallbacks;for(ah=0,af=ag.length;ah<af;ah++){ai=ag[ah];ai.call(this,this.val())}return this};ad.prototype.h1=null;ad.prototype.h2=null;ad.prototype.h3=null;ad.prototype.h4=null;ad.prototype.h5=null;ad.prototype.h6=null;ad.prototype.bold=null;ad.prototype.italic=null;ad.prototype.underline=null;ad.prototype.strike=null;ad.prototype.superscript=null;ad.prototype.subscript=null;ad.prototype.anchor=null;ad.prototype.image=null;ad.prototype.unorderedList=null;ad.prototype.orderedList=null;return ad})(j);K=(function(ad){q(ae,ad);function ae(ag,af,ah){var ai=this;if(af==null){af="<div>"}ae.__super__.constructor.call(this,ag,af,ah);this.textarea=$("<textarea>").appendTo(this.element).css({margin:"0",padding:"0",border:"none",outline:"none",resize:"none"});this.textarea=L(this.textarea);this.textarea.on("keydown",function(aj){if(aj.which!==13){return}return ai.core.caretaker.save()});if(($.fn.tabby!=null)&&this.core.options.enableTabIndent){this.textarea.tabby({tabString:this.core.options.tabString})}this.textarea=e(this.textarea);if(!this.core.options.enableAutoIndent){this.textarea.autoIndent.disable()}this.textarea.on("keypress keyup click blur",function(){return ai.change()})}ae.prototype.val=function(af){if(af!=null){this.textarea.val(af);this.change();return this}return this.textarea.val()};ae.prototype.focus=function(){this.textarea.focus();return this};ae.prototype.createMemento=function(){return this.val()};ae.prototype.setMemento=function(af){return this.val(af)};ae.prototype.adjust=function(){this.textarea.outerWidth(this.element.width());this.textarea.outerHeight(this.element.height());return this};ae.prototype.selection=function(ag,af){if(af==null){af=true}if(ag!=null){this.textarea.selection.text(ag,af);this.core.caretaker.save();return this.change()}return this.textarea.selection.text()};ae.prototype.enclose=function(af,ag,ah){var ai;if(ah==null){ah=true}ai=this.textarea.selection.caret();if(ai[0]===ai[1]){this.textarea.selection.selectWholeCurrentLine()}this.textarea.selection.enclose(af,ag,ah);this.core.caretaker.save();return this.change()};ae.prototype.insertBefore=function(ah,af){var ag;if(af==null){af=true}ag=this.textarea.selection.caret();if(ag[0]===ag[1]){this.textarea.selection.selectWholeCurrentLine()}this.textarea.selection.insertBefore(ah,af);this.core.caretaker.save();return this.change()};ae.prototype.insertAfter=function(ah,af){var ag;if(af==null){af=true}ag=this.textarea.selection.caret();if(ag[0]===ag[1]){this.textarea.selection.selectWholeCurrentLine()}this.textarea.selection.insertAfter(ah,af);this.core.caretaker.save();return this.change()};return ae})(R);Q("Jencil.editors",function(ad){ad.BaseEditor=R;return ad.TextEditor=K});A=(function(ae){q(ad,ae);function ad(ag,af,ah){if(af==null){af="<div>"}ad.__super__.constructor.call(this,ag,af,ah);this.element.addClass("viewer")}ad.prototype.update=function(ag,af){throw new Error("NotImplementedError")};return ad})(j);aa=(function(ae){q(ad,ae);function ad(af){ad.__super__.constructor.call(this,af);this.templatePath=this.core.options.viewerTemplatePath;this.element.css({position:"relative"});this.curtain=p(this.element);this.iframe=$("<iframe>").appendTo(this.element).css({margin:"0",padding:"0",border:"none",outline:"none",resize:"none",width:"100%",height:"100%",overflow:"visible"});this.iframe.attr("frameborder",0);this.iframe=L(this.iframe);this.iframe.init=function(){var ag;ag=this.get(0);if(ag.contentDocument!=null){this.document=ag.contentDocument}else{this.document=ag.contentWindow.document}return this.document.write("<body></body>")};this.iframe.write=function(ag){var ai;if(this.document!=null){try{ai=this.document.documentElement.scrollTop}catch(ah){ai=0}this.document.open();this.document.write(ag);this.document.close();$("a",$(this.document)).attr("target","_blank");this.document.documentElement.scrollTop=ai;this.width(this.document.scrollLeft);this.height(this.document.scrollTop);return true}return false};this.iframe.loadTemplate=function(ag,ah){var ai=this;return $.ajax({url:ag,success:function(aj){ai._template=aj;return ai.write(ah)}})}}ad.prototype.init=function(){return this.iframe.init()};ad.prototype.update=function(ag,af){if(this.iframe._template!=null){ag=this.iframe._template.replace("{{content}}",ag)}else{if(this.templatePath!=null){this.iframe.loadTemplate(this.templatePath,ag)}}return this.iframe.write(ag)};ad.prototype.adjust=function(){this.iframe.outerWidth(this.element.width());this.iframe.outerHeight(this.element.height());return this};return ad})(A);P=(function(ae){q(ad,ae);function ad(af,ag){this.config=ag;ad.__super__.constructor.call(this,af);this.config=jQuery.extend({type:"GET",dataType:"text",data:function(ah){return encodeURIComponent(ah)},url:null},this.config)}ad.prototype.update=function(ag,af){var ah=this;if(this._valueCache!==ag||af){this._valueCache=ag;return $.ajax({type:this.config.type,dataType:this.config.dataType,data:JSON.stringify(this.config.data(ag)),url:this.config.url,success:function(ai){if(ah.iframe._template!=null){ai=ah.iframe._template.replace("{{content}}",ai)}else{if(ah.templatePath!=null){ah.iframe.loadTemplate(ah.templatePath,ai)}}return ah.iframe.write(ai)}})}};return ad})(aa);Q("Jencil.viewers",function(ad){ad.BaseViewer=A;ad.TemplateViewer=aa;return ad.AjaxViewer=P});c=(function(ae){q(ad,ae);function ad(ag,af,ah){if(af==null){af="<div>"}ad.__super__.constructor.call(this,ag,af,ah);this.element.addClass("helper")}return ad})(j);E=(function(ae){q(ad,ae);function ad(af){ad.__super__.constructor.call(this,af);this.templatePath=this.core.options.helperTemplatePath;this.element.css({position:"relative"});this.curtain=p(this.element);this.iframe=$("<iframe>").appendTo(this.element).css({margin:"0",padding:"0",border:"none",outline:"none",resize:"none",width:"100%",height:"100%",overflow:"visible"});this.iframe.attr("frameborder",0);this.iframe=L(this.iframe);this.iframe.init=function(){var ag;ag=this.get(0);if(ag.contentDocument!=null){this.document=ag.contentDocument}else{this.document=ag.contentWindow.document}return this.document.write("<body></body>")};this.iframe.write=function(ag){var ai;if(this.document!=null){try{ai=this.document.documentElement.scrollTop}catch(ah){ai=0}this.document.open();this.document.write(ag);this.document.close();this.document.documentElement.scrollTop=ai;this.width(this.document.scrollLeft);this.height(this.document.scrollTop);return true}return false};this.iframe.loadTemplate=function(ag){var ah=this;return $.ajax({url:ag,success:function(ai){return ah.write(ai)}})}}ad.prototype.init=function(){this.iframe.init();if(this.templatePath!=null){return this.iframe.loadTemplate(this.templatePath)}};ad.prototype.adjust=function(){this.iframe.outerWidth(this.element.width());this.iframe.outerHeight(this.element.height());return this};return ad})(c);Q("Jencil.helpers",function(ad){ad.BaseHelper=c;return ad.TemplateHelper=E});y=(function(ad){q(ae,ad);function ae(af){ae.__super__.constructor.call(this,af,"<span>");this.element.addClass("separator")}return ae})(l);U=(function(ae){q(ad,ae);function ad(af,ag,ai,ah){this.name=ag;this.text=ai;this.title=ah;ad.__super__.constructor.call(this,af,"<a>");this.text=Jencil.t(this.text||this.name);this.title=Jencil.t(this.title||this.text);this.element.addClass("button").addClass(ag);this.element.append($("<span>"+this.text+"</span>"));this.element.attr("title",this.title)}ad.prototype.enable=function(){return this.element.removeClass("disable")};ad.prototype.disable=function(){return this.element.addClass("disable")};ad.prototype.validate=function(){return this};return ad})(l);Y=(function(ae){q(ad,ae);function ad(ag,ah,aj,ai,al,af){var ak=this;this.shortcut=af;ad.__super__.constructor.call(this,ag,ah,aj,ai);this.callback=function(){if(!ak.element.hasClass("disable")){return al()}};this.callback.raw=al;this.element.click(function(){return ak.callback()});if((this.shortcut!=null)&&(window.shortcut!=null)){window.shortcut.add(this.shortcut,function(am){return ak.callback()});this.element.attr("title",""+this.title+" ("+this.shortcut+")")}}return ad})(U);f=(function(ad){q(ae,ad);function ae(ag,ah,ak,aj,ai,af){var al;this.command=ai;al=function(){var am;am=ag.editor();return am[ai].call(am)};ae.__super__.constructor.call(this,ag,ah,ak,aj,al,af)}ae.prototype.init=function(){return this.validate()};ae.prototype.validate=function(){var af;af=this.core.editor();if(!(af[this.command]!=null)){this.disable()}return this};ae.factory=function(ag,ai){var al,ah,af,ak,aj;ah=ak=aj=al=af=null;switch(ai.length){case 5:ah=ai[0];ak=ai[1];aj=ai[2];al=ai[3];af=ai[4];break;case 4:ah=ai[0];ak=aj=ai[1];al=ai[2];af=ai[3];break;case 3:ah=al=ai[0];ak=aj=ai[1];af=ai[2];break;case 2:ah=al=ai[0];ak=aj=ai[1];af=null;break;case 1:ah=al=ak=aj=ai[0];af=null}return new ae(ag,ah,ak,aj,al,af)};return ae})(Y);B=(function(ad){q(ae,ad);function ae(af){var ah,ag=this;ah=function(ai){return ag.core.caretaker.undo()};ae.__super__.constructor.call(this,af,"undo","Undo","Undo",ah,"Ctrl+Z")}ae.prototype.init=function(){var af,ag=this;af=function(){if(!ag.core.caretaker.canUndo()){ag.disable()}else{ag.enable()}return setTimeout(af,100)};return af()};return ae})(Y);a=(function(ae){q(ad,ae);function ad(af){var ah,ag=this;ah=function(ai){return ag.core.caretaker.redo()};ad.__super__.constructor.call(this,af,"redo","Redo","Redo",ah,"Ctrl+Shift+Z")}ad.prototype.init=function(){var af,ag=this;af=function(){if(!ag.core.caretaker.canRedo()){ag.disable()}else{ag.enable()}return setTimeout(af,100)};return af()};return ad})(Y);r=(function(ae){q(ad,ae);function ad(af){var ah,ag=this;ah=function(ai){return ag.core.fullscreen.toggle()};ad.__super__.constructor.call(this,af,"fullscreen","Toggle fullscreen","Fullscreen",ah,"Ctrl+F")}ad.prototype.init=function(){var af,ag=this;af=function(){if(ag.core.fullscreen.element.is(":visible")){ag.element.addClass("hide")}else{ag.element.removeClass("hide")}return setTimeout(af,100)};return af()};return ad})(Y);X=(function(ae){q(ad,ae);function ad(af){var ah,ag=this;ah=function(ai){return ag.core.viewer().toggle()};ad.__super__.constructor.call(this,af,"viewer","Quick view","Quick view",ah,"Ctrl+Q")}ad.prototype.validate=function(){if(!this.core.viewer()){this.disable();return false}return true};ad.prototype.init=function(){var af,ag=this;if(!this.validate()){return}af=function(){if(ag.core.viewer().element.is(":visible")){ag.element.addClass("hide")}else{ag.element.removeClass("hide")}return setTimeout(af,100)};return af()};return ad})(Y);i=(function(ae){q(ad,ae);function ad(af){var ah,ag=this;ah=function(ai){return ag.core.helper().toggle()};ad.__super__.constructor.call(this,af,"helper","Help","Help",ah,"Ctrl+H")}ad.prototype.validate=function(){if(!this.core.helper()){this.disable();return false}return true};ad.prototype.init=function(){var af,ag=this;if(!this.validate()){return}af=function(){if(ag.core.helper().element.is(":visible")){ag.element.addClass("hide")}else{ag.element.removeClass("hide")}return setTimeout(af,100)};return af()};return ad})(Y);S=function(ad,ae){if(ae instanceof Array){return f.factory(ad,ae)}if(typeof ae==="string"){switch(ae){case"Separator":return new y(ad);case"Undo":return new B(ad);case"Redo":return new a(ad);case"Fullscreen":return new r(ad);case"Viewer":return new X(ad);case"Helper":return new i(ad);default:throw new Exception(""+ae+" is not known Button type")}}return new ae(ad)};Q("Jencil.buttons",function(ad){ad.Separator=y;ad.Button=U;ad.ActionButton=Y;ad.CommandButton=f;ad.UndoButton=B;ad.RedoButton=a;ad.FullscreenButton=r;ad.ViewerButton=X;return ad.HelperButton=i});w=(function(ad){q(ae,ad);function ae(ag,ah,af){ae.__super__.constructor.call(this,ag);this.element.addClass("jencil wrapper");this.element.width(ah);this.element.height(af);this.workspace=new n(this.core);this.workspace.element.appendTo(this.element)}ae.prototype.init=function(){var af=this;if((this.element.resizable!=null)&&this.core.options.resizable===true){this.element.resizable({start:function(){var ai,ag,al,ak,aj,ah;if((ai=af.core.editor())!=null){if((ag=ai.curtain)!=null){ag.on()}}if((al=af.core.viewer())!=null){if((ak=al.curtain)!=null){ak.on()}}return(aj=af.core.helper())!=null?(ah=aj.curtain)!=null?ah.on():void 0:void 0},resize:function(){var ai,ag,al,ak,aj,ah;if((ai=af.core.editor())!=null){if((ag=ai.curtain)!=null){ag.refresh()}}if((al=af.core.viewer())!=null){if((ak=al.curtain)!=null){ak.refresh()}}if((aj=af.core.helper())!=null){if((ah=aj.curtain)!=null){ah.refresh()}}return af.adjust()},stop:function(){var ai,ag,al,ak,aj,ah;if((ai=af.core.editor())!=null){if((ag=ai.curtain)!=null){ag.off()}}if((al=af.core.viewer())!=null){if((ak=al.curtain)!=null){ak.off()}}if((aj=af.core.helper())!=null){if((ah=aj.curtain)!=null){ah.off()}}return af.adjust()}})}return this.workspace.init()};ae.prototype.adjust=function(){this.workspace.element.outerWidth(true,this.element.width());this.workspace.element.outerHeight(true,this.element.height());this.workspace.adjust();return this};return ae})(j);n=(function(ae){q(ad,ae);function ad(af){ad.__super__.constructor.call(this,af);this.element.addClass("workspace");this.profile(af.options.profile)}ad.prototype.profile=function(ah){var an,al,aj,ap,af,am,ak,ai,ag,ao=this;if(ah!=null){if(typeof ah==="string"){ah=this.core.options.profiles[ah]}ah=jQuery.extend(o,ah);ah.defaultVolume=this.core.options.defaultVolume||ah.defaultVolume;ah.defaultVolume2=this.core.options.defaultVolume2||ah.defaultVolume2;this.element.empty();this.mainPanel=new ah.mainPanelClass(this.core,ah);if((am=this.mainPanel.editorPanel)!=null){am.val(this.core.element.val())}if((ak=this.mainPanel.editorPanel)!=null){ak.change(function(aq){return ao.core.element.val(aq)})}this.toolbar=new t(this.core);ai=ah.toolbarButtons;for(al=0,ap=ai.length;al<ap;al++){an=ai[al];an=S(this.core,an);this.toolbar.addButton(an)}this.statusbar=new H(this.core);ag=ah.statusbarButtons;for(aj=0,af=ag.length;aj<af;aj++){an=ag[aj];an=S(this.core,an);this.statusbar.addButton(an)}this.element.append(this.toolbar.element);this.element.append(this.mainPanel.element);this.element.append(this.statusbar.element);this._profile=ah;return this}return this._profile};ad.prototype.init=function(){this.toolbar.init();this.statusbar.init();return this.mainPanel.init()};ad.prototype.adjust=function(){var ag,af;this.toolbar.element.outerWidth(true,this.element.width());this.statusbar.element.outerWidth(true,this.element.width());this.mainPanel.element.outerWidth(true,this.element.width());this.mainPanel.element.outerHeight(true,this.element.height());this.mainPanel.adjust();ag=this.toolbar.element.outerHeight(true);af=this.statusbar.element.outerHeight(true);this.mainPanel.element.outerHeight(true,this.element.height()-(ag+af));this.toolbar.adjust();this.statusbar.adjust();this.mainPanel.adjust();return this};ad.prototype.update=function(af){if(this.mainPanel.editorPanel&&this.mainPanel.viewerPanel){return this.mainPanel.viewerPanel.update(this.mainPanel.editorPanel.val(),af)}};return ad})(j);F=(function(ae){q(ad,ae);function ad(af){ad.__super__.constructor.call(this,af);this._buttons=[]}ad.prototype.init=function(){var ag,ai,af,ah;ah=this._buttons;for(ai=0,af=ah.length;ai<af;ai++){ag=ah[ai];ag.init()}return this};ad.prototype.addButton=function(af){this._buttons.push(af);return this.element.append(af.element)};return ad})(j);t=(function(ae){q(ad,ae);function ad(af){ad.__super__.constructor.call(this,af);this.element.addClass("toolbar")}return ad})(F);H=(function(ae){q(ad,ae);function ad(af){ad.__super__.constructor.call(this,af);this.element.addClass("statusbar")}return ad})(F);b=(function(){function ad(ae,ag){var af;af=new ag.editorClass(ae);af.element.addClass("mainPanel");return af}return ad})();N=(function(ae){q(ad,ae);function ad(af,ag){var ah=this;this.editorPanel=new ag.editorClass(af);this.viewerPanel=new ag.viewerClass(af);ad.__super__.constructor.call(this,af,this.editorPanel,this.viewerPanel,ag.defaultVolume);this.element.addClass("mainPanel");this.editorPanel.change(function(ai){return ah.viewerPanel.update(ai)})}return ad})(m);ab=(function(ae){q(ad,ae);function ad(af,ag){var ah=this;this.editorPanel=new ag.editorClass(af);this.viewerPanel=new ag.viewerClass(af);this.helperPanel=new ag.helperClass(af);this.verticalPanel=new m(af,this.editorPanel,this.viewerPanel,ag.defaultVolume);ad.__super__.constructor.call(this,af,this.verticalPanel,this.helperPanel,ag.defaultVolume2);this.element.addClass("mainPanel");this.editorPanel.change(function(ai){return ah.viewerPanel.update(ai)})}return ad})(V);Q("Jencil.mainpanels",function(ad){ad.MonomainPanel=b;ad.DimainPanel=N;return ad.TrimainPanel=ab});v=(function(ae){q(ad,ae);function ad(af){var ag=this;ad.__super__.constructor.call(this,af);this.element.addClass("fullscreen");this.element.css({position:"fixed",top:"0",left:"0",width:"100%",height:"100%","z-index":100});this.curtain=$("<div>").addClass("curtain");this.curtain.css({position:"absolute",top:"0",left:"0",width:"100%",height:"100%",background:"black",opacity:"0.6",cursor:"pointer"});this.cell=$("<div>").css({position:"absolute",top:"5%",left:"5%",width:"90%",height:"90%"});if($.browser.msie&&$.browser.version<7){this.element.css("position","absolute");$(window).scroll(function(){return ag.element.css("top",$(document).scrollTop())})}this.curtain.click(function(){return ag.off()});this.element.append(this.curtain);this.element.append(this.cell);this.element.hide();this.resize=function(){return ag.core.wrapper.adjust()}}ad.prototype.on=function(){var af,ag=this;af=9/10;this.cell.append(this.core.wrapper.element);this.core.wrapper.element.outerWidth(true,this.element.width()*af);this.core.wrapper.element.outerHeight(true,this.element.height()*af);this.core.wrapper.init();this.core.wrapper.adjust();this.core.wrapper.workspace.update(true);this.element.fadeIn("fast",function(){ag.core.wrapper.element.css("width","100%");ag.core.wrapper.element.css("height","100%");return ag.core.wrapper.adjust()});return $(window).on("resize",this.resize)};ad.prototype.off=function(){this.core.element.after(this.core.wrapper.element);this.core.wrapper.element.css("width","");this.core.wrapper.element.css("height","");this.core.wrapper.init();this.core.wrapper.adjust();this.core.wrapper.workspace.update(true);this.element.fadeOut("fast");return $(window).unbind("resize",this.resize)};ad.prototype.toggle=function(ag,af){if(this.element.is(":visible")){this.off();return typeof af==="function"?af():void 0}else{this.on();return typeof ag==="function"?ag():void 0}};return ad})(j);d=(function(){var ae,af,ag,ad;ae=(function(){var ak,ai,aj,ah;aj=["p","li"];ah=[];for(ak=0,ai=aj.length;ak<ai;ak++){ad=aj[ak];ah.push([ad,new RegExp("^[s\t]*<"+ad+">"),new RegExp("</"+ad+">[s\t]*$")])}return ah})();ag=function(am,ai){var aj,al,ak,ah;console.log("@",this);if(am.shiftKey){return}for(ak=0,ah=ae.length;ak<ah;ak++){al=ae[ak];if(al[1].test(ai)||al[2].test(ai)){aj=this.selection._getLineCaret();this.selection.caret(aj[1]);return}}};af=function(an,aj,ah,am){var al,ak,ai;if(an.shiftKey){return}for(ak=0,ai=ae.length;ak<ai;ak++){al=ae[ak];if(al[2].test(aj)){ad=al[0];this.selection.insertAfter("<"+ad+"></"+ad+">",false);this.selection.caretOffset(-(3+ad.length));return}}};return function(ah){if(!(ah.autoIndent!=null)){ah=e(ah)}ah.autoIndent.pre=function(aj,ai){return ag.call(ah,aj,ai)};ah.autoIndent.post=function(al,aj,ai,ak){return af.call(ah,al,aj,ai,ak)};return ah}})();u=(function(){var ad;ad=new RegExp("^<h([1-6])>(.*)</h[1-6]>\n?$");return function(ah){var ag,ae,af;ag=this.textarea.selection.caret();if(ag[0]===ag[1]){this.textarea.selection.selectWholeCurrentLine()}af=this.selection();if(ad.test(af)){if(RegExp.$1===ah.toString()){ae=RegExp.$2}else{ae="<h"+ah+">"+RegExp.$2+"</h"+ah+">"}return this.selection(ae)}else{return this.enclose("<h"+ah+">","</h"+ah+">\n")}}})();M=(function(ae){q(ad,ae);function ad(af){ad.__super__.constructor.call(this,af);this.textarea=d(this.textarea)}ad.prototype.h1=function(){return u.call(this,1)};ad.prototype.h2=function(){return u.call(this,2)};ad.prototype.h3=function(){return u.call(this,3)};ad.prototype.h4=function(){return u.call(this,4)};ad.prototype.h5=function(){return u.call(this,5)};ad.prototype.h6=function(){return u.call(this,6)};ad.prototype.bold=function(){return this.enclose("<b>","</b>")};ad.prototype.italic=function(){return this.enclose("<i>","</i>")};ad.prototype.underline=function(){return this.enclose("<u>","</u>")};ad.prototype.strike=function(){return this.enclose("<s>","</s>")};ad.prototype.superscript=function(){return this.enclose("<sup>","</sup>")};ad.prototype.subscript=function(){return this.enclose("<sub>","</sub>")};ad.prototype.quote=function(){return this.enclose("<q>","</q>")};ad.prototype.blockquote=function(){return this.enclose("\n<blockquote>","</blockquote>\n")};ad.prototype.code=function(){return this.enclose("<code>","</code>")};ad.prototype.pre=function(){return this.enclose("<pre>","</pre>")};ad.prototype.anchorLink=function(){var af,ag;ag=this.selection();if(!ag){ag=window.prompt("Please input a link text","Here")}af=window.prompt("Please input a link url","http://");if(!(af!=null)){return}return this.selection("<a href='"+af+"'>"+ag+"</a>")};ad.prototype.image=function(){var af,ag;ag=window.prompt("Please input a image url","http://");af=window.prompt("(Optional) Please input a alt message","Image");if(!(ag!=null)){return}return this.selection("<img src='"+ag+"' alt='"+af+"'>")};ad.prototype.unorderedList=function(){var ag,af;ag=this.selection();ag=(function(){var ak,ai,aj,ah;aj=ag.split("\n");ah=[];for(ak=0,ai=aj.length;ak<ai;ak++){af=aj[ak];ah.push("  <li>"+af+"</li>")}return ah})();ag.unshift("<ul>");ag.push("</ul>");return this.selection(ag.join("\n"))};ad.prototype.orderedList=function(){var ag,af;ag=this.selection();ag=(function(){var ak,ai,aj,ah;aj=ag.split("\n");ah=[];for(ak=0,ai=aj.length;ak<ai;ak++){af=aj[ak];ah.push("  <li>"+af+"</li>")}return ah})();ag.unshift("<ol>");ag.push("</ol>");return this.selection(ag.join("\n"))};return ad})(K);Q("Jencil.ui.widgets.editors",function(ad){return ad.HtmlEditor=M});x=aa;Q("Jencil.ui.widgets.viewers",function(ad){return ad.HtmlViewer=x});Z=(function(ae){q(ad,ae);function ad(af){var ag;ad.__super__.constructor.call(this,af);ag='<p><span class="key">Ctrl+Z</span>'+(Jencil.t("Undo"))+'<p>\n<p><span class="key">Ctrl+Shift+Z</span>'+(Jencil.t("Redo"))+'<p>\n<p><span class="key">Ctrl+B</span>'+(Jencil.t("Make selected text property as <b>Bold</b>"))+'<p>\n<p><span class="key">Ctrl+I</span>'+(Jencil.t("Make selected text property as <i>Italic</i>"))+'<p>\n<p><span class="key">Ctrl+U</span>'+(Jencil.t("Underline selected text like <u>Underline</u>"))+'<p>\n<p><span class="key">Ctrl+F</span>'+(Jencil.t("Toggle fullscreen mode"))+'<p>\n<p><span class="key">Ctrl+Q</span>'+(Jencil.t("Toggle quick view"))+'<p>\n<p><span class="key">Ctrl+H</span>'+(Jencil.t("Toggle help"))+"<p>";this.element.html(ag)}return ad})(c);Q("Jencil.ui.widgets.helpers",function(ad){return ad.HtmlHelper=Z});C={mainPanelClass:ab,editorClass:M,viewerClass:x,helperClass:Z,defaultVolume:1,defaultVolume2:0.7,toolbarButtons:["Undo","Redo","Separator",["h1","H1"],["h2","H2"],["h3","H3"],["h4","H4"],["h5","H5"],["h6","H6"],"Separator",["bold","Bold","Ctrl+B"],["italic","Italic","Ctrl+I"],["underline","Underline","Ctrl+U"],["strike","Strikeout"],["superscript","Superscript"],["subscript","Subscript"],"Separator",["anchorLink","Anchor link"],["image","Image"],["unorderedList","Unordered list"],["orderedList","Ordered list"],["quote","Quote"],["blockquote","Blockquote"],["code","Code"],["pre","Pre"],"Separator","Fullscreen"],statusbarButtons:["Viewer","Helper"]};Q("Jencil.profiles",function(ad){return ad.HtmlProfile=C})}).call(this);