/**
 * Jencil 0.1.0
 *
 * Author:  lambdalisue
 * URL:     http://hashnote.net/
 * License: MIT License
 * 
 * Copyright (C) 2012 lambdalisue, hashnote.net allright reserved.
 *
 */
shortcut={all_shortcuts:{},add:function(b,h,d){var g={type:"keydown",propagate:false,disable_in_input:false,target:document,keycode:false};if(!d){d=g}else{for(var a in g){if(typeof d[a]=="undefined"){d[a]=g[a]}}}var f=d.target;if(typeof d.target=="string"){f=document.getElementById(d.target)}var c=this;b=b.toLowerCase();var e=function(o){o=o||window.event;if(d.disable_in_input){var l;if(o.target){l=o.target}else{if(o.srcElement){l=o.srcElement}}if(l.nodeType==3){l=l.parentNode}if(l.tagName=="INPUT"||l.tagName=="TEXTAREA"){return}}if(o.keyCode){code=o.keyCode}else{if(o.which){code=o.which}}var n=String.fromCharCode(code).toLowerCase();if(code==188){n=","}if(code==190){n="."}var s=b.split("+");var r=0;var p={"`":"~","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"_","=":"+",";":":","'":'"',",":"<",".":">","/":"?","\\":"|"};var m={esc:27,escape:27,tab:9,space:32,"return":13,enter:13,backspace:8,scrolllock:145,scroll_lock:145,scroll:145,capslock:20,caps_lock:20,caps:20,numlock:144,num_lock:144,num:144,pause:19,"break":19,insert:45,home:36,"delete":46,end:35,pageup:33,page_up:33,pu:33,pagedown:34,page_down:34,pd:34,left:37,up:38,right:39,down:40,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123};var q={shift:{wanted:false,pressed:false},ctrl:{wanted:false,pressed:false},alt:{wanted:false,pressed:false},meta:{wanted:false,pressed:false}};if(o.ctrlKey){q.ctrl.pressed=true}if(o.shiftKey){q.shift.pressed=true}if(o.altKey){q.alt.pressed=true}if(o.metaKey){q.meta.pressed=true}for(var j=0;k=s[j],j<s.length;j++){if(k=="ctrl"||k=="control"){r++;q.ctrl.wanted=true}else{if(k=="shift"){r++;q.shift.wanted=true}else{if(k=="alt"){r++;q.alt.wanted=true}else{if(k=="meta"){r++;q.meta.wanted=true}else{if(k.length>1){if(m[k]==code){r++}}else{if(d.keycode){if(d.keycode==code){r++}}else{if(n==k){r++}else{if(p[n]&&o.shiftKey){n=p[n];if(n==k){r++}}}}}}}}}}if(r==s.length&&q.ctrl.pressed==q.ctrl.wanted&&q.shift.pressed==q.shift.wanted&&q.alt.pressed==q.alt.wanted&&q.meta.pressed==q.meta.wanted){h(o);if(!d.propagate){o.cancelBubble=true;o.returnValue=false;if(o.stopPropagation){o.stopPropagation();o.preventDefault()}return false}}};this.all_shortcuts[b]={callback:e,target:f,event:d.type};if(f.addEventListener){f.addEventListener(d.type,e,false)}else{if(f.attachEvent){f.attachEvent("on"+d.type,e)}else{f["on"+d.type]=e}}},remove:function(a){a=a.toLowerCase();var d=this.all_shortcuts[a];delete (this.all_shortcuts[a]);if(!d){return}var b=d.event;var c=d.target;var e=d.callback;if(c.detachEvent){c.detachEvent("on"+b,e)}else{if(c.removeEventListener){c.removeEventListener(b,e,false)}else{c["on"+b]=false}}}};(function(d){d.fn.tabby=function(f){var g=d.extend({},d.fn.tabby.defaults,f);var h=d.fn.tabby.pressed;return this.each(function(){$this=d(this);var i=d.meta?d.extend({},g,$this.data()):g;$this.bind("keydown",function(l){var j=d.fn.tabby.catch_kc(l);if(16==j){h.shft=true}if(17==j){h.ctrl=true;setTimeout("$.fn.tabby.pressed.ctrl = false;",1000)}if(18==j){h.alt=true;setTimeout("$.fn.tabby.pressed.alt = false;",1000)}if(9==j&&!h.ctrl&&!h.alt){l.preventDefault;h.last=j;setTimeout("$.fn.tabby.pressed.last = null;",0);e(d(l.target).get(0),h.shft,i);return false}}).bind("keyup",function(j){if(16==d.fn.tabby.catch_kc(j)){h.shft=false}}).bind("blur",function(j){if(9==h.last){d(j.target).one("focus",function(l){h.last=null}).get(0).focus()}})})};d.fn.tabby.catch_kc=function(f){return f.keyCode?f.keyCode:f.charCode?f.charCode:f.which};d.fn.tabby.pressed={shft:false,ctrl:false,alt:false,last:null};function b(f){if(window.console&&window.console.log){window.console.log("textarea count: "+f.size())}}function e(i,h,g){var f=i.scrollTop;if(i.setSelectionRange){a(i,h,g)}else{if(document.selection){c(i,h,g)}}i.scrollTop=f}d.fn.tabby.defaults={tabString:String.fromCharCode(9)};function a(j,f,v){var u=j.selectionStart;var s=j.selectionEnd;if(u==s){if(f){if("\t"==j.value.substring(u-v.tabString.length,u)){j.value=j.value.substring(0,u-v.tabString.length)+j.value.substring(u);j.focus();j.setSelectionRange(u-v.tabString.length,u-v.tabString.length)}else{if("\t"==j.value.substring(u,u+v.tabString.length)){j.value=j.value.substring(0,u)+j.value.substring(u+v.tabString.length);j.focus();j.setSelectionRange(u,u)}}}else{j.value=j.value.substring(0,u)+v.tabString+j.value.substring(u);j.focus();j.setSelectionRange(u+v.tabString.length,u+v.tabString.length)}}else{var w=j.value.split("\n");var t=new Array();var m=0;var h=0;var g=false;for(var p in w){h=m+w[p].length;t.push({start:m,end:h,selected:(m<=u&&h>u)||(h>=s&&m<s)||(m>u&&h<s)});m=h+1}var l=0;for(var p in t){if(t[p].selected){var r=t[p].start+l;if(f&&v.tabString==j.value.substring(r,r+v.tabString.length)){j.value=j.value.substring(0,r)+j.value.substring(r+v.tabString.length);l-=v.tabString.length}else{if(!f){j.value=j.value.substring(0,r)+v.tabString+j.value.substring(r);l+=v.tabString.length}}}}j.focus();var q=u+((l>0)?v.tabString.length:(l<0)?-v.tabString.length:0);var n=s+l;j.setSelectionRange(q,n)}}function c(r,x,f){var q=document.selection.createRange();if(r==q.parentElement()){if(""==q.text){if(x){var m=q.getBookmark();q.moveStart("character",-f.tabString.length);if(f.tabString==q.text){q.text=""}else{q.moveToBookmark(m);q.moveEnd("character",f.tabString.length);if(f.tabString==q.text){q.text=""}}q.collapse(true);q.select()}else{q.text=f.tabString;q.collapse(false);q.select()}}else{var l=q.text;var p=l.length;var v=l.split("\r\n");var A=document.body.createTextRange();A.moveToElementText(r);A.setEndPoint("EndToStart",q);var n=A.text;var y=n.split("\r\n");var s=n.length;var z=document.body.createTextRange();z.moveToElementText(r);z.setEndPoint("StartToEnd",q);var w=z.text;var g=document.body.createTextRange();g.moveToElementText(r);g.setEndPoint("StartToEnd",A);var t=g.text;var h=d(r).html();d("#r3").text(s+" + "+p+" + "+w.length+" = "+h.length);if((s+t.length)<h.length){y.push("");s+=2;if(x&&f.tabString==v[0].substring(0,f.tabString.length)){v[0]=v[0].substring(f.tabString.length)}else{if(!x){v[0]=f.tabString+v[0]}}}else{if(x&&f.tabString==y[y.length-1].substring(0,f.tabString.length)){y[y.length-1]=y[y.length-1].substring(f.tabString.length)}else{if(!x){y[y.length-1]=f.tabString+y[y.length-1]}}}for(var u=1;u<v.length;u++){if(x&&f.tabString==v[u].substring(0,f.tabString.length)){v[u]=v[u].substring(f.tabString.length)}else{if(!x){v[u]=f.tabString+v[u]}}}if(1==y.length&&0==s){if(x&&f.tabString==v[0].substring(0,f.tabString.length)){v[0]=v[0].substring(f.tabString.length)}else{if(!x){v[0]=f.tabString+v[0]}}}if((s+p+w.length)<h.length){v.push("");p+=2}A.text=y.join("\r\n");q.text=v.join("\r\n");var j=document.body.createTextRange();j.moveToElementText(r);if(0<s){j.setEndPoint("StartToEnd",A)}else{j.setEndPoint("StartToStart",A)}j.setEndPoint("EndToEnd",q);j.select()}}}})(jQuery);(function(){if(!Array.prototype.indexOf){Array.prototype.indexOf=function(J){if(this==null){throw new TypeError()}var K=Object(this);var f=K.length>>>0;if(f===0){return -1}var L=0;if(arguments.length>0){L=Number(arguments[1]);if(L!=L){L=0}else{if(L!=0&&L!=Infinity&&L!=-Infinity){L=(L>0||-1)*Math.floor(Math.abs(L))}}}if(L>=f){return -1}var o=L>=0?L:Math.max(f-Math.abs(L),0);for(;o<f;o++){if(o in K&&K[o]===J){return o}}return -1}}var A=this,i=A.jQuery,r={},c={},y,v=0,q=[];if(typeof module!=="undefined"&&module.exports){module.exports=r}else{if(i){i.i18n=i.i18n||r}A.i18n=A.i18n||r}var z={lng:undefined,load:"all",preload:[],lowerCaseLng:false,returnObjectTrees:false,fallbackLng:"dev",ns:"translation",nsseparator:":",keyseparator:".",debug:false,resGetPath:"locales/__lng__/__ns__.json",resPostPath:"locales/add/__lng__/__ns__",getAsync:true,postAsync:true,resStore:undefined,useLocalStorage:false,localStorageExpirationTime:7*24*60*60*1000,dynamicLoad:false,sendMissing:false,sendMissingTo:"fallback",sendType:"POST",interpolationPrefix:"__",interpolationSuffix:"__",reusePrefix:"$t(",reuseSuffix:")",pluralSuffix:"_plural",pluralNotFound:["plural_not_found",Math.random()].join(""),contextNotFound:["context_not_found",Math.random()].join(""),setJqueryExt:true,useDataAttrOptions:false,cookieExpirationTime:undefined,postProcess:undefined};function j(J,o){if(!o||typeof o==="function"){return J}for(var f in o){J[f]=o[f]}return J}function C(K,N,J){var o,L=0,M=K.length,f=M===undefined||typeof K==="function";if(J){if(f){for(o in K){if(N.apply(K[o],J)===false){break}}}else{for(;L<M;){if(N.apply(K[L++],J)===false){break}}}}else{if(f){for(o in K){if(N.call(K[o],o,K[o])===false){break}}}else{for(;L<M;){if(N.call(K[L],L,K[L++])===false){break}}}}return K}function e(P){var J=function(R){if(window.XMLHttpRequest){return R(null,new XMLHttpRequest())}else{if(window.ActiveXObject){try{return R(null,new ActiveXObject("Msxml2.XMLHTTP"))}catch(Q){return R(null,new ActiveXObject("Microsoft.XMLHTTP"))}}}return R(new Error())};var f=function(S){if(typeof S==="string"){return S}var Q=[];for(var R in S){if(S.hasOwnProperty(R)){Q.push(encodeURIComponent(R)+"="+encodeURIComponent(S[R]))}}return Q.join("&")};var M=function(S){S=S.replace(/\r\n/g,"\n");var Q="";for(var R=0;R<S.length;R++){var T=S.charCodeAt(R);if(T<128){Q+=String.fromCharCode(T)}else{if((T>127)&&(T<2048)){Q+=String.fromCharCode((T>>6)|192);Q+=String.fromCharCode((T&63)|128)}else{Q+=String.fromCharCode((T>>12)|224);Q+=String.fromCharCode(((T>>6)&63)|128);Q+=String.fromCharCode((T&63)|128)}}}return Q};var K=function(U){var Q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";U=M(U);var aa="",Z,X,V,Y,W,T,S,R=0;do{Z=U.charCodeAt(R++);X=U.charCodeAt(R++);V=U.charCodeAt(R++);Y=Z>>2;W=((Z&3)<<4)|(X>>4);T=((X&15)<<2)|(V>>6);S=V&63;if(isNaN(X)){T=S=64}else{if(isNaN(V)){S=64}}aa+=Q.charAt(Y)+Q.charAt(W)+Q.charAt(T)+Q.charAt(S);Z=X=V="";Y=W=T=S=""}while(R<U.length);return aa};var o=function(){var Q=arguments[0];for(var R=1;R<arguments.length;R++){var S=arguments[R];for(var T in S){if(S.hasOwnProperty(T)){Q[T]=S[T]}}}return Q};var L=function(Q,S,Y,X){if(typeof Y==="function"){X=Y;Y={}}Y.cache=Y.cache||false;Y.data=Y.data||{};Y.headers=Y.headers||{};Y.jsonp=Y.jsonp||false;Y.async=Y.async===undefined?true:Y.async;var T=o({accept:"*/*","content-type":"application/x-www-form-urlencoded;charset=UTF-8"},L.headers,Y.headers);var W;if(T["content-type"]==="application/json"){W=JSON.stringify(Y.data)}else{W=f(Y.data)}if(Q==="GET"){var R=[];if(W){R.push(W);W=null}if(!Y.cache){R.push("_="+(new Date()).getTime())}if(Y.jsonp){R.push("callback="+Y.jsonp);R.push("jsonp="+Y.jsonp)}R="?"+R.join("&");S+=R!=="?"?R:"";if(Y.jsonp){var V=document.getElementsByTagName("head")[0];var U=document.createElement("script");U.type="text/javascript";U.src=S;V.appendChild(U);return}}J(function(Z,aa){if(Z){return X(Z)}aa.open(Q,S,Y.async);for(var ab in T){if(T.hasOwnProperty(ab)){aa.setRequestHeader(ab,T[ab])}}aa.onreadystatechange=function(){if(aa.readyState===4){var ac=aa.responseText||"";if(!X){return}X(aa.status,{text:function(){return ac},json:function(){return JSON.parse(ac)}})}};aa.send(W)})};var O={authBasic:function(R,Q){L.headers.Authorization="Basic "+K(R+":"+Q)},connect:function(R,Q,S){return L("CONNECT",R,Q,S)},del:function(R,Q,S){return L("DELETE",R,Q,S)},get:function(R,Q,S){return L("GET",R,Q,S)},head:function(R,Q,S){return L("HEAD",R,Q,S)},headers:function(Q){L.headers=Q||{}},isAllowed:function(Q,R,S){this.options(Q,function(T,U){S(U.text().indexOf(R)!==-1)})},options:function(R,Q,S){return L("OPTIONS",R,Q,S)},patch:function(R,Q,S){return L("PATCH",R,Q,S)},post:function(R,Q,S){return L("POST",R,Q,S)},put:function(R,Q,S){return L("PUT",R,Q,S)},trace:function(R,Q,S){return L("TRACE",R,Q,S)}};var N=P.sendType?P.sendType.toLowerCase():"get";O[N](P.url,{async:P.async},function(Q,R){if(Q===200){P.success(R.json(),Q,null)}else{P.error(R.text(),Q,null)}})}var l={create:function(J,L,K){var f;if(K){var o=new Date();o.setTime(o.getTime()+(K*60*1000));f="; expires="+o.toGMTString()}else{f=""}document.cookie=J+"="+L+f+"; path=/"},read:function(o){var K=o+"=";var f=document.cookie.split(";");for(var J=0;J<f.length;J++){var L=f[J];while(L.charAt(0)==" "){L=L.substring(1,L.length)}if(L.indexOf(K)===0){return L.substring(K.length,L.length)}}return null},remove:function(f){this.create(f,"",-1)}};var g={create:function(f,J,o){},read:function(f){return null},remove:function(f){}};var F={extend:i?i.extend:j,each:i?i.each:C,ajax:i?i.ajax:e,cookie:typeof document!=="undefined"?l:g,detectLanguage:s,log:function(f){if(z.debug){console.log(f)}},toLanguages:function(f){var J=[];if(f.indexOf("-")===2&&f.length===5){var o=f.split("-");f=z.lowerCaseLng?o[0].toLowerCase()+"-"+o[1].toLowerCase():o[0].toLowerCase()+"-"+o[1].toUpperCase();if(z.load!=="unspecific"){J.push(f)}if(z.load!=="current"){J.push(f.substr(0,2))}}else{J.push(f)}if(J.indexOf(z.fallbackLng)===-1&&z.fallbackLng){J.push(z.fallbackLng)}return J}};function B(P,J){if(typeof P==="function"){J=P;P={}}P=P||{};F.extend(z,P);if(typeof z.ns=="string"){z.ns={namespaces:[z.ns],defaultNs:z.ns}}if(!z.lng){z.lng=F.detectLanguage()}if(z.lng){F.cookie.create("i18next",z.lng,z.cookieExpirationTime)}else{z.lng=z.fallbackLng;F.cookie.remove("i18next")}q=F.toLanguages(z.lng);y=q[0];F.log("currentLng set to: "+y);D.setCurrentLng(y);if(i&&z.setJqueryExt){E()}var O;if(i&&i.Deferred){O=i.Deferred()}if(z.resStore){c=z.resStore;if(J){J(t)}if(O){O.resolve()}return O}var f=F.toLanguages(z.lng);if(typeof z.preload==="string"){z.preload=[z.preload]}for(var L=0,o=z.preload.length;L<o;L++){var K=F.toLanguages(z.preload[L]);for(var N=0,M=K.length;N<M;N++){if(f.indexOf(K[N])<0){f.push(K[N])}}}r.sync.load(f,z,function(R,Q){c=Q;if(J){J(t)}if(O){O.resolve()}});return O}function u(K,f){if(typeof K==="string"){K=[K]}for(var J=0,o=K.length;J<o;J++){if(z.preload.indexOf(K[J])<0){z.preload.push(K[J])}}return B(f)}function a(o,f){return B({lng:o},f)}function I(){return y}function E(){i.t=i.t||t;function o(N,M,L){if(M.length===0){return}var J="text";if(M.indexOf("[")===0){var O=M.split("]");M=O[1];J=O[0].substr(1,O[0].length-1)}if(M.indexOf(";")===M.length-1){M=M.substr(0,M.length-2)}var K;if(J==="html"){K=i.extend({defaultValue:N.html()},L);N.html(i.t(M,K))}else{if(J==="text"){K=i.extend({defaultValue:N.text()},L);N.text(i.t(M,K))}else{K=i.extend({defaultValue:N.attr(J)},L);N.attr(J,i.t(M,K))}}}function f(M,J){var K=M.attr("data-i18n");if(!K){return}if(!J&&z.useDataAttrOptions===true){J=M.data("i18n-options")}J=J||{};if(K.indexOf(";")<=K.length-1){var L=K.split(";");i.each(L,function(N,O){o(M,O,J)})}else{o(M,k,J)}if(z.useDataAttrOptions===true){M.data("i18n-options",J)}}i.fn.i18n=function(J){return this.each(function(){f(i(this),J);var K=i(this).find("[data-i18n]");K.each(function(){f(i(this),J)})})}}function b(J,o,f){if(J.indexOf(z.interpolationPrefix)<0){return J}F.each(o,function(K,L){if(typeof L==="object"){J=b(J,L,K)}else{J=J.replace(new RegExp([z.interpolationPrefix,f?f+"."+K:K,z.interpolationSuffix].join(""),"g"),L)}});return J}function h(N,J){var M=F.extend({},J);delete M.postProcess;while(N.indexOf(z.reusePrefix)!=-1){v++;if(v>z.maxRecursion){break}var O=N.indexOf(z.reusePrefix);var L=N.indexOf(z.reuseSuffix,O)+z.reuseSuffix.length;var K=N.substring(O,L);var f=K.replace(z.reusePrefix,"").replace(z.reuseSuffix,"");var o=G(f,M);N=N.replace(K,o)}return N}function m(f){return(f.context&&typeof f.context=="string")}function w(f){return(f.count!==undefined&&typeof f.count!="string"&&f.count!==1)}function t(o,f){v=0;return G(o,f)}function G(aa,K){K=K||{};var f,W,o=K.defaultValue||aa,Q=q;if(K.lng){Q=F.toLanguages(K.lng);if(!c[Q[0]]){var J=z.getAsync;z.getAsync=false;r.sync.load(Q,z,function(ad,ac){F.extend(c,ac);z.getAsync=J})}}if(!c){return o}var ab=z.ns.defaultNs;if(aa.indexOf(z.nsseparator)>-1){var R=aa.split(z.nsseparator);ab=R[0];aa=R[1]}if(m(K)){f=F.extend({},K);delete f.context;f.defaultValue=z.contextNotFound;var L=ab+":"+aa+"_"+K.context;W=t(L,f);if(W!=z.contextNotFound){return b(W,{context:K.context})}}if(w(K)){f=F.extend({},K);delete f.count;f.defaultValue=z.pluralNotFound;var N=ab+":"+aa+z.pluralSuffix;var Z=D.get(y,K.count);if(Z>=0){N=N+"_"+Z}else{if(Z===1){N=ab+":"+aa}}W=t(N,f);if(W!=z.pluralNotFound){return b(W,{count:K.count})}}var O;var P=aa.split(z.keyseparator);for(var X=0,Y=Q.length;X<Y;X++){if(O){break}var V=Q[X];var M=0;var U=c[V]&&c[V][ab];while(P[M]){U=U&&U[P[M]];M++}if(U){if(typeof U==="string"){U=b(U,K);U=h(U,K)}else{if(Object.prototype.toString.apply(U)==="[object Array]"&&!z.returnObjectTrees&&!K.returnObjectTrees){U=U.join("\n");U=b(U,K);U=h(U,K)}else{if(!z.returnObjectTrees&&!K.returnObjectTrees){U="key '"+ab+":"+aa+" ("+V+")' returned a object instead of string.";F.log(U)}else{for(var T in U){U[T]=G(aa+"."+T,K)}}}}O=U}}if(!O&&z.sendMissing){if(K.lng){n.postMissing(K.lng,ab,aa,o,Q)}else{n.postMissing(z.lng,ab,aa,o,Q)}}var S=K.postProcess||z.postProcess;if(O&&S){if(x[S]){O=x[S](O,aa,K)}}if(!O){o=b(o,K);o=h(o,K)}return(O)?O:o}function s(){var o;var f=[];if(typeof window!=="undefined"){(function(){var N=window.location.search.substring(1);var M=N.split("&");for(var L=0;L<M.length;L++){var P=M[L].indexOf("=");if(P>0){var K=M[L].substring(0,P);var O=M[L].substring(P+1);f[K]=O}}})();if(f.setLng){o=f.setLng}}if(!o&&typeof document!=="undefined"){var J=F.cookie.read("i18next");if(J){o=J}}if(!o&&typeof navigator!=="undefined"){o=(navigator.language)?navigator.language:navigator.userLanguage}return o}var n={load:function(J,o,f){if(o.useLocalStorage){n._loadLocal(J,o,function(O,L){var N=[];for(var M=0,K=J.length;M<K;M++){if(!L[J[M]]){N.push(J[M])}}if(N.length>0){n._fetch(N,o,function(P,Q){F.extend(L,Q);n._storeLocal(Q);f(null,L)})}else{f(null,L)}})}else{n._fetch(J,o,function(L,K){f(null,K)})}},_loadLocal:function(L,K,o){var J={},M=new Date().getTime();if(window.localStorage){var f=L.length;F.each(L,function(P,N){var O=window.localStorage.getItem("res_"+N);if(O){O=JSON.parse(O);if(O.i18nStamp&&O.i18nStamp+K.localStorageExpirationTime>M){J[N]=O}}f--;if(f===0){o(null,J)}})}},_storeLocal:function(o){if(window.localStorage){for(var f in o){o[f].i18nStamp=new Date().getTime();window.localStorage.setItem("res_"+f,JSON.stringify(o[f]))}}return},_fetch:function(N,L,o){var M=L.ns,J={};if(!L.dynamicLoad){var f=M.namespaces.length*N.length,O;F.each(M.namespaces,function(Q,P){F.each(N,function(R,S){n._fetchOne(S,P,L,function(T,U){if(T){O=O||[];O.push(T)}J[S]=J[S]||{};J[S][P]=U;f--;if(f===0){o(O,J)}})})})}else{var K=b(L.resGetPath,{lng:N.join("+"),ns:M.namespaces.join("+")});F.ajax({url:K,success:function(Q,P,R){F.log("loaded: "+K);o(null,Q)},error:function(R,P,Q){F.log("failed loading: "+K);o("failed loading resource.json error: "+Q)},dataType:"json",async:L.getAsync})}},_fetchOne:function(K,L,J,f){var o=b(J.resGetPath,{lng:K,ns:L});F.ajax({url:o,success:function(N,M,O){F.log("loaded: "+o);f(null,N)},error:function(O,M,N){F.log("failed loading: "+o);f(N,{})},dataType:"json",async:J.getAsync})},postMissing:function(O,N,Q,L,R){var P={};P[Q]=L;var K=[];if(z.sendMissingTo==="fallback"){K.push({lng:z.fallbackLng,url:b(z.resPostPath,{lng:z.fallbackLng,ns:N})})}else{if(z.sendMissingTo==="current"){K.push({lng:O,url:b(z.resPostPath,{lng:O,ns:N})})}else{if(z.sendMissingTo==="all"){for(var o=0,f=R.length;o<f;o++){K.push({lng:R[o],url:b(z.resPostPath,{lng:R[o],ns:N})})}}}}for(var M=0,J=K.length;M<J;M++){var S=K[M];F.ajax({url:S.url,type:z.sendType,data:P,success:function(U,T,V){F.log("posted missing key '"+Q+"' to: "+S.url);c[S.lng][N][Q]=L},error:function(V,T,U){F.log("failed posting missing key '"+Q+"' to: "+S.url)},dataType:"json",async:z.postAsync})}}};var D={rules:{ach:{name:"Acholi",numbers:[1,2],plurals:function(f){return Number(f>1)}},af:{name:"Afrikaans",numbers:[2,1],plurals:function(f){return Number(f!=1)}},ak:{name:"Akan",numbers:[1,2],plurals:function(f){return Number(f>1)}},am:{name:"Amharic",numbers:[1,2],plurals:function(f){return Number(f>1)}},an:{name:"Aragonese",numbers:[2,1],plurals:function(f){return Number(f!=1)}},ar:{name:"Arabic",numbers:[0,1,2,3,11,100],plurals:function(f){return Number(f===0?0:f==1?1:f==2?2:f%100>=3&&f%100<=10?3:f%100>=11?4:5)}},arn:{name:"Mapudungun",numbers:[1,2],plurals:function(f){return Number(f>1)}},ast:{name:"Asturian",numbers:[2,1],plurals:function(f){return Number(f!=1)}},ay:{name:"Aymar\u00e1",numbers:[1],plurals:function(f){return 0}},az:{name:"Azerbaijani",numbers:[2,1],plurals:function(f){return Number(f!=1)}},be:{name:"Belarusian",numbers:[5,1,2],plurals:function(f){return Number(f%10==1&&f%100!=11?0:f%10>=2&&f%10<=4&&(f%100<10||f%100>=20)?1:2)}},bg:{name:"Bulgarian",numbers:[2,1],plurals:function(f){return Number(f!=1)}},bn:{name:"Bengali",numbers:[2,1],plurals:function(f){return Number(f!=1)}},bo:{name:"Tibetan",numbers:[1],plurals:function(f){return 0}},br:{name:"Breton",numbers:[1,2],plurals:function(f){return Number(f>1)}},bs:{name:"Bosnian",numbers:[5,1,2],plurals:function(f){return Number(f%10==1&&f%100!=11?0:f%10>=2&&f%10<=4&&(f%100<10||f%100>=20)?1:2)}},ca:{name:"Catalan",numbers:[2,1],plurals:function(f){return Number(f!=1)}},cgg:{name:"Chiga",numbers:[1],plurals:function(f){return 0}},cs:{name:"Czech",numbers:[5,1,2],plurals:function(f){return Number((f==1)?0:(f>=2&&f<=4)?1:2)}},csb:{name:"Kashubian",numbers:[5,1,2],plurals:function(f){return Number(f==1?0:f%10>=2&&f%10<=4&&(f%100<10||f%100>=20)?1:2)}},cy:{name:"Welsh",numbers:[3,1,2,8],plurals:function(f){return Number((f==1)?0:(f==2)?1:(f!=8&&f!=11)?2:3)}},da:{name:"Danish",numbers:[2,1],plurals:function(f){return Number(f!=1)}},de:{name:"German",numbers:[2,1],plurals:function(f){return Number(f!=1)}},dz:{name:"Dzongkha",numbers:[1],plurals:function(f){return 0}},el:{name:"Greek",numbers:[2,1],plurals:function(f){return Number(f!=1)}},en:{name:"English",numbers:[2,1],plurals:function(f){return Number(f!=1)}},eo:{name:"Esperanto",numbers:[2,1],plurals:function(f){return Number(f!=1)}},es:{name:"Spanish",numbers:[2,1],plurals:function(f){return Number(f!=1)}},es_ar:{name:"Argentinean Spanish",numbers:[2,1],plurals:function(f){return Number(f!=1)}},et:{name:"Estonian",numbers:[2,1],plurals:function(f){return Number(f!=1)}},eu:{name:"Basque",numbers:[2,1],plurals:function(f){return Number(f!=1)}},fa:{name:"Persian",numbers:[1],plurals:function(f){return 0}},fi:{name:"Finnish",numbers:[2,1],plurals:function(f){return Number(f!=1)}},fil:{name:"Filipino",numbers:[1,2],plurals:function(f){return Number(f>1)}},fo:{name:"Faroese",numbers:[2,1],plurals:function(f){return Number(f!=1)}},fr:{name:"French",numbers:[1,2],plurals:function(f){return Number(f>1)}},fur:{name:"Friulian",numbers:[2,1],plurals:function(f){return Number(f!=1)}},fy:{name:"Frisian",numbers:[2,1],plurals:function(f){return Number(f!=1)}},ga:{name:"Irish",numbers:[3,1,2,7,11],plurals:function(f){return Number(f==1?0:f==2?1:f<7?2:f<11?3:4)}},gd:{name:"Scottish Gaelic",numbers:[20,1,2,3],plurals:function(f){return Number((f==1||f==11)?0:(f==2||f==12)?1:(f>2&&f<20)?2:3)}},gl:{name:"Galician",numbers:[2,1],plurals:function(f){return Number(f!=1)}},gu:{name:"Gujarati",numbers:[2,1],plurals:function(f){return Number(f!=1)}},gun:{name:"Gun",numbers:[1,2],plurals:function(f){return Number(f>1)}},ha:{name:"Hausa",numbers:[2,1],plurals:function(f){return Number(f!=1)}},he:{name:"Hebrew",numbers:[2,1],plurals:function(f){return Number(f!=1)}},hi:{name:"Hindi",numbers:[2,1],plurals:function(f){return Number(f!=1)}},hr:{name:"Croatian",numbers:[5,1,2],plurals:function(f){return Number(f%10==1&&f%100!=11?0:f%10>=2&&f%10<=4&&(f%100<10||f%100>=20)?1:2)}},hu:{name:"Hungarian",numbers:[2,1],plurals:function(f){return Number(f!=1)}},hy:{name:"Armenian",numbers:[2,1],plurals:function(f){return Number(f!=1)}},ia:{name:"Interlingua",numbers:[2,1],plurals:function(f){return Number(f!=1)}},id:{name:"Indonesian",numbers:[1],plurals:function(f){return 0}},is:{name:"Icelandic",numbers:[2,1],plurals:function(f){return Number(f%10!=1||f%100==11)}},it:{name:"Italian",numbers:[2,1],plurals:function(f){return Number(f!=1)}},ja:{name:"Japanese",numbers:[1],plurals:function(f){return 0}},jbo:{name:"Lojban",numbers:[1],plurals:function(f){return 0}},jv:{name:"Javanese",numbers:[0,1],plurals:function(f){return Number(f!==0)}},ka:{name:"Georgian",numbers:[1],plurals:function(f){return 0}},kk:{name:"Kazakh",numbers:[1],plurals:function(f){return 0}},km:{name:"Khmer",numbers:[1],plurals:function(f){return 0}},kn:{name:"Kannada",numbers:[2,1],plurals:function(f){return Number(f!=1)}},ko:{name:"Korean",numbers:[1],plurals:function(f){return 0}},ku:{name:"Kurdish",numbers:[2,1],plurals:function(f){return Number(f!=1)}},kw:{name:"Cornish",numbers:[4,1,2,3],plurals:function(f){return Number((f==1)?0:(f==2)?1:(f==3)?2:3)}},ky:{name:"Kyrgyz",numbers:[1],plurals:function(f){return 0}},lb:{name:"Letzeburgesch",numbers:[2,1],plurals:function(f){return Number(f!=1)}},ln:{name:"Lingala",numbers:[1,2],plurals:function(f){return Number(f>1)}},lo:{name:"Lao",numbers:[1],plurals:function(f){return 0}},lt:{name:"Lithuanian",numbers:[10,1,2],plurals:function(f){return Number(f%10==1&&f%100!=11?0:f%10>=2&&(f%100<10||f%100>=20)?1:2)}},lv:{name:"Latvian",numbers:[0,1,2],plurals:function(f){return Number(f%10==1&&f%100!=11?0:f!==0?1:2)}},mai:{name:"Maithili",numbers:[2,1],plurals:function(f){return Number(f!=1)}},mfe:{name:"Mauritian Creole",numbers:[1,2],plurals:function(f){return Number(f>1)}},mg:{name:"Malagasy",numbers:[1,2],plurals:function(f){return Number(f>1)}},mi:{name:"Maori",numbers:[1,2],plurals:function(f){return Number(f>1)}},mk:{name:"Macedonian",numbers:[2,1],plurals:function(f){return Number(f==1||f%10==1?0:1)}},ml:{name:"Malayalam",numbers:[2,1],plurals:function(f){return Number(f!=1)}},mn:{name:"Mongolian",numbers:[2,1],plurals:function(f){return Number(f!=1)}},mnk:{name:"Mandinka",numbers:[0,1,2],plurals:function(f){return Number(0?0:f==1?1:2)}},mr:{name:"Marathi",numbers:[2,1],plurals:function(f){return Number(f!=1)}},ms:{name:"Malay",numbers:[1],plurals:function(f){return 0}},mt:{name:"Maltese",numbers:[2,1,11,20],plurals:function(f){return Number(f==1?0:f===0||(f%100>1&&f%100<11)?1:(f%100>10&&f%100<20)?2:3)}},nah:{name:"Nahuatl",numbers:[2,1],plurals:function(f){return Number(f!=1)}},nap:{name:"Neapolitan",numbers:[2,1],plurals:function(f){return Number(f!=1)}},nb:{name:"Norwegian Bokmal",numbers:[2,1],plurals:function(f){return Number(f!=1)}},ne:{name:"Nepali",numbers:[2,1],plurals:function(f){return Number(f!=1)}},nl:{name:"Dutch",numbers:[2,1],plurals:function(f){return Number(f!=1)}},nn:{name:"Norwegian Nynorsk",numbers:[2,1],plurals:function(f){return Number(f!=1)}},no:{name:"Norwegian",numbers:[2,1],plurals:function(f){return Number(f!=1)}},nso:{name:"Northern Sotho",numbers:[2,1],plurals:function(f){return Number(f!=1)}},oc:{name:"Occitan",numbers:[1,2],plurals:function(f){return Number(f>1)}},or:{name:"Oriya",numbers:[2,1],plurals:function(f){return Number(f!=1)}},pa:{name:"Punjabi",numbers:[2,1],plurals:function(f){return Number(f!=1)}},pap:{name:"Papiamento",numbers:[2,1],plurals:function(f){return Number(f!=1)}},pl:{name:"Polish",numbers:[5,1,2],plurals:function(f){return Number(f==1?0:f%10>=2&&f%10<=4&&(f%100<10||f%100>=20)?1:2)}},pms:{name:"Piemontese",numbers:[2,1],plurals:function(f){return Number(f!=1)}},ps:{name:"Pashto",numbers:[2,1],plurals:function(f){return Number(f!=1)}},pt:{name:"Portuguese",numbers:[2,1],plurals:function(f){return Number(f!=1)}},pt_br:{name:"Brazilian Portuguese",numbers:[2,1],plurals:function(f){return Number(f!=1)}},rm:{name:"Romansh",numbers:[2,1],plurals:function(f){return Number(f!=1)}},ro:{name:"Romanian",numbers:[2,1,20],plurals:function(f){return Number(f==1?0:(f===0||(f%100>0&&f%100<20))?1:2)}},ru:{name:"Russian",numbers:[5,1,2],plurals:function(f){return Number(f%10==1&&f%100!=11?0:f%10>=2&&f%10<=4&&(f%100<10||f%100>=20)?1:2)}},sah:{name:"Yakut",numbers:[1],plurals:function(f){return 0}},sco:{name:"Scots",numbers:[2,1],plurals:function(f){return Number(f!=1)}},se:{name:"Northern Sami",numbers:[2,1],plurals:function(f){return Number(f!=1)}},si:{name:"Sinhala",numbers:[2,1],plurals:function(f){return Number(f!=1)}},sk:{name:"Slovak",numbers:[5,1,2],plurals:function(f){return Number((f==1)?0:(f>=2&&f<=4)?1:2)}},sl:{name:"Slovenian",numbers:[5,1,2,3],plurals:function(f){return Number(f%100==1?1:f%100==2?2:f%100==3||f%100==4?3:0)}},so:{name:"Somali",numbers:[2,1],plurals:function(f){return Number(f!=1)}},son:{name:"Songhay",numbers:[2,1],plurals:function(f){return Number(f!=1)}},sq:{name:"Albanian",numbers:[2,1],plurals:function(f){return Number(f!=1)}},sr:{name:"Serbian",numbers:[5,1,2],plurals:function(f){return Number(f%10==1&&f%100!=11?0:f%10>=2&&f%10<=4&&(f%100<10||f%100>=20)?1:2)}},su:{name:"Sundanese",numbers:[1],plurals:function(f){return 0}},sv:{name:"Swedish",numbers:[2,1],plurals:function(f){return Number(f!=1)}},sw:{name:"Swahili",numbers:[2,1],plurals:function(f){return Number(f!=1)}},ta:{name:"Tamil",numbers:[2,1],plurals:function(f){return Number(f!=1)}},te:{name:"Telugu",numbers:[2,1],plurals:function(f){return Number(f!=1)}},tg:{name:"Tajik",numbers:[1,2],plurals:function(f){return Number(f>1)}},th:{name:"Thai",numbers:[1],plurals:function(f){return 0}},ti:{name:"Tigrinya",numbers:[1,2],plurals:function(f){return Number(f>1)}},tk:{name:"Turkmen",numbers:[2,1],plurals:function(f){return Number(f!=1)}},tr:{name:"Turkish",numbers:[1,2],plurals:function(f){return Number(f>1)}},tt:{name:"Tatar",numbers:[1],plurals:function(f){return 0}},ug:{name:"Uyghur",numbers:[1],plurals:function(f){return 0}},uk:{name:"Ukrainian",numbers:[5,1,2],plurals:function(f){return Number(f%10==1&&f%100!=11?0:f%10>=2&&f%10<=4&&(f%100<10||f%100>=20)?1:2)}},ur:{name:"Urdu",numbers:[2,1],plurals:function(f){return Number(f!=1)}},uz:{name:"Uzbek",numbers:[1,2],plurals:function(f){return Number(f>1)}},vi:{name:"Vietnamese",numbers:[1],plurals:function(f){return 0}},wa:{name:"Walloon",numbers:[1,2],plurals:function(f){return Number(f>1)}},wo:{name:"Wolof",numbers:[1],plurals:function(f){return 0}},yo:{name:"Yoruba",numbers:[2,1],plurals:function(f){return Number(f!=1)}},zh:{name:"Chinese",numbers:[1],plurals:function(f){return 0}}},addRule:function(f,o){D.rules[f]=o},setCurrentLng:function(f){if(!D.currentRule||D.currentRule.lng!==f){var o=f.split("-");D.currentRule={lng:f,rule:D.rules[o[0]]}}},get:function(f,o){var J=f.split("-");function K(L,P){var N;if(D.currentRule&&D.currentRule.lng===f){N=D.currentRule.rule}else{N=D.rules[L]}if(N){var M=N.plurals(P);var O=N.numbers[M];if(N.numbers.length===2){if(O===2){O=1}else{if(O===1){O=-1}}}return O}else{return P===1?"1":"-1"}}return K(J[0],o)}};var x={};var d=function(f,o){x[f]=o};var p=(function(){function f(K){return Object.prototype.toString.call(K).slice(8,-1).toLowerCase()}function o(L,M){for(var K=[];M>0;K[--M]=L){}return K.join("")}var J=function(){if(!J.cache.hasOwnProperty(arguments[0])){J.cache[arguments[0]]=J.parse(arguments[0])}return J.format.call(null,J.cache[arguments[0]],arguments)};J.format=function(R,Q){var V=1,T=R.length,N="",W,K=[],O,M,P,L,S,U;for(O=0;O<T;O++){N=f(R[O]);if(N==="string"){K.push(R[O])}else{if(N==="array"){P=R[O];if(P[2]){W=Q[V];for(M=0;M<P[2].length;M++){if(!W.hasOwnProperty(P[2][M])){throw (p('[sprintf] property "%s" does not exist',P[2][M]))}W=W[P[2][M]]}}else{if(P[1]){W=Q[P[1]]}else{W=Q[V++]}}if(/[^s]/.test(P[8])&&(f(W)!="number")){throw (p("[sprintf] expecting number but found %s",f(W)))}switch(P[8]){case"b":W=W.toString(2);break;case"c":W=String.fromCharCode(W);break;case"d":W=parseInt(W,10);break;case"e":W=P[7]?W.toExponential(P[7]):W.toExponential();break;case"f":W=P[7]?parseFloat(W).toFixed(P[7]):parseFloat(W);break;case"o":W=W.toString(8);break;case"s":W=((W=String(W))&&P[7]?W.substring(0,P[7]):W);break;case"u":W=Math.abs(W);break;case"x":W=W.toString(16);break;case"X":W=W.toString(16).toUpperCase();break}W=(/[def]/.test(P[8])&&P[3]&&W>=0?"+"+W:W);S=P[4]?P[4]=="0"?"0":P[4].charAt(1):" ";U=P[6]-String(W).length;L=P[6]?o(S,U):"";K.push(P[5]?W+L:L+W)}}}return K.join("")};J.cache={};J.parse=function(K){var N=K,O=[],Q=[],P=0;while(N){if((O=/^[^\x25]+/.exec(N))!==null){Q.push(O[0])}else{if((O=/^\x25{2}/.exec(N))!==null){Q.push("%")}else{if((O=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(N))!==null){if(O[2]){P|=1;var R=[],M=O[2],L=[];if((L=/^([a-z_][a-z_\d]*)/i.exec(M))!==null){R.push(L[1]);while((M=M.substring(L[0].length))!==""){if((L=/^\.([a-z_][a-z_\d]*)/i.exec(M))!==null){R.push(L[1])}else{if((L=/^\[(\d+)\]/.exec(M))!==null){R.push(L[1])}else{throw ("[sprintf] huh?")}}}}else{throw ("[sprintf] huh?")}O[2]=R}else{P|=2}if(P===3){throw ("[sprintf] mixing positional and named placeholders is not (yet) supported")}Q.push(O)}else{throw ("[sprintf] huh?")}}}N=N.substring(O[0].length)}return Q};return J})();var H=function(o,f){f.unshift(o);return p.apply(null,f)};d("sprintf",function(J,f,o){if(!o.sprintf){return J}if(Object.prototype.toString.apply(o.sprintf)==="[object Array]"){return H(J,o.sprintf)}else{if(typeof o.sprintf==="object"){return p(J,o.sprintf)}}return J});r.init=B;r.setLng=a;r.preload=u;r.t=t;r.translate=t;r.detectLanguage=F.detectLanguage;r.pluralExtensions=D;r.sync=n;r.functions=F;r.lng=I;r.addPostProcessor=d;r.options=z})();(function(){var V,N,B,O,w,R,e,c,K,r,o,E,f,S,A,J,W,y,t,v,M,z,j,b,q,C,g,d,a,L,u,Q,D,X,H,p,Y,x,i,G,U,h,l,s,T,P,m,I,F=[].slice,Z={}.hasOwnProperty,n=function(ad,ab){for(var aa in ab){if(Z.call(ab,aa)){ad[aa]=ab[aa]}}function ac(){this.constructor=ad}ac.prototype=ab.prototype;ad.prototype=new ac();ad.__super__=ab.prototype;return ad};window.namespace=function(af,aa,ac){var ai,ag,ad,ah,ae,ab;if(arguments.length<3){ae=[(typeof exports!=="undefined"?exports:window)].concat(F.call(arguments)),af=ae[0],aa=ae[1],ac=ae[2]}ag=af;ab=aa.split(".");for(ad=0,ah=ab.length;ad<ah;ad++){ai=ab[ad];af=af[ai]||(af[ai]={})}return ac(af,ag)};C=(function(){function aa(){}aa.prototype.createMemento=function(){throw new Error("NotImplementedError")};aa.prototype.setMemento=function(ab){throw new Error("NotImplementedError")};aa.validate=function(ab){if(!(ab.createMemento!=null)){throw new Error("Originator instance need `createMemento` method")}if(!(ab.setMemento!=null)){throw new Error("Originator instance need `setMemento` method")}};return aa})();e=(function(){function aa(ab){this._originator=ab;this._undoStack=[];this._redoStack=[]}aa.prototype.originator=function(ab){if(ab!=null){C.validate(ab);this._originator=ab;return this}return ab};aa.prototype.save=function(ab){ab=ab||this.originator().createMemento();this._undoStack.push(ab);return this._redoStack=[]};aa.prototype.undo=function(){var ab;if(!this.canUndo()){return false}ab=this.originator();this._redoStack.push(ab.createMemento());ab.setMemento(this._undoStack.pop());if(typeof ab.focus==="function"){ab.focus()}return true};aa.prototype.redo=function(){var ab;if(!this.canRedo()){return false}ab=this.originator();this._undoStack.push(ab.createMemento());ab.setMemento(this._redoStack.pop());if(typeof ab.focus==="function"){ab.focus()}return true};aa.prototype.canUndo=function(){return this._undoStack.length>0};aa.prototype.canRedo=function(){return this._redoStack.length>0};return aa})();L=(function(){function aa(ab,ac){this.document=ab;this.element=ac;this}aa.prototype._getCaret=function(){var ae,af,ad,ab,ac;if(this.document.selection!=null){ab=this.document.selection.createRange();af=ab.duplicate();af.moveToElementText(this.element);af.setEndPoint("EndToEnd",ab);ac=af.text.length-ab.text.length;ad=ac+ab.text.length}else{if(this.element.setSelectionRange!=null){ac=this.element.selectionStart;ad=this.element.selectionEnd}}ae=[ac,ad];ae.isCollapse=ac===ad;return ae};aa.prototype._setCaret=function(ae,ab){var ac,ad;ad=this.element.scrollTop;if(this.element.setSelectionRange!=null){this.element.setSelectionRange(ae,ab)}else{if(this.element.createTextRange){ac=this.element.createTextRange();ac.collapse(true);ac.moveStart("character",ae);ac.moveEnd("character",ab-ae);ac.select()}}this.element.focus();this.element.scrollTop=ad;return this};aa.prototype.caret=function(ac,ab){if((ac!=null)&&typeof ac==="array"){ab=ac[1];ac=ac[0]}if((ac!=null)&&!(ab!=null)){ab=ac}if((ac!=null)&&(ab!=null)){return this._setCaret(ac,ab)}return this._getCaret()};aa.prototype.caretOffset=function(ac){var ab;ab=this.caret();return this.caret(ab[0]+ac)};aa.prototype._replace=function(af,ag,ad){var ac,ab,ae;ae=this.element.scrollTop;ab=this.element.value.substring(0,ag);ac=this.element.value.substring(ad);this.element.value=ab+af+ac;this.element.scrollTop=ae;return this};aa.prototype._getText=function(){var ae,ab,ac,ad;if(this.document.selection!=null){ab=this.document.selection.createRange();return ab.text}else{if(this.element.setSelectionRange){ad=this.caret(),ac=ad[0],ae=ad[1];return this.element.value.substring(ac,ae)}}return null};aa.prototype._setText=function(ag,ac){var af,ab,ae,ad;ae=this.element.scrollTop;ad=this.caret(),ab=ad[0],af=ad[1];this._replace(ag,ab,af);af=ab+ag.length;if(!ac){ab=af}this.caret(ab,af);this.element.focus();this.element.scrollTop=ae;return this};aa.prototype.text=function(ac,ab){if(ac!=null){return this._setText(ac,ab)}return this._getText()};aa.prototype.insertBefore=function(ah,ac){var af,ab,ae,ag,ad;ae=this.element.scrollTop;ad=this.caret(),ab=ad[0],af=ad[1];ag=this.text();this._replace(ah+ag,ab,af);af=ab+ah.length;if(!ac){ab=af}this.caret(ab,af);this.element.focus();this.element.scrollTop=ae;return this};aa.prototype.insertAfter=function(ah,ac){var af,ab,ae,ag,ad;ae=this.element.scrollTop;ad=this.caret(),ab=ad[0],af=ad[1];ag=this.text();this._replace(ag+ah,ab,af);ab=af;af=af+ah.length;if(!ac){ab=af}this.caret(ab,af);this.element.focus();this.element.scrollTop=ae;return this};aa.prototype.enclose=function(ad,af,ac){var ag,aj,ab,ah,ai,ae;ab=this.element.scrollTop;ai=this.text();if(ai.indexOf(ad)===0&&ai.lastIndexOf(af)===(ai.length-af.length)){ah=ai.substring(ad.length,ai.length-af.length);this.text(ah,ac)}else{ae=this.caret(),aj=ae[0],ag=ae[1];this._replace(ad+ai+af,aj,ag);ag=aj+ad.length+ai.length+af.length;if(!ac){aj=ag}this.caret(aj,ag)}this.element.focus();this.element.scrollTop=ab;return this};aa.prototype._getLineCaretOfCaret=function(ae){var ad,ab,ac;ac=this.element.value;ab=ac.lastIndexOf("\n",ae-1)+1;ad=ac.indexOf("\n",ae);if(ad===-1){ad=ac.length}return[ab,ad]};aa.prototype._getLineCaret=function(){return this._getLineCaretOfCaret(this.caret()[0])};aa.prototype._getLine=function(){var ad,ab,ac;ac=this._getLineCaret(),ab=ac[0],ad=ac[1];return this.element.value.substring(ab,ad)};aa.prototype._setLine=function(ab,ad){var ag,ac,af,ae;af=this.element.scrollTop;ae=this._getLineCaret(),ac=ae[0],ag=ae[1];this._replace(ab,ac,ag);ag=ac+ab.length;if(!ad){ac=ag}this.caret(ac,ag);this.element.focus();this.element.scrollTop=af;return this};aa.prototype.line=function(ac,ab){if(ac!=null){return this._setLine(ac,ab)}return this._getLine()};aa.prototype.selectWholeLine=function(ae){var ad,ab,ac;ac=this._getLineCaretOfCaret(ae),ab=ac[0],ad=ac[1];return this.caret(ab,ad)};aa.prototype.selectWholeCurrentLine=function(){var ad,ab,ac;ac=this._getLineCaretOfCaret(this.caret()[0]),ab=ac[0],ad=ac[1];return this.caret(ab,ad)};return aa})();I=(function(){var aa,ao,ae,ad,ak,al,am,ac,ai,ab,ah,aj,an,ag,af;ah=function(ap){if(ap==null){ap=false}return this.outerWidth(ap)-this.width()};ab=function(ap){if(ap==null){ap=false}return this.outerHeight(ap)-this.height()};an=function(ap,aq){var ar;if(ap==null){ap=false}if(typeof ap==="number"){aq=ap;ap=false}if(aq!=null){ar=this.nonContentWidth(ap);return this.width(aq-ar)}return this._outerWidth(ap)};aj=function(ap,aq){var ar;if(ap==null){ap=false}if(typeof ap==="number"){aq=ap;ap=false}if(aq!=null){ar=this.nonContentHeight(ap);return this.height(aq-ar)}return this._outerHeight(ap)};ah=function(ap){if(ap==null){ap=false}return this.outerWidth(ap)-this.width()};ab=function(ap){if(ap==null){ap=false}return this.outerHeight(ap)-this.height()};ai=function(aq,ap){var ar;if(ap==null){ap=null}ar=this.css(aq);if(ar===""||ar==="none"||ar===null||ar===(void 0)||ar===NaN){return ap}ar=parseInt(ar,10);return ar};ac=function(){return this.ncss("min-width")};am=function(){return this.ncss("min-height")};al=function(){return this.ncss("max-width")};ak=function(){return this.ncss("max-height")};ae=function(ap){var at,ar,aq;if(ap==null){ap=false}ar=ap?this.ncss("margin-left"):0;at=this.ncss("border-left-width");aq=this.ncss("padding-left");return ar+at+aq};ad=function(ap){var at,ar,aq;if(ap==null){ap=false}ar=ap?this.ncss("margin-top"):0;at=this.ncss("border-top-width");aq=this.ncss("padding-top");return ar+at+aq};aa=function(ap){var aq;aq=this.offset();if(ap!=null){aq.left=ap;return this.offset(aq)}return aq.left};ao=function(ap){var aq;aq=this.offset();if(ap!=null){aq.top=ap;return this.offset(aq)}return aq.top};ag=function(ap,ar){var at,aq;if(ap==null){ap=false}if(typeof ap==="number"){ar=ap;ap=false}aq=I(this.parent());at=aq.absoluteX()+aq.contentX(ap);if(ar!=null){return this.absoluteX(ar+at)}return this.absoluteX()-at};af=function(ap,ar){var at,aq;if(ap==null){ap=false}if(typeof ap==="number"){ar=ap;ap=false}aq=I(this.parent());at=aq.absoluteY()+aq.contentY(ap);if(ar!=null){return this.absoluteY(ar+at)}return this.absoluteY()-at};I=function(ap){if(ap.__evoluted__===true){return ap}ap._outerWidth=ap.outerWidth;ap._outerHeight=ap.outerHeight;ap.nonContentWidth=ah;ap.nonContentHeight=ab;ap.outerWidth=an;ap.outerHeight=aj;ap.nonContentWidth=ah;ap.nonContentHeight=ab;ap.ncss=ai;ap.minWidth=ac;ap.minHeight=am;ap.maxWidth=al;ap.maxHeight=ak;ap.contentX=ae;ap.contentY=ad;ap.absoluteX=aa;ap.absoluteY=ao;ap.relativeX=ag;ap.relativeY=af;ap.__evoluted__=true;return ap};return I})();m=function(ab){var aa;ab.css("position","relative");aa=$("<div>").appendTo(ab).hide().css({position:"absolute",top:"0",left:"0",overflow:"hidden","z-index":99999});aa.on=function(){aa.refresh();return aa.show()};aa.refresh=function(){aa.width(ab.outerWidth(true));return aa.height(ab.outerHeight(true))};aa.off=function(){return aa.hide()};return aa};T=function(aa){var ad,ab,ac;aa=$.extend({start:0,end:100,duration:1000,callback:null,done:null,easing:null},aa);ab=T.now();ad=aa.end-aa.start;aa.easing=aa.easing||T.easings["default"];ac=function(){var af,ae;af=T.now()-ab;ae=aa.easing(af,0,1,aa.duration);ae=ae*ad+aa.start;aa.callback(ae,af);if(af<aa.duration){return setTimeout(ac,1)}else{aa.callback(aa.end,aa.duration);return typeof aa.done==="function"?aa.done():void 0}};ac();return null};T.now=function(){return(new Date()).getTime()};T.easings={"default":function(ab,ad,aa,ac){return jQuery.easing.swing(ab/ac,ab,ad,aa,ac)}};if(typeof exports!=="undefined"&&exports!==null){exports.animate=T}d=(function(){function aa(){}aa.prototype.mainPanelClass=null;aa.prototype.editorClass=null;aa.prototype.viewerClass=null;aa.prototype.helperClass=null;aa.prototype.buttons=null;return aa})();this.Jencil=(function(){function aa(ab,ac){var ad=this;this.options=jQuery.extend({profile:aa.filetypes.html.HtmlProfile,resizable:true,enableTabIndent:true,enableAutoIndent:true},ac);this.element=ab.hide();this.caretaker=new e();this.caretaker.originator=function(){return ad.editor()};this.wrapper=new s(this);this.fullscreen=new r(this);this.element.after(this.wrapper.element).after(this.fullscreen.element);this.wrapper.init();this.wrapper.adjust();this.caretaker.save()}aa.prototype.editor=function(){return this.wrapper.workspace.mainPanel.editorPanel||null};aa.prototype.viewer=function(){return this.wrapper.workspace.mainPanel.viewerPanel||null};aa.prototype.helper=function(){return this.wrapper.workspace.mainPanel.helperPanel||null};return aa})();$.fn.jencil=function(aa){return new Jencil($(this),aa)};namespace("Jencil.profiles",function(aa){return aa.Profile=d});namespace("Jencil.utils",function(aa){return aa.namespace=namespace});h=(function(){function aa(ac,ab,ad){this.core=ac;if(ab==null){ab="<div>"}if(ab instanceof jQuery){this.element=ab}else{this.element=$(ab,ad)}this.element=I(this.element)}aa.prototype.init=function(){return this};aa.prototype.adjust=function(){return this};return aa})();g=(function(aa){n(ab,aa);function ab(ad,ac,ae){if(ac==null){ac="<div>"}ab.__super__.constructor.call(this,ad,ac,ae);this.element.addClass("panel")}return ab})(h);q=(function(ab){n(aa,ab);function aa(ae,af,ac,ah){var ag,ad,ai=this;this.fst=af;this.snd=ac;this.splitter=ah;aa.__super__.constructor.call(this,ae);this.element.addClass("multiple");this.element.append(this.fst.element);this.element.append(this.splitter.element);this.element.append(this.snd.element);ad=function(aj){if(!this.element.is(":visible")){return this.toggle(aj,null)}};ag=function(aj){if(this.element.is(":visible")){return this.toggle(null,aj)}};this.fst.toggle=function(ak,aj){return ai._togglePanel(0,ak,aj)};this.fst.show=ad;this.fst.hide=ag;this.snd.toggle=function(ak,aj){return ai._togglePanel(1,ak,aj)};this.snd.show=ad;this.snd.hide=ag;this.splitter.element.dblclick(function(){return ai.snd.toggle()})}aa.prototype.init=function(){this.splitter.init();this.fst.init();return this.snd.init()};aa.prototype._togglePanel=function(ai,ag,ad){var af,ac,ae,ah=this;ae=this.splitter.volume();af=null;if((0<ae&&ae<1)){ac=ai;this.splitter._previousVolume=ae;af=ad}else{ac=this.splitter._previousVolume||this.splitter.defaultVolume;if(ac===ai){ac=0.5}af=ag}return T({done:af,start:ae,end:ac,duration:500,callback:function(ak,aj){return ah.splitter.volume(ak)}})};return aa})(g);i=(function(ab){n(aa,ab);function aa(ad,ae,ac,af){var ag;if(af==null){af=0.5}ag=new G(ad,ae,ac,af);aa.__super__.constructor.call(this,ad,ae,ac,ag);this.element.addClass("vertical")}aa.prototype.adjust=function(){this.fst.element.outerHeight(true,this.element.height());this.snd.element.outerHeight(true,this.element.height());this.splitter.element.outerHeight(true,this.element.height());this.splitter.adjust();return this};return aa})(q);S=(function(ab){n(aa,ab);function aa(ad,ae,ac,af){var ag;if(af==null){af=0.5}ag=new A(ad,ae,ac,af);aa.__super__.constructor.call(this,ad,ae,ac,ag);this.element.addClass("horizontal")}aa.prototype.adjust=function(){this.fst.element.outerWidth(true,this.element.width());this.snd.element.outerWidth(true,this.element.width());this.splitter.element.outerWidth(true,this.element.width());this.splitter.adjust();return this};return aa})(q);namespace("Jencil.ui.widgets",function(aa){return aa.Widget=h});namespace("Jencil.ui.widgets.panels",function(aa){aa.Panel=g;aa.MultiplePanel=q;aa.VerticalPanel=i;return aa.HorizontalPanel=S});Q=(function(aa){n(ab,aa);function ab(ad,ae,ac,af){var ag,ah,ai=this;this.fst=ae;this.snd=ac;this.defaultVolume=af!=null?af:0.5;ab.__super__.constructor.call(this,ad);this.element.addClass("splitter");this._volume=this.defaultVolume;ag=function(al){var ak,aj;ai.mousemove(al);if((ak=ai.fst.curtain)!=null){if(typeof ak.refresh==="function"){ak.refresh()}}if((aj=ai.snd.curtain)!=null){if(typeof aj.refresh==="function"){aj.refresh()}}al.stopPropagation();al.stopImmediatePropagation();return al.preventDefault()};ah=function(al){var am,ak,aj;am=$(window);am.unbind("mousemove",ag);am.unbind("mouseup",ah);if((ak=ai.fst.curtain)!=null){if(typeof ak.off==="function"){ak.off()}}if((aj=ai.snd.curtain)!=null){if(typeof aj.off==="function"){aj.off()}}al.stopPropagation();al.stopImmediatePropagation();return al.preventDefault()};this.element.mousedown(function(al){var am,ak,aj;am=$(window);am.mousemove(ag);am.mouseup(ah);if((ak=ai.fst.curtain)!=null){if(typeof ak.on==="function"){ak.on()}}if((aj=ai.snd.curtain)!=null){if(typeof aj.on==="function"){aj.on()}}al.stopPropagation();al.stopImmediatePropagation();return al.preventDefault()})}ab.prototype.init=function(){return this.container=I(this.element.parent())};ab.prototype.volume=function(ad,ac){if(ac==null){ac=false}if(ad!=null){this._volume=ad;if(!ac){this.adjust()}return this}return this._volume};ab.prototype.value=function(af,ae){var ac,ad;if(ae==null){ae=false}ac=this.valueWidth();if(af!=null){ad=af/ac;return this.volume(ad,ae)}return this.volume()*ac};ab.prototype.regulateValue=function(ad){var ae,ac;ac=this.minValue();ae=this.maxValue();if(ad<ac){ad=ac}if(ad>ae){ad=ae}return ad};return ab})(h);G=(function(aa){n(ab,aa);function ab(ae,af,ad,ag){var ah,ac;ab.__super__.constructor.call(this,ae,af,ad,ag);this.element.addClass("vertical");this.fst.element.addClass("left");this.snd.element.addClass("right");this.fst.element.css({"float":"left"});this.snd.element.css({"float":"left"});if((ah=this.fst.curtain)!=null){ah.css("pointer","col-resize")}if((ac=this.snd.curtain)!=null){ac.css("pointer","col-resize")}}ab.prototype.mousemove=function(ad){var ae,ac;ae=this.container.absoluteX()+this.container.contentX(true);ac=ad.pageX-ae;ac=this.regulateValue(ac);return this.value(ac)};ab.prototype.valueWidth=function(){return this.container.width()};ab.prototype.minValue=function(){var ad,ac;ad=this.fst.element.minWidth()+this.fst.element.nonContentWidth();ac=this.snd.element.maxWidth()+this.snd.element.nonContentWidth();if(ac!=null){ac=this.valueWidth()-ac}if((ad!=null)&&(ac!=null)){return Math.min(ad,ac)}return ad||ac||0};ab.prototype.maxValue=function(){var ae,ad,ac;ac=this.valueWidth();ae=this.fst.element.maxWidth()+this.fst.element.nonContentWidth();ad=this.snd.element.minWidth()+this.snd.element.nonContentWidth();if(ad!=null){ad=ac-ad}if((ae!=null)&&(ad!=null)){return Math.max(ae,ad)}return ae||ad||ac};ab.prototype.adjust=function(){var af,ae,ad,ac;ad=this.value();ac=this.valueWidth();af=ad-this.fst.element.nonContentWidth(true);ae=(ac-ad)-this.snd.element.nonContentWidth(true);if(af<=0){if(this.fst.element.is(":visible")){this.fst.element.hide()}if(!this.snd.element.is(":visible")){this.snd.element.show()}this.snd.element.outerWidth(true,ac);this._value=ad=0}else{if(ae<=0){if(!this.fst.element.is(":visible")){this.fst.element.show()}if(this.snd.element.is(":visible")){this.snd.element.hide()}this.fst.element.outerWidth(true,ac);this._value=ad=ac}else{if(!this.fst.element.is(":visible")){this.fst.element.show()}if(!this.snd.element.is(":visible")){this.snd.element.show()}this.fst.element.width(af);this.snd.element.width(ae)}}this.fst.adjust();this.snd.adjust();this.element.relativeX(ad-this.element.outerWidth()/2);return this};return ab})(Q);A=(function(ab){n(aa,ab);function aa(ae,af,ad,ag){var ah,ac;aa.__super__.constructor.call(this,ae,af,ad,ag);this.element.addClass("horizontal");this.fst.element.addClass("top");this.snd.element.addClass("bottom");if((ah=this.fst.curtain)!=null){ah.css("pointer","raw-resize")}if((ac=this.snd.curtain)!=null){ac.css("pointer","raw-resize")}}aa.prototype.mousemove=function(ad){var ae,ac;ae=this.container.absoluteY()+this.container.contentY(true);ac=ad.pageY-ae;ac=this.regulateValue(ac);return this.value(ac)};aa.prototype.valueWidth=function(){return this.container.height()};aa.prototype.minValue=function(){var ad,ac;ad=this.fst.element.minHeight()+this.fst.element.nonContentHeight();ac=this.snd.element.maxHeight()+this.snd.element.nonContentHeight();if(ac!=null){ac=this.valueWidth()-ac}if((ad!=null)&&(ac!=null)){return Math.min(ad,ac)}return ad||ac||0};aa.prototype.maxValue=function(){var ae,ad,ac;ac=this.valueWidth();ae=this.fst.element.maxHeight()+this.fst.element.nonContentHeight();ad=this.snd.element.minHeight()+this.snd.element.nonContentHeight();if(ad!=null){ad=ac-ad}if((ae!=null)&&(ad!=null)){return Math.max(ae,ad)}return ae||ad||ac};aa.prototype.adjust=function(){var af,ae,ad,ac;ad=this.value();ac=this.valueWidth();af=ad-this.fst.element.nonContentHeight(true);ae=(ac-ad)-this.snd.element.nonContentHeight(true);if(af<=0){if(this.fst.element.is(":visible")){this.fst.element.hide()}if(!this.snd.element.is(":visible")){this.snd.element.show()}this.snd.element.outerHeight(true,ac);this._value=ad=0}else{if(ae<=0){if(!this.fst.element.is(":visible")){this.fst.element.show()}if(this.snd.element.is(":visible")){this.snd.element.hide()}this.fst.element.outerHeight(true,ac);this._value=ad=ac}else{if(!this.fst.element.is(":visible")){this.fst.element.show()}if(!this.snd.element.is(":visible")){this.snd.element.show()}this.fst.element.height(af);this.snd.element.height(ae)}}this.fst.adjust();this.snd.adjust();this.element.relativeY(ad-this.element.outerHeight()/2);return this};return aa})(Q);namespace("Jencil.ui.widgets.splitters",function(aa){aa.Splitter=Q;aa.VerticalSplitter=G;return aa.HorizontalSplitter=A});O=(function(ab){n(aa,ab);function aa(ad,ac,ae){if(ac==null){ac="<div>"}aa.__super__.constructor.call(this,ad,ac,ae);this.element.addClass("editor");this._changeCallbacks=[]}aa.prototype.val=function(ac){throw new Error("NotImplementedError")};aa.prototype.change=function(af){var ae,ac,ad;if(af!=null){this._changeCallbacks.push(af);return this}ad=this._changeCallbacks;for(ae=0,ac=ad.length;ae<ac;ae++){af=ad[ae];af.call(this,this.val())}return this};aa.prototype.h1=null;aa.prototype.h2=null;aa.prototype.h3=null;aa.prototype.h4=null;aa.prototype.h5=null;aa.prototype.h6=null;aa.prototype.bold=null;aa.prototype.italic=null;aa.prototype.underline=null;aa.prototype.strike=null;aa.prototype.superscript=null;aa.prototype.subscript=null;aa.prototype.anchor=null;aa.prototype.image=null;aa.prototype.unorderedList=null;aa.prototype.orderedList=null;return aa})(g);H=(function(aa){n(ab,aa);function ab(ad,ac,ae){var af=this;if(ac==null){ac="<div>"}ab.__super__.constructor.call(this,ad,ac,ae);this.textarea=$("<textarea>").appendTo(this.element).css({margin:"0",padding:"0",border:"none",outline:"none",resize:"none"});this.textarea=I(this.textarea);this.textarea.selection=new L(window.document,this.textarea.get(0));if(($.fn.tabby!=null)&&this.core.options.enableTabIndent){this.textarea.tabby({tabString:"    "})}this.textarea.autoindent=function(al){var ag,ak,ah,ai,aj;if(al.which===13){af.core.caretaker.save();ah=af.textarea.selection.line();if(typeof(ai=af.textarea.autoindent).preCallback==="function"){ai.preCallback(al,ah)}ag=ah.replace(/^(\s*).*$/,"$1");ak="\n"+ag;af.textarea.selection.insertAfter(ak,false);if(typeof(aj=af.textarea.autoindent).postCallback==="function"){aj.postCallback(al,ah,ag,ak)}af.textarea.focus();al.stopPropagation();al.stopImmediatePropagation();al.preventDefault();af.change();return false}};this.textarea.on("keydown",function(ag){if(af.core.options.enableAutoIndent){return af.textarea.autoindent(ag)}});this.textarea.on("keypress keyup click blur",function(){return af.change()})}ab.prototype.val=function(ac){if(ac!=null){this.textarea.val(ac);this.change();return this}return this.textarea.val()};ab.prototype.focus=function(){this.textarea.focus();return this};ab.prototype.createMemento=function(){return this.val()};ab.prototype.setMemento=function(ac){return this.val(ac)};ab.prototype.adjust=function(){this.textarea.outerWidth(this.element.width());this.textarea.outerHeight(this.element.height());return this};ab.prototype.selection=function(ad,ac){if(ac==null){ac=true}if(ad!=null){this.textarea.selection.text(ad,ac);this.core.caretaker.save();return this.change()}return this.textarea.selection.text()};ab.prototype.enclose=function(ac,ad,ae){var af;if(ae==null){ae=true}af=this.textarea.selection.caret();if(af[0]===af[1]){this.textarea.selection.selectWholeCurrentLine()}this.textarea.selection.enclose(ac,ad,ae);this.core.caretaker.save();return this.change()};ab.prototype.insertBefore=function(ae,ac){var ad;if(ac==null){ac=true}ad=this.textarea.selection.caret();if(ad[0]===ad[1]){this.textarea.selection.selectWholeCurrentLine()}this.textarea.selection.insertBefore(ae,ac);this.core.caretaker.save();return this.change()};ab.prototype.insertAfter=function(ae,ac){var ad;if(ac==null){ac=true}ad=this.textarea.selection.caret();if(ad[0]===ad[1]){this.textarea.selection.selectWholeCurrentLine()}this.textarea.selection.insertAfter(ae,ac);this.core.caretaker.save();return this.change()};return ab})(O);namespace("Jencil.ui.widgets.editors",function(aa){aa.BaseEditor=O;return aa.TextEditor=H});w=(function(ab){n(aa,ab);function aa(ad,ac,ae){if(ac==null){ac="<div>"}aa.__super__.constructor.call(this,ad,ac,ae);this.element.addClass("viewer")}aa.prototype.update=function(ad,ac){throw new Error("NotImplementedError")};return aa})(g);X=(function(ab){n(aa,ab);function aa(ac){aa.__super__.constructor.call(this,ac);this.element.css({position:"relative"});this.curtain=m(this.element);this.iframe=$("<iframe>").appendTo(this.element).css({margin:"0",padding:"0",border:"none",outline:"none",resize:"none",width:"100%",height:"100%",overflow:"visible"});this.iframe.attr("frameborder",0);this.iframe=I(this.iframe);this.iframe.init=function(){var ad;ad=this.get(0);if(ad.contentDocument!=null){this.document=ad.contentDocument}else{this.document=ad.contentWindow.document}return this.document.write("<body></body>")};this.iframe.write=function(ad){var af;if(this.document!=null){try{af=this.document.documentElement.scrollTop}catch(ae){af=0}this.document.open();this.document.write(ad);this.document.close();this.document.documentElement.scrollTop=af;this.width(this.document.scrollLeft);this.height(this.document.scrollTop);return true}return false};this.iframe.loadTemplate=function(ad,ae){var af=this;return $.ajax({url:ad,success:function(ag){af._template=ag;return af.write(ae)}})}}aa.prototype.init=function(){return this.iframe.init()};aa.prototype.update=function(ad,ac){if(this.iframe._template!=null){ad=this.iframe._template.replace("{{content}}",ad)}else{if(this.templatePath!=null){this.iframe.loadTemplate(this.templatePath,ad)}}return this.iframe.write(ad)};aa.prototype.adjust=function(){this.iframe.outerWidth(this.element.width());this.iframe.outerHeight(this.element.height());return this};return aa})(w);N=(function(ab){n(aa,ab);function aa(ac,ad){this.config=ad;aa.__super__.constructor.call(this,ac);this.config=jQuery.extend({type:"GET",dataType:"text",data:function(ae){return encodeURIComponent(ae)},url:null},this.config)}aa.prototype.update=function(ad,ac){var ae=this;if(this._valueCache!==ad||ac){this._valueCache=ad;return $.ajax({type:this.config.type,dataType:this.config.dataType,data:JSON.stringify(this.config.data(ad)),url:this.config.url,success:function(af){if(ae.iframe._template!=null){af=ae.iframe._template.replace("{{content}}",af)}else{if(ae.templatePath!=null){ae.iframe.loadTemplate(ae.templatePath,af)}}return ae.iframe.write(af)}})}};return aa})(X);namespace("Jencil.ui.widgets.viewers",function(aa){aa.BaseViewer=w;aa.TemplateViewer=X;return aa.AjaxViewer=N});u=(function(aa){n(ab,aa);function ab(ac){ab.__super__.constructor.call(this,ac,"<span>");this.element.addClass("separator")}return ab})(h);R=(function(ab){n(aa,ab);function aa(ac,ad,af,ae){this.name=ad;this.text=af;this.title=ae;aa.__super__.constructor.call(this,ac,"<a>");this.text=this.text||this.name;this.title=this.title||this.text;this.element.addClass("button").addClass(ad);this.element.append($("<span>"+this.text+"</span>"));this.element.attr("title",this.title)}aa.prototype.enable=function(){return this.element.removeClass("disable")};aa.prototype.disable=function(){return this.element.addClass("disable")};aa.prototype.validate=function(){return this};return aa})(h);V=(function(ab){n(aa,ab);function aa(ad,ae,ag,af,ai,ac){var ah=this;this.shortcut=ac;aa.__super__.constructor.call(this,ad,ae,ag,af);this.callback=function(){if(!ah.element.hasClass("disable")){return ai()}};this.callback.raw=ai;this.element.click(function(){return ah.callback()});if((this.shortcut!=null)&&(window.shortcut!=null)){window.shortcut.add(this.shortcut,function(aj){return ah.callback()});this.element.attr("title",""+this.title+" ("+this.shortcut+")")}}return aa})(R);c=(function(aa){n(ab,aa);function ab(ad,ae,ah,ag,af,ac){var ai;this.command=af;ai=function(){var aj;aj=ad.editor();return aj[af].call(aj)};ab.__super__.constructor.call(this,ad,ae,ah,ag,ai,ac)}ab.prototype.init=function(){return this.validate()};ab.prototype.validate=function(){var ac;ac=this.core.editor();if(!(ac[this.command]!=null)){this.disable()}return this};ab.factory=function(ad,af){var ai,ae,ac,ah,ag;ae=ah=ag=ai=ac=null;switch(af.length){case 5:ae=af[0];ah=af[1];ag=af[2];ai=af[3];ac=af[4];break;case 4:ae=af[0];ah=ag=af[1];ai=af[2];ac=af[3];break;case 3:ae=ai=af[0];ah=ag=af[1];ac=af[2];break;case 2:ae=ai=af[0];ah=ag=af[1];ac=null;break;case 1:ae=ai=ah=ag=af[0];ac=null}return new ab(ad,ae,ah,ag,ai,ac)};return ab})(V);x=(function(aa){n(ab,aa);function ab(ac){var ae,ad=this;ae=function(af){return ad.core.caretaker.undo()};ab.__super__.constructor.call(this,ac,"undo","Undo","Undo",ae,"Ctrl+Z")}ab.prototype.init=function(){var ac,ad=this;ac=function(){if(!ad.core.caretaker.canUndo()){ad.disable()}else{ad.enable()}return setTimeout(ac,100)};return ac()};return ab})(V);a=(function(ab){n(aa,ab);function aa(ac){var ae,ad=this;ae=function(af){return ad.core.caretaker.redo()};aa.__super__.constructor.call(this,ac,"redo","Redo","Redo",ae,"Ctrl+Shift+Z")}aa.prototype.init=function(){var ac,ad=this;ac=function(){if(!ad.core.caretaker.canRedo()){ad.disable()}else{ad.enable()}return setTimeout(ac,100)};return ac()};return aa})(V);o=(function(ab){n(aa,ab);function aa(ac){var ae,ad=this;ae=function(af){return ad.core.fullscreen.toggle()};aa.__super__.constructor.call(this,ac,"fullscreen","Toggle fullscreen","Fullscreen",ae,"Ctrl+F")}aa.prototype.init=function(){var ac,ad=this;ac=function(){if(ad.core.fullscreen.element.is(":visible")){ad.element.addClass("hide")}else{ad.element.removeClass("hide")}return setTimeout(ac,100)};return ac()};return aa})(V);U=(function(ab){n(aa,ab);function aa(ac){var ae,ad=this;ae=function(af){return ad.core.viewer().toggle()};aa.__super__.constructor.call(this,ac,"viewer","Toggle viewer","Viewer",ae)}aa.prototype.validate=function(){if(!this.core.viewer()){this.disable();return false}return true};aa.prototype.init=function(){var ac,ad=this;if(!this.validate()){return}ac=function(){if(ad.core.viewer().element.is(":visible")){ad.element.addClass("hide")}else{ad.element.removeClass("hide")}return setTimeout(ac,100)};return ac()};return aa})(V);f=(function(ab){n(aa,ab);function aa(ac){var ae,ad=this;ae=function(af){return ad.core.helper().toggle()};aa.__super__.constructor.call(this,ac,"helper","Toggle helper","Helper",ae)}aa.prototype.validate=function(){if(!this.core.helper()){this.disable();return false}return true};aa.prototype.init=function(){var ac,ad=this;if(!this.validate()){return}ac=function(){if(ad.core.helper().element.is(":visible")){ad.element.addClass("hide")}else{ad.element.removeClass("hide")}return setTimeout(ac,100)};return ac()};return aa})(V);P=function(aa,ab){if(ab instanceof Array){return c.factory(aa,ab)}if(typeof ab==="string"){switch(ab){case"Separator":return new u(aa);case"Undo":return new x(aa);case"Redo":return new a(aa);case"Fullscreen":return new o(aa);case"Viewer":return new U(aa);case"Helper":return new f(aa);default:throw new Exception(""+ab+" is not known Button type")}}return new ab(aa)};namespace("Jencil.ui.widgets.buttons",function(aa){aa.Separator=u;aa.Button=R;aa.ActionButton=V;aa.CommandButton=c;aa.UndoButton=x;aa.RedoButton=a;aa.FullscreenButton=o;aa.ViewerButton=U;return aa.HelperButton=f});s=(function(aa){n(ab,aa);function ab(ac){ab.__super__.constructor.call(this,ac);this.element.addClass("jencil wrapper");this.workspace=new l(this.core);this.workspace.element.appendTo(this.element)}ab.prototype.init=function(){var ac=this;if((this.element.resizable!=null)&&this.core.options.resizable===true){this.element.resizable({start:function(){var af,ad,ai,ah,ag,ae;if((af=ac.core.editor())!=null){if((ad=af.curtain)!=null){ad.on()}}if((ai=ac.core.viewer())!=null){if((ah=ai.curtain)!=null){ah.on()}}return(ag=ac.core.helper())!=null?(ae=ag.curtain)!=null?ae.on():void 0:void 0},resize:function(){var af,ad,ai,ah,ag,ae;if((af=ac.core.editor())!=null){if((ad=af.curtain)!=null){ad.refresh()}}if((ai=ac.core.viewer())!=null){if((ah=ai.curtain)!=null){ah.refresh()}}if((ag=ac.core.helper())!=null){if((ae=ag.curtain)!=null){ae.refresh()}}return ac.adjust()},stop:function(){var af,ad,ai,ah,ag,ae;if((af=ac.core.editor())!=null){if((ad=af.curtain)!=null){ad.off()}}if((ai=ac.core.viewer())!=null){if((ah=ai.curtain)!=null){ah.off()}}if((ag=ac.core.helper())!=null){if((ae=ag.curtain)!=null){ae.off()}}return ac.adjust()}})}return this.workspace.init()};ab.prototype.adjust=function(){this.workspace.element.outerWidth(true,this.element.width());this.workspace.element.outerHeight(true,this.element.height());this.workspace.adjust();return this};return ab})(g);l=(function(ab){n(aa,ab);function aa(ac){aa.__super__.constructor.call(this,ac);this.element.addClass("workspace");this.profile(new ac.options.profile)}aa.prototype.profile=function(ad){var ai,ag,ae,ak,ac,ah,af,aj=this;if(ad!=null){this.element.empty();this.mainPanel=new ad.mainPanelClass(this.core,ad);this.mainPanel.editorPanel.change(function(al){return aj.core.element.val(al)});this.toolbar=new p(this.core);ah=ad.toolbarButtons;for(ag=0,ak=ah.length;ag<ak;ag++){ai=ah[ag];ai=P(this.core,ai);this.toolbar.addButton(ai)}this.statusbar=new D(this.core);af=ad.statusbarButtons;for(ae=0,ac=af.length;ae<ac;ae++){ai=af[ae];ai=P(this.core,ai);this.statusbar.addButton(ai)}this.element.append(this.toolbar.element);this.element.append(this.mainPanel.element);this.element.append(this.statusbar.element);this._profile=ad;return this}return this._profile};aa.prototype.init=function(){this.toolbar.init();this.statusbar.init();return this.mainPanel.init()};aa.prototype.adjust=function(){var ad,ac;this.toolbar.element.outerWidth(true,this.element.width());this.statusbar.element.outerWidth(true,this.element.width());this.mainPanel.element.outerWidth(true,this.element.width());this.mainPanel.element.outerHeight(true,this.element.height());this.mainPanel.adjust();ad=this.toolbar.element.outerHeight(true);ac=this.statusbar.element.outerHeight(true);this.mainPanel.element.outerHeight(true,this.element.height()-(ad+ac));this.toolbar.adjust();this.statusbar.adjust();this.mainPanel.adjust();return this};aa.prototype.update=function(ac){if(this.mainPanel.editorPanel&&this.mainPanel.viewerPanel){return this.mainPanel.viewerPanel.update(this.mainPanel.editorPanel.val(),ac)}};return aa})(g);B=(function(ab){n(aa,ab);function aa(ac){aa.__super__.constructor.call(this,ac);this._buttons=[]}aa.prototype.init=function(){var ad,af,ac,ae;ae=this._buttons;for(af=0,ac=ae.length;af<ac;af++){ad=ae[af];ad.init()}return this};aa.prototype.addButton=function(ac){this._buttons.push(ac);return this.element.append(ac.element)};return aa})(g);p=(function(ab){n(aa,ab);function aa(ac){aa.__super__.constructor.call(this,ac);this.element.addClass("toolbar")}return aa})(B);D=(function(ab){n(aa,ab);function aa(ac){aa.__super__.constructor.call(this,ac);this.element.addClass("statusbar")}return aa})(B);b=(function(){function aa(ab,ad){var ac;ac=new ad.editorClass(ab);ac.element.addClass("mainPanel");return ac}return aa})();K=(function(ab){n(aa,ab);function aa(ac,ad){var ae=this;this.editorPanel=new ad.editorClass(ac);this.viewerPanel=new ad.viewerClass(ac);aa.__super__.constructor.call(this,ac,this.editorPanel,this.viewerPanel,ad.defaultVolume);this.element.addClass("mainPanel");this.editorPanel.change(function(af){return ae.viewerPanel.update(af)})}return aa})(i);Y=(function(ab){n(aa,ab);function aa(ac,ad){var ae=this;this.editorPanel=new ad.editorClass(ac);this.viewerPanel=new ad.viewerClass(ac);this.helperPanel=new ad.helperClass(ac);this.verticalPanel=new i(ac,this.editorPanel,this.viewerPanel,ad.defaultVolume);aa.__super__.constructor.call(this,ac,this.verticalPanel,this.helperPanel,ad.defaultVolume2);this.element.addClass("mainPanel");this.editorPanel.change(function(af){return ae.viewerPanel.update(af)})}return aa})(S);namespace("Jencil.ui.widgets.panels",function(aa){aa.MonomainPanel=b;aa.DimainPanel=K;return aa.TrimainPanel=Y});r=(function(ab){n(aa,ab);function aa(ac){var ad=this;aa.__super__.constructor.call(this,ac);this.element.addClass("fullscreen");this.element.css({position:"fixed",top:"0",left:"0",width:"100%",height:"100%"});this.curtain=$("<div>").addClass("curtain");this.curtain.css({position:"absolute",top:"0",left:"0",width:"100%",height:"100%",background:"black",opacity:"0.6",cursor:"pointer"});this.cell=$("<div>").css({position:"absolute",top:"5%",left:"5%",width:"90%",height:"90%"});if($.browser.msie&&$.browser.version<7){this.element.css("position","absolute");$(window).scroll(function(){return ad.element.css("top",$(document).scrollTop())})}this.curtain.click(function(){return ad.off()});this.element.append(this.curtain);this.element.append(this.cell);this.element.hide();this.resize=function(){return ad.core.wrapper.adjust()}}aa.prototype.on=function(){var ac,ad=this;ac=9/10;this.cell.append(this.core.wrapper.element);this.core.wrapper.element.outerWidth(true,this.element.width()*ac);this.core.wrapper.element.outerHeight(true,this.element.height()*ac);this.core.wrapper.init();this.core.wrapper.adjust();this.core.wrapper.workspace.update(true);this.element.fadeIn("fast",function(){ad.core.wrapper.element.css("width","100%");ad.core.wrapper.element.css("height","100%");return ad.core.wrapper.adjust()});return $(window).on("resize",this.resize)};aa.prototype.off=function(){this.core.element.after(this.core.wrapper.element);this.core.wrapper.element.css("width","");this.core.wrapper.element.css("height","");this.core.wrapper.init();this.core.wrapper.adjust();this.core.wrapper.workspace.update(true);this.element.fadeOut("fast");return $(window).unbind("resize",this.resize)};aa.prototype.toggle=function(ad,ac){if(this.element.is(":visible")){this.off();return typeof ac==="function"?ac():void 0}else{this.on();return typeof ad==="function"?ad():void 0}};return aa})(g);J=(function(ab){n(aa,ab);function aa(ae){var ad,ac,af=this;aa.__super__.constructor.call(this,ae);ad=(function(){var aj,ah,ai,ag;ai=["p","li"];ag=[];for(aj=0,ah=ai.length;aj<ah;aj++){ac=ai[aj];ag.push(["<"+ac+">","</"+ac+">",new RegExp("^s*<"+ac+">"),new RegExp("</"+ac+">s*$")])}return ag})();this.textarea.autoindent.preCallback=function(al,ah){var ai,ak,aj,ag;if(al.shiftKey){return}for(aj=0,ag=ad.length;aj<ag;aj++){ak=ad[aj];if(ak[3].test(ah)){ai=af.textarea.selection._getLineCaret();af.textarea.selection.caret(ai[1]);return}}};this.textarea.autoindent.postCallback=function(ak,ah){var aj,ai,ag;if(ak.shiftKey){return}for(ai=0,ag=ad.length;ai<ag;ai++){aj=ad[ai];if(aj[3].test(ah)){af.textarea.selection.insertAfter(""+aj[0]+aj[1],false);af.textarea.selection.caretOffset(-aj[1].length);return}}}}aa._headerPattern=new RegExp("^<h([1-6])>(.*)</h[1-6]>\n?$");aa.prototype._header=function(af){var ae,ac,ad;ae=this.textarea.selection.caret();if(ae[0]===ae[1]){this.textarea.selection.selectWholeCurrentLine()}ad=this.selection();if(aa._headerPattern.test(ad)){if(RegExp.$1===af.toString()){ac=RegExp.$2}else{ac="<h"+af+">"+RegExp.$2+"</h"+af+">"}return this.selection(ac)}else{return this.enclose("<h"+af+">","</h"+af+">\n")}};aa.prototype.h1=function(){return this._header(1)};aa.prototype.h2=function(){return this._header(2)};aa.prototype.h3=function(){return this._header(3)};aa.prototype.h4=function(){return this._header(4)};aa.prototype.h5=function(){return this._header(5)};aa.prototype.h6=function(){return this._header(6)};aa.prototype.bold=function(){return this.enclose("<b>","</b>")};aa.prototype.italic=function(){return this.enclose("<i>","</i>")};aa.prototype.underline=function(){return this.enclose("<u>","</u>")};aa.prototype.strike=function(){return this.enclose("<s>","</s>")};aa.prototype.superscript=function(){return this.enclose("<sup>","</sup>")};aa.prototype.subscript=function(){return this.enclose("<sub>","</sub>")};aa.prototype.quote=function(){return this.enclose("<q>","</q>")};aa.prototype.blockquote=function(){return this.enclose("\n<blockquote>","</blockquote>\n")};aa.prototype.code=function(){return this.enclose("<code>","</code>")};aa.prototype.pre=function(){return this.enclose("<pre>","</pre>")};aa.prototype.anchorLink=function(){var ac,ad;ad=this.selection();if(!ad){ad=window.prompt("Please input a link text","Here")}ac=window.prompt("Please input a link url","http://");if(!(ac!=null)){return}return this.selection("<a href='"+ac+"'>"+ad+"</a>")};aa.prototype.image=function(){var ac,ad;ad=window.prompt("Please input a image url","http://");ac=window.prompt("(Optional) Please input a alt message","Image");if(!(ad!=null)){return}return this.selection("<img src='"+ad+"' alt='"+ac+"'>")};aa.prototype.unorderedList=function(){var ad,ac;ad=this.selection();ad=(function(){var ah,af,ag,ae;ag=ad.split("\n");ae=[];for(ah=0,af=ag.length;ah<af;ah++){ac=ag[ah];ae.push("  <li>"+ac+"</li>")}return ae})();ad.unshift("<ul>");ad.push("</ul>");return this.selection(ad.join("\n"))};aa.prototype.orderedList=function(){var ad,ac;ad=this.selection();ad=(function(){var ah,af,ag,ae;ag=ad.split("\n");ae=[];for(ah=0,af=ag.length;ah<af;ah++){ac=ag[ah];ae.push("  <li>"+ac+"</li>")}return ae})();ad.unshift("<ol>");ad.push("</ol>");return this.selection(ad.join("\n"))};return aa})(Jencil.ui.widgets.editors.TextEditor);t=Jencil.ui.widgets.viewers.TemplateViewer;W=(function(ab){n(aa,ab);function aa(ac){aa.__super__.constructor.call(this,ac);this.element.addClass("helper")}return aa})(Jencil.ui.widgets.panels.Panel);y=(function(ab){n(aa,ab);function aa(){this.mainPanelClass=Jencil.ui.widgets.panels.TrimainPanel;this.editorClass=J;this.viewerClass=t;this.helperClass=W;this.defaultVolume=1;this.defaultVolume2=1;this.toolbarButtons=["Undo","Redo","Separator",["h1","H1"],["h2","H2"],["h3","H3"],["h4","H4"],["h5","H5"],["h6","H6"],"Separator",["bold","Bold","Ctrl+B"],["italic","Italic","Ctrl+I"],["underline","Underline","Ctrl+U"],["strike","Strikeout"],["superscript","Superscript"],["subscript","Subscript"],"Separator",["anchorLink","Anchor link"],["image","Image"],["unorderedList","Unordered list"],["orderedList","Ordered list"],["quote","Quote"],["blockquote","Blockquote"],["code","Code"],["pre","Pre"],"Separator","Fullscreen"];this.statusbarButtons=["Viewer","Helper"]}return aa})(Jencil.profiles.Profile);Jencil.utils.namespace("Jencil.filetypes.html",function(aa){aa.HtmlEditor=J;aa.HtmlViewer=t;return aa.HtmlProfile=y});j=(function(ab){n(aa,ab);function aa(ac){var ad;ad={type:"POST",dataType:"text",data:function(ae){return{text:ae,mode:"markdown"}},url:"https://api.github.com/markdown"};aa.__super__.constructor.call(this,ac,ad)}return aa})(N);E=(function(ab){n(aa,ab);function aa(ac){var ad;ad={type:"POST",dataType:"text",data:function(ae){return{text:ae,mode:"gfm"}},url:"https://api.github.com/markdown"};aa.__super__.constructor.call(this,ac,ad)}return aa})(N);v=(function(ab){n(aa,ab);function aa(){return aa.__super__.constructor.apply(this,arguments)}aa.prototype.h1=function(){return this.insertBefore("# ")};aa.prototype.h2=function(){return this.insertBefore("## ")};aa.prototype.h3=function(){return this.insertBefore("### ")};aa.prototype.h4=function(){return this.insertBefore("#### ")};aa.prototype.h5=function(){return this.insertBefore("##### ")};aa.prototype.h6=function(){return this.insertBefore("###### ")};aa.prototype.bold=function(){return this.enclose("**","**")};aa.prototype.italic=function(){return this.enclose("*","*")};aa.prototype.anchor=function(){var ac,ad;ad=this.selection();if(!ad){ad=window.prompt("Please input a link text","Here")}ac=window.prompt("Please input a link url","http://");return this.selection("["+ad+"]("+ac+")")};aa.prototype.image=function(){var ac,ad;ad=window.prompt("Please input a image url","http://");ac=window.prompt("(Optional) Please input a alt message","Image");return this.selection("!["+ac+"]("+ad+")")};aa.prototype.unorderedList=function(){var ad,ac;ad=this.selection();ad=(function(){var ah,af,ag,ae;ag=ad.split("\n");ae=[];for(ah=0,af=ag.length;ah<af;ah++){ac=ag[ah];ae.push("-   "+ac)}return ae})();ad.unshift("");ad.push("");return this.selection(ad.join("\n"))};aa.prototype.orderedList=function(){var ad,ae,ac;ae=this.selection();ae=(function(){var ai,ag,ah,af;ah=ae.split("\n");af=[];for(ad=ai=0,ag=ah.length;ai<ag;ad=++ai){ac=ah[ad];af.push(""+ad+". "+ac)}return af})();ae.unshift("");ae.push("");return this.selection(ae.join("\n"))};return aa})(J);M=(function(ab){n(aa,ab);function aa(ac){aa.__super__.constructor.call(this,ac);this.element.addClass("helper")}return aa})(Jencil.ui.widgets.panels.Panel);z=(function(ab){n(aa,ab);function aa(){this.mainPanelClass=Jencil.ui.widgets.panels.TrimainPanel;this.editorClass=v;this.viewerClass=j;this.helperClass=M;this.defaultVolume=1;this.defaultVolume2=1;this.toolbarButtons=["Undo","Redo","Separator",["h1","H1"],["h2","H2"],["h3","H3"],["h4","H4"],["h5","H5"],["h6","H6"],"Separator",["bold","Bold","Ctrl+B"],["italic","Italic","Ctrl+I"],"Separator",["anchor","Anchor link"],["image","Image"],["unorderedList","Unordered list"],["orderedList","Ordered list"],"Separator","Fullscreen"];this.statusbarButtons=["Viewer","Helper"]}return aa})(Jencil.profiles.Profile);Jencil.utils.namespace("Jencil.filetypes.markdown",function(aa){aa.MarkdownEditor=v;aa.MarkdownViewer=j;return aa.MarkdownProfile=z})}).call(this);
